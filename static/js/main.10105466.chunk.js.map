{"version":3,"sources":["components/SearchResult.js","components/SearchContainer.js","components/Notifications/Notification.js","components/Notifications/NotificationsContainer.js","components/Header.js","components/Tweet.js","components/WriteTweet.js","components/TimeLine.js","components/UserBox.js","components/LandingPage.js","components/RegisterPopUp.js","components/LoggedLanding.js","components/Loading.js","components/FollowButton.js","components/UnfollowButton.js","components/UserBoxInUserPage.js","components/UserPage.js","components/ChangeThings.js","App.js","serviceWorker.js","index.js"],"names":["SearchResult","props","image","result","profilepic","react_default","a","createElement","react_router_dom","to","id","className","src","firstName","SearchContainer","state","this","search","length","searchState","results","map","i","components_SearchResult","key","Component","Notification","seenNotification","_this","bind","Object","assertThisInitialized","console","log","notification","seen","isTweet","Boolean","text","user","Fragment","concat","onClick","NotificationsContainer","usersDB","firebase","database","ref","child","email","auth","currentUser","oldNotifications","loggedUserId","once","data","users","val","keys","then","set","_this2","notifications","Notifications_Notification","usersArray","Header","searchResult","unseenNotifications","showNotifications","refSearch","React","createRef","Logout","LogIn","toggleSettings","toggleNotifications","setState","window","location","replace","onAuthStateChanged","on","snapshot","newNotifications","logged","_this3","regex","RegExp","current","value","count","test","push","x","toConsumableArray","Set","logOut","arr","comp","e","final","indexOf","filter","notificationsToShow","sort","b","timeA","Date","getTime","slice","Notifications_NotificationsContainer","onChange","type","placeholder","components_SearchContainer","Tweet","name","message","likes","likesNumber","retweets","retweetedBy","retweetedByNumber","date","showTime","tweetId","likedByLogged","showRetweetedBy","matchingRetweeted","loggedUser","deleted","like","tweetLikesDB","userNotifications","newNotification","toISOString","dislike","userid","retweet","tweetRetweetedDB","Swal","fire","title","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","retweetDate","newRetweet","deleteTweet","tweetsDB","sameUser","_this$props$tweet","tweet","newMessage","mentionedUsers","match","approvedUsers","tweetDate","timeAgo","Math","floor","j","splittedMessage","split","hasOwnProperty","updated","index_es","icon","faRetweet","word","faReply","faHeart","faTrash","userData","WriteTweet","mentions","refTweetText","sendTweet","writeTweet","cleanState","checkMention","mentionRegex","tweetData","refreshRender","tweetMessage","usersNotifications","userEmail","update","maxLength","TimeLine","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","loading","following","userPage","tweetsToShow","pageChanged","newTweets","searchTweets","matchUsers","matchUsersRetweet","reRender","searchOneTweet","tweetRegex","pathname","approved","tweets","error","matches","userId","tweetUser","find","matchs","_loop","followingUser","showingTweets","showingNewTweets","components_WriteTweet","components_Tweet","UserBox","followers","tweetCount","coverpic","fromUndefinedToZero","style","height","width","backgroundSize","backgroundPosition","backgroundImage","LandingPage","logIn","emailRef","passwordRef","preventDefault","password","faSearch","faPeopleCarry","onSubmit","toggleRegisterPopUp","RegisterPopUp","register","refName","refEmail","refPassword","refUserId","alert","registerData","propsSent","LoggedLanding","folowers","catch","interval","setInterval","clearInterval","components_UserBox","components_TimeLine","Loading","FollowButton","follow","UnfollowButton","unfollow","UserBoxInUserPage","notFound","followingButton","sendToState","undefined","followedId","loggedEmail","followingKeys","alt","components_FollowButton","components_UnfollowButton","UserPage","loaded","backgroundColor","marginTop","components_UserBoxInUserPage","ChangeThings","profilePic","coverPic","completed","filesToUpload","uploadedFiles","profileLink","coverLink","profilePicHandler","profilePicFile","target","files","size","coverPicHandler","coverPicFile","upload","profileStorageRef","storage","coverStorageRef","put","percentage","bytesTransferred","totalBytes","getDownloadURL","url","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","firstCheck","stateSetted","App","showPopUp","loadingFalse","signInWithEmailAndPassword","code","signOut","newUser","createUserWithEmailAndPassword","reload","_this4","basename","process","react_router","exact","path","render","components_Header","components_ChangeThings","components_LoggedLanding","components_UserPage","_this5","components_RegisterPopUp","components_Loading","components_LandingPage","_this6","renderLogged","renderNoLogged","hostname","ReactDOM","App_App","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"8RAsBeA,EAnBM,SAACC,GAClB,IAAIC,EAOJ,OAFIA,EAHCD,EAAME,OAAOC,WAGNH,EAAME,OAAOC,WAFb,wDAKRC,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAIR,EAAME,OAAOO,IACvBL,EAAAC,EAAAC,cAAA,OAAKI,UAAU,2BACXN,EAAAC,EAAAC,cAAA,OAAKG,GAAG,iBAAiBE,IAAKV,IAC9BG,EAAAC,EAAAC,cAAA,QAAMI,UAAU,sBAAsBV,EAAME,OAAOU,WACnDR,EAAAC,EAAAC,cAAA,QAAMI,UAAU,oBAAhB,IAAqCV,EAAME,OAAOO,OCQ/CI,6MApBXC,MAAQ,2EAEJ,GAAIC,KAAKf,MAAMgB,OAAOC,OAAS,EAAG,OAAO,KACzC,GAA+B,KAA3BF,KAAKf,MAAMkB,YAAoB,OAAO,KAC1C,IAAMC,EAAUJ,KAAKf,MAAMgB,OAC3B,OACIZ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,8BAEVS,EAAQC,IAAI,SAAClB,EAAQmB,GAClB,OAAOjB,EAAAC,EAAAC,cAACgB,EAAD,CAAcC,IAAKF,EAAGnB,OAAQA,MAGzCE,EAAAC,EAAAC,cAAA,OAAKI,UAAU,2BACXN,EAAAC,EAAAC,cAAA,MAAII,UAAU,sBAAd,+BAdUc,aCqEfC,6MAnEXX,MAAQ,KAIRY,iBAAmBC,EAAKD,iBAAiBE,KAAtBC,OAAAC,EAAA,EAAAD,CAAAF,sFAGfI,QAAQC,IAAI,mBACZjB,KAAKf,MAAM0B,iBAAiBX,KAAKf,MAAMiC,+CAK3C,IAgBIC,EAhBED,EAAelB,KAAKf,MAAMiC,aAE1BE,EAAUC,QAAQH,EAAa,IACjCI,EAAM,GACJC,EAAOL,EAAa,GAkB1B,MAhBwB,WAApBA,EAAa,GACbI,EAAO,oBACoB,SAApBJ,EAAa,GACpBI,EAAO,mBACoB,YAApBJ,EAAa,GACpBI,EAAO,4BACoB,YAApBJ,EAAa,KACpBI,EAAO,iCAKiCH,EAAvCD,EAAa,GAA+B,OAApB,SAKjC7B,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KACUJ,EAGF/B,EAAAC,EAAAC,cAAA,OAAKI,UAAS,0BAAA8B,OAA4BN,GAAQO,QAAS1B,KAAKW,kBACpDtB,EAAAC,EAAAC,cAAA,KAAGI,UAAU,qBACTN,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI8B,GACVlC,EAAAC,EAAAC,cAAA,QAAMI,UAAU,qBAAhB,IAAsC4B,EAAtC,MAEAlC,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAE,UAAAgC,OAAYP,EAAa,KAChCI,KAQjBjC,EAAAC,EAAAC,cAAA,OAAKI,UAAS,0BAAA8B,OAA4BN,GAAQO,QAAS1B,KAAKW,kBAC5DtB,EAAAC,EAAAC,cAAA,KAAGI,UAAU,qBACTN,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI8B,GACVlC,EAAAC,EAAAC,cAAA,QAAMI,UAAU,qBAAhB,IAAsC4B,EAAtC,MAECD,YA7DUb,aCsEZkB,6MApEX5B,MAAQ,KAERY,iBAAmB,SAACO,GAChB,IAAMU,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CC,EAAQJ,IAASK,OAAOC,YAAYF,MACtCG,EAAmB,GACnBC,EAAe,GAInBT,EAAQU,KAAK,QAAS,SAAAC,GAMlB,IALA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAIhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAI2B,GAASO,EAAME,EAAKpC,IAAX,MAAwB,CACjC8B,EAAmBI,EAAME,EAAKpC,IAAX,cACnB+B,EAAeG,EAAME,EAAKpC,IAAX,GACf,MAIR,IAAK,IAAIA,EAAI,EAAGA,EAAI8B,EAAiBlC,OAAQI,IACzC,GACQY,EAAa,KAAOkB,EAAiB9B,GAAG,IACxCY,EAAa,KAAOkB,EAAiB9B,GAAG,IACxCY,EAAa,KAAOkB,EAAiB9B,GAAG,IACxCY,EAAa,KAAOkB,EAAiB9B,GAAG,GAC9C,CACE8B,EAAiB9B,GAAG,GAAK,EACzB,SAKTqC,KAAK,WACJf,EAAQI,MAAMK,GAAcL,MAAM,iBAAiBY,IAAIR,8EAItD,IAAAS,EAAA7C,KAIL,OAAKA,KAAKf,MAAM6D,cAM+B,IAApC9C,KAAKf,MAAM6D,cAAc5C,OACxBb,EAAAC,EAAAC,cAAA,OAAKI,UAAU,2BACfN,EAAAC,EAAAC,cAAA,kDAKRF,EAAAC,EAAAC,cAAA,OAAKI,UAAU,2BACVK,KAAKf,MAAM6D,cAAczC,IAAI,SAACa,EAAaZ,GACzC,OAAOjB,EAAAC,EAAAC,cAACwD,EAAD,CAAc7B,aAAcA,EAAcP,iBAAkBkC,EAAKlC,iBAAkBH,IAAKF,OAblGjB,EAAAC,EAAAC,cAAA,OAAKI,UAAU,2BACXN,EAAAC,EAAAC,cAAA,yDAlDiBkB,aCGjCuC,EAAa,GAyOFC,6MApOXlD,MAAQ,CACJE,OAAQ,GACRiD,aAAe,GACf9D,WAAY,wDACZ0D,cAAe,GACfK,oBAAqB,EACrBC,mBAAmB,KAEvBC,UAAYC,IAAMC,cAElBC,OAAS5C,EAAK4C,OAAO3C,KAAZC,OAAAC,EAAA,EAAAD,CAAAF,MACTX,OAASW,EAAKX,OAAOY,KAAZC,OAAAC,EAAA,EAAAD,CAAAF,MACT6C,MAAQ7C,EAAK6C,MAAM5C,KAAXC,OAAAC,EAAA,EAAAD,CAAAF,MA6HR8C,eAAiB,WACb9C,EAAK3B,MAAMyE,oBAGfC,oBAAsB,WAClB/C,EAAKgD,SAAS,CACVR,mBAAoBxC,EAAKb,MAAMqD,4FAhInCS,OAAOC,SAASC,QAAQ,iDAGT,IAAAlB,EAAA7C,KAQf6B,IAASK,OAAO8B,mBAAmB,SAACzC,GAChC,GAAIA,EAAM,CACR,IAAMU,EAAQJ,IAASK,OAAOC,YAAYF,MACpCL,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CK,GAAe,EACjBjD,EAAa,GAEjBwC,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAIkC,EAAME,EAAKpC,IAAX,QAA4B2B,IAC1BI,EAAeG,EAAME,EAAKpC,IAAX,GAEXkC,EAAME,EAAKpC,IAAX,YAA8B,CAC/BlB,EAAYoD,EAAME,EAAKpC,IAAX,WACZ,SAIdqC,KAAK,WAKFN,GACAT,EAAQI,MAAMK,GAAcL,MAAM,iBAAiBiC,GAAG,QAAS,SAAAC,GAE3D,IAAMC,EAAmBD,EAASzB,MAC9BU,EAAsB,EAG1B,IAAMgB,EAOF,OAAO,KANV,IAAK,IAAI7D,EAAI,EAAGA,EAAI6D,EAAiBjE,OAAQI,IACX,IAA3B6D,EAAiB7D,GAAG,IACpB6C,IAORnC,QAAQC,IAAIkD,GAEZtB,EAAKe,SAAS,CAEVT,sBACAL,cAAeoB,EAASzB,UAO9BrD,EAAWc,OAAS,EACpB2C,EAAKe,SAAS,CACVxE,aACAgF,QAAQ,IAGZvB,EAAKe,SAAS,CACVQ,QAAO,0CASpB,IAAAC,EAAArE,KACDkD,EAAa,GACjBF,EAAY,GACZ,IAAMpB,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CsC,EAAQ,IAAIC,OAAOvE,KAAKqD,UAAUmB,QAAQC,MAAO,KAEvD,GAAqC,KAAjCzE,KAAKqD,UAAUmB,QAAQC,MAIvB,OAHAzE,KAAK4D,SAAS,CACV3D,OAAQ,KAEL,KAGX2B,EAAQU,KAAK,QAAS,SAAAC,GAKlB,IAJA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GACrBkC,EAAQ,EAEHpE,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAAO,CACpC,GAAIoE,EAAQ,EAAG,OAAO,MAElBJ,EAAMK,KAAKnC,EAAME,EAAKpC,IAAX,KAAyBgE,EAAMK,KAAKnC,EAAME,EAAKpC,IAAX,cAC/C0C,EAAW4B,KAAKpC,EAAME,EAAKpC,KAC3BoE,QAIT/B,KAAK,SAAAkC,GACJ3B,EAAYpC,OAAAgE,EAAA,EAAAhE,CAAQ,IAAIiE,IAAK/B,IAC7BqB,EAAKT,SAAS,CACVV,eACAjD,OAAQoE,EAAKhB,UAAUmB,QAAQC,2CAMvCzE,KAAKf,MAAM+F,0CAmBX,IAAmBC,EAAIC,EAHnBlF,KAAKD,MAAMmD,aAAahD,OAAS,IAAGF,KAAKD,MAAMmD,cAGhC+B,EAHyDjF,KAAKD,MAAMmD,aAGhEgC,EAH8E,KAMjFD,EAAI5E,IAAI,SAAA8E,GAAC,OAAGA,EAAED,KAEtB7E,IAAI,SAAC8E,EAAE7E,EAAE8E,GAAL,OAAcA,EAAMC,QAAQF,KAAO7E,GAAKA,IAE3CgF,OAAO,SAACH,GAAD,OAAMF,EAAIE,KAAI9E,IAAI,SAAA8E,GAAC,OAAEF,EAAIE,OAT7C,IAgBII,EAEEvF,KAAKD,MAAM+C,gBAOdyC,EAN8BvF,KAAKD,MAAM+C,cAAc0C,KAAK,SAAClG,EAAEmG,GAC1D,IAAIC,EAAQ,IAAIC,KAAKrG,EAAE,IAAIsG,UAEzB,OADU,IAAID,KAAKF,EAAE,IAAIG,UACVF,IAGqBG,MAAM,EAAE,IAMtD,OAAI7F,KAAKD,MAAMqE,OAEP/E,EAAAC,EAAAC,cAAA,OAAKI,UAAU,oBACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,eACfN,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAG,KACLJ,EAAAC,EAAAC,cAAA,MAAII,UAAU,iBAAd,SAEJN,EAAAC,EAAAC,cAAA,MAAII,UAAU,gBAAgB+B,QAAS1B,KAAK2D,qBAA5C,iBACC3D,KAAKD,MAAMoD,oBAAsB,EAAI9D,EAAAC,EAAAC,cAAA,QAAMI,UAAU,8BAA8BK,KAAKD,MAAMoD,qBAA8B,KAC5HnD,KAAKD,MAAMqD,kBAAoB/D,EAAAC,EAAAC,cAACuG,EAAD,CAAwBhD,cAAeyC,IAAyB,KAChGlG,EAAAC,EAAAC,cAAA,MAAII,UAAU,iCAAd,aAEAN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,cACfN,EAAAC,EAAAC,cAAA,MAAIG,GAAG,eAAP,SAEAL,EAAAC,EAAAC,cAAA,OAAKI,UAAU,gBACfN,EAAAC,EAAAC,cAAA,SAAOwG,SAAU/F,KAAKC,OAAQ8B,IAAK/B,KAAKqD,UAAW2C,KAAK,OAAOtG,GAAG,gBAAgBuG,YAAY,cAC9F5G,EAAAC,EAAAC,cAAC2G,EAAD,CAAiBjG,OAAQD,KAAKD,MAAMmD,aAAc/C,YAAaH,KAAKD,MAAME,SAC1EZ,EAAAC,EAAAC,cAAA,OAAKG,GAAG,yBAAyBgC,QAAS1B,KAAK0D,eAAgB9D,IAAKI,KAAKD,MAAMX,aAC/EC,EAAAC,EAAAC,cAAA,UAAQG,GAAG,gBAAgBgC,QAAS1B,KAAKwD,QAAzC,aAMJnE,EAAAC,EAAAC,cAAA,OAAKI,UAAU,oBACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,eACXN,EAAAC,EAAAC,cAAA,MAAII,UAAU,+BAAd,QACAN,EAAAC,EAAAC,cAAA,MAAII,UAAU,+BAAd,iBACAN,EAAAC,EAAAC,cAAA,MAAII,UAAU,+BAAd,aAEJN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,cACXN,EAAAC,EAAAC,cAAA,MAAIG,GAAG,eAAP,SAEJL,EAAAC,EAAAC,cAAA,OAAKI,UAAU,gBACXN,EAAAC,EAAAC,cAAA,SAAOwG,SAAU/F,KAAKC,OAAQ8B,IAAK/B,KAAKqD,UAAW2C,KAAK,OAAOtG,GAAG,gBAAgBuG,YAAY,cAC9F5G,EAAAC,EAAAC,cAAC2G,EAAD,CAAiBjG,OAAQD,KAAKD,MAAMmD,aAAc/C,YAAaH,KAAKD,MAAME,SAC1EZ,EAAAC,EAAAC,cAAA,OAAKG,GAAG,yBAAyBE,IAAI,sGACrCP,EAAAC,EAAAC,cAAA,UAAQG,GAAG,gBAAgBgC,QAAS1B,KAAKyD,OAAzC,mBA7NHhD,uDC4iBL0F,6MAxiBZpG,MAAQ,CACJqG,KAAM,GACN7E,KAAM,GACNnC,YAAY,EACZiH,QAAS,GACTC,MAAO,GACPC,YAAa,GACbC,SAAU,GACVC,YAAa,GACbC,kBAAmB,GACnBC,KAAM,GACNC,SAAU,GACVC,QAAS,GACTC,eAAe,EACfC,iBAAiB,EACjBC,kBAAmB,GACnBC,WAAY,IACZC,SAAS,KAoKbC,KAAO,WACH,IAAIlF,EAEJ,IAAMJ,IAASK,OAAOC,YAGlB,OAAO,KAFPF,EAAQJ,IAASK,OAAOC,YAAYF,MAMxC,IAAMmF,EAAevF,IAASC,WAAWC,MAAMC,MAAM,UAAUA,MAAMpB,EAAKb,MAAM8G,SAAS7E,MAAM,SACzFJ,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAE5CiF,EAAa,GACbX,EAAQ,GACRe,EAAoB,GACpBC,EAAkB,GAEtB,IAAKjG,QAAQY,GAAS,OAAO,KAE7BL,EAAQU,KAAK,QAAS,SAAAC,GAMlB,IALA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAIhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IACzB2B,IAAUO,EAAME,EAAKpC,IAAX,QACV2G,EAAazE,EAAME,EAAKpC,IAAX,GACbgH,EAAgB,GAAK9E,EAAME,EAAKpC,IAAX,IAGrBM,EAAKb,MAAMwB,OAASiB,EAAME,EAAKpC,IAAX,KACpB+G,EAAoB7E,EAAME,EAAKpC,IAAX,eAI5BgH,EAAgB,IAAK,IAAI3B,MAAO4B,cAChCD,EAAgB,GAAK,EACrBA,EAAgB,GAAK,OACrBA,EAAgB,GAAK1G,EAAKb,MAAM8G,QAI3BQ,EAGDA,EAAkBzC,KAAK0C,GAFvBD,EAAoB,CAACC,KAK1B3E,KAAK,WACJyE,EAAa9E,KAAK,QAAS,SAAAC,IACvB+D,EAAQ/D,EAAKE,OAIT6D,EAAM1B,KAAKqC,GAFXX,EAAQ,CAACW,KAIdtE,KAAK,SAAAkC,GACJuC,EAAaxE,IAAI0D,GAIbgB,EAAgB,KAAO1G,EAAKb,MAAMwB,MAClCK,EAAQI,MAAMpB,EAAKb,MAAMwB,MAAMS,MAAM,iBAAiBY,IAAIyE,GAG9DzG,EAAKgD,SAAS,CACVkD,eAAe,EACfP,YAAa3F,EAAKb,MAAMwG,YAAY,WAUpDiB,QAAU,WACN,IAAIvF,EAEJ,IAAMJ,IAASK,OAAOC,YAGlB,OAAO,KAFPF,EAAQJ,IAASK,OAAOC,YAAYF,MAKxC,IAAIoF,EAAoB,GAGlBD,EAAevF,IAASC,WAAWC,MAAMC,MAAM,UAAUA,MAAMpB,EAAKb,MAAM8G,SAAS7E,MAAM,SACzFJ,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAE5CiF,EAAa,GACbX,EAAQ,GAEZ1E,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IACzB2B,IAAUO,EAAME,EAAKpC,IAAX,QACV2G,EAAazE,EAAME,EAAKpC,IAAX,IAIbM,EAAKb,MAAMwB,OAASiB,EAAME,EAAKpC,IAAX,KACpB+G,EAAoB7E,EAAME,EAAKpC,IAAX,eAQxB+G,EAHCA,EAEmC,IAA7BA,EAAkBnH,OACL,GAEAmH,EAAkB/B,OAAO,SAAApE,GACzC,QAASA,EAAa,KAAO+F,GAAc/F,EAAa,KAAON,EAAKb,MAAM8G,WAL1D,GASpBI,IAAerG,EAAKb,MAAMwB,MAC9BK,EAAQI,MAAMpB,EAAKb,MAAMwB,MAAMS,MAAM,iBAAiBY,IAAIyE,KAI3D1E,KAAK,WAEJyE,EAAa9E,KAAK,QAAS,SAAAC,GAGnB+D,EADiB,KADrBA,EAAQ/D,EAAKE,OACHvC,OACE,GAEAoG,EAAMhB,OAAO,SAAAmC,GACjB,OAAOA,IAAWR,MAG3BtE,KAAK,SAAAkC,GACJuC,EAAaxE,IAAI0D,GACjB1F,EAAKgD,SAAS,CACVkD,eAAe,EACfP,YAAa3F,EAAKb,MAAMwG,YAAY,WAWpDmB,QAAS,WAEL,IAAIzF,EAEJ,IAAMJ,IAASK,OAAOC,YAGlB,OAAO,KAFPF,EAAQJ,IAASK,OAAOC,YAAYF,MAKxC,IAAML,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1C2F,EAAmB9F,IAASC,WAAWC,MAAMC,MAAM,UAAUA,MAAMpB,EAAKb,MAAM8G,SAAS7E,MAAM,eAE/FiF,EAAa,GAEbI,EAAoB,GACpBC,EAAkB,GAGtBM,IAAKC,KAAK,CACNC,MAAO,sBACP9B,KAAM,OACN+B,kBAAkB,EAClBC,mBAAoB,UACpBC,kBAAmB,OACnBC,kBAAmB,iBAClBvF,KAAK,SAACxD,GACHA,EAAOsF,OAEP7C,EAAQU,KAAK,QAAS,SAAAC,GAKlB,IAJA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GACrBkC,EAAQ,EAEHpE,EAAI,EAAGA,EAAIoC,EAAKxC,QACP,IAAVwE,EADyBpE,IAEzBkC,EAAME,EAAKpC,IAAX,QAA4B2B,IAC5BgF,EAAazE,EAAME,EAAKpC,IAAX,GACbgH,EAAgB,GAAK9E,EAAME,EAAKpC,IAAX,GACrBoE,KAGAlC,EAAME,EAAKpC,IAAX,KAAyBM,EAAKb,MAAMwB,OACpC8F,EAAoB7E,EAAME,EAAKpC,IAAX,cACpBoE,KAIR4C,EAAgB,IAAK,IAAI3B,MAAO4B,cAChCD,EAAgB,GAAK,EACrBA,EAAgB,GAAK,UACrBA,EAAgB,GAAK1G,EAAKb,MAAM8G,QAI3BQ,EAGDA,EAAkBzC,KAAK0C,GAFvBD,EAAoB,CAACC,KAO1B3E,KAAK,SAAAkC,GACJ8C,EAAiBrF,KAAK,QAAS,SAAAC,GAC3B,IAAIkE,EAAclE,EAAKE,MACjB0F,GAAc,IAAIxC,MAAO4B,cACzBa,EAAa,CAACnB,EAAYkB,GAE3B1B,EAGDA,EAAY7B,KAAKwD,GAFjB3B,EAAc,CAAC2B,GAKnBT,EAAiB/E,IAAI6D,GACrB7E,EAAQI,MAAMpB,EAAKb,MAAMwB,MAAMS,MAAM,iBAAiBY,IAAIyE,KAE3D1E,KAAK,SAAAkC,GACJ+C,IAAKC,KACD,aACA,GACA,WAEFjH,EAAKgD,SAAS,CACV8C,kBAAmB9F,EAAKb,MAAM2G,kBAAkB,aAgB1E2B,YAAc,WACV,IAAMzG,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CsG,EAAWzG,IAASC,WAAWC,MAAMC,MAAM,UAC7CuG,GAAW,EAEfX,IAAKC,KAAK,CACNC,MAAO,gBACPxG,KAAM,mCACN0E,KAAM,UACN+B,kBAAkB,EAClBC,mBAAoB,UACpBC,kBAAmB,OACnBC,kBAAmB,oBAClBvF,KAAK,SAACxD,GACHA,EAAOsF,OACP7C,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAIM,EAAKb,MAAMkH,aAAezE,EAAME,EAAKpC,IAAX,GAAsB,CAChDiI,GAAW,EACX,MAIR,GAAgB,GAAZA,EAAmB,OAAO,KAG9BD,EAAStG,MAAMpB,EAAKb,MAAM8G,SAASjE,IAAI,QAExCD,KAAM,WACL/B,EAAKgD,SAAS,CACVsD,SAAQ,IAEZU,IAAKC,KACD,WACA,+BACA,mGArcD,IAqBX5F,EArBWY,EAAA7C,KAAAwI,EACiIxI,KAAKf,MAAMwJ,MAApJrC,EADQoC,EACRpC,KAAM7E,EADEiH,EACFjH,KAAM8E,EADJmC,EACInC,QAASC,EADbkC,EACalC,MAAOE,EADpBgC,EACoBhC,SAAUC,EAD9B+B,EAC8B/B,YAAaE,EAD3C6B,EAC2C7B,KAAME,EADjD2B,EACiD3B,QAASN,EAD1DiC,EAC0DjC,YAAaG,EADvE8B,EACuE9B,kBAAmBK,EAD1FyB,EAC0FzB,gBAAiBC,EAD3GwB,EAC2GxB,kBACtH5H,GAAa,EACbsJ,EAAa,GAMbC,EAAiBtC,EAAQuC,MADR,SAQfC,EAAgB,GAIhBzB,EAAevF,IAASC,WAAWC,MAAMC,MAAM,UAAUA,MAAM6E,GAAS7E,MAAM,SAE9EJ,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAG1CH,IAASK,OAAOC,cAClBF,EAAQJ,IAASK,OAAOC,YAAYF,OAGxC,IAAIgF,EAAa,GAEX6B,EAAY,IAAInD,KAAKgB,GAEvBoC,GADe,IAAIpD,KACGmD,GAAW,IACjClC,EAAW,GAEXE,GAAgB,EAITiC,EAAU,GACjBnC,EAAQ,GAAAnF,OAAMuH,KAAKC,MAAMF,GAAjB,gBACDA,EAAU,MACjBA,EAAUC,KAAKC,MAAMF,EAAU,IAC/BnC,EAAQ,GAAAnF,OAAMsH,EAAN,gBACQ,IAAZA,IAAenC,EAAQ,GAAAnF,OAAMsH,EAAN,iBACpBA,EAAU,OACjBA,EAAUC,KAAKC,MAAMF,EAAU,MAC/BnC,EAAQ,GAAAnF,OAAMsH,EAAN,cACQ,IAAZA,IAAenC,EAAQ,GAAAnF,OAAMsH,EAAN,eACpBA,EAAU,QACjBA,EAAUC,KAAKC,MAAMF,EAAU,OAC/BnC,EAAQ,GAAAnF,OAAMsH,EAAN,aACQ,IAAZA,IAAenC,EAAQ,GAAAnF,OAAMsH,EAAN,cACpBA,EAAU,SACjBA,EAAUC,KAAKC,MAAMF,EAAU,QAC/BnC,EAAQ,GAAAnF,OAAMsH,EAAN,cACQ,IAAZA,IAAenC,EAAQ,GAAAnF,OAAMsH,EAAN,eACpBA,EAAU,UACjBA,EAAUC,KAAKC,MAAMF,EAAU,SAC/BnC,EAAQ,GAAAnF,OAAMsH,EAAN,eACQ,IAAZA,IAAenC,EAAQ,GAAAnF,OAAMsH,EAAN,iBAE3BA,EAAUC,KAAKC,MAAMF,EAAU,UAC/BnC,EAAQ,GAAAnF,OAAMsH,EAAN,cACQ,IAAZA,IAAenC,EAAQ,GAAAnF,OAAMsH,EAAN,eAG/BnH,EAAQU,KAAK,QAAS,SAAAC,GAMlB,IALA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAIhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAmB7B,GAjBI2B,IAAUO,EAAME,EAAKpC,IAAX,QACV2G,EAAazE,EAAME,EAAKpC,IAAX,GACboE,GAIAnD,IAASiB,EAAME,EAAKpC,IAAX,KACHkC,EAAME,EAAKpC,IAAX,YACFlB,EAAaoD,EAAME,EAAKpC,IAAX,WACboE,IAEAtF,EAAa,wDACbsF,IAKFiE,EACF,IAAK,IAAIO,EAAI,EAAGA,EAAIP,EAAezI,OAAQgJ,IACnCP,EAAeO,GAAGnF,QAAQ,IAAI,KAAOvB,EAAME,EAAKpC,IAAX,KACrCuI,EAAcF,EAAeO,GAAGnF,QAAQ,IAAI,KAAO,GAUnE,IAHA,IAAIoF,EAAkB9C,EAAQ+C,MAAM,KAG3B9I,EAAI,EAAGA,EAAI6I,EAAgBjJ,OAAQI,IACX,KAAzB6I,EAAgB7I,GAAG,IAAauI,EAAcQ,eAAeF,EAAgB7I,GAAGyD,QAAQ,IAAI,MACxF2E,EAAW9D,KAAKvF,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KAAgBnC,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI0J,EAAgB7I,GAAGyD,QAAQ,IAAK,KAAM1E,EAAAC,EAAAC,cAAA,QAAMI,UAAU,gBAAgBwJ,EAAgB7I,OAChIoI,EAAW9D,KAAK,OAEpB8D,EAAW9D,KAAKuE,EAAgB7I,IAChCoI,EAAW9D,KAAK,QASzBjC,KAAK,SAAAkC,GACJuC,EAAa9E,KAAK,QAAS,SAAAC,GACvB,IAAM+D,EAAQ/D,EAAKE,MAEnB,IAAK6D,EACD,OAAO,KAEP,IAAK,IAAIhG,EAAI,EAAGA,EAAIgG,EAAMpG,OAAQI,IAC1BgG,EAAMhG,KAAO2G,IACbH,GAAgB,KAI7BnE,KAAK,SAAAkC,GACJhC,EAAKe,SAAS,CACVwC,OACA7E,OACA8E,QAAUqC,EACVpC,QACAE,WACAC,cACAE,OACAC,WACAC,UACAC,gBACAP,cACAG,oBACAK,kBACAC,oBACA5H,aACA6H,aACAqC,SAAS,yCA0TrB,OAAItJ,KAAKD,MAAMmH,QAAgB,MAO3BhI,EAHCc,KAAKD,MAAMX,WAGJY,KAAKD,MAAMX,WAFX,6JAMRC,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KAEInC,EAAAC,EAAAC,cAAA,OAAKI,UAAU,cAEbK,KAAKD,MAAMgH,gBACb1H,EAAAC,EAAAC,cAAA,OAAKI,UAAU,eACXN,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiBC,KAAMC,MAD3B,IACwCpK,EAAAC,EAAAC,cAAA,0BAAkBS,KAAKD,MAAMiH,kBAAkBhH,KAAKD,MAAMiH,kBAAkB9G,OAAO,GAAG,KACrH,KAETb,EAAAC,EAAAC,cAAA,OAAKI,UAAU,mBACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,iBACXN,EAAAC,EAAAC,cAAA,OAAKG,GAAG,gBAAgBE,IAAKV,KAGjCG,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,aACXN,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAE,IAAAgC,OAAMzB,KAAKD,MAAMwB,OACzBlC,EAAAC,EAAAC,cAAA,QAAMI,UAAU,kBAAkBK,KAAKD,MAAMqG,KAA7C,MAEA/G,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAE,IAAAgC,OAAMzB,KAAKD,MAAMwB,OACzBlC,EAAAC,EAAAC,cAAA,QAAMI,UAAU,gBAAhB,IAAiCK,KAAKD,MAAMwB,OAE5ClC,EAAAC,EAAAC,cAAA,QAAMI,UAAU,cAAcK,KAAKD,MAAM6G,WAG7CvH,EAAAC,EAAAC,cAAA,OAAKI,UAAU,aACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,qBACRK,KAAKD,MAAMsG,QAAQnG,OAASF,KAAKD,MAAMsG,QAAQhG,IAAI,SAAAqJ,GAAI,OAAIA,IAAQ,OAI9ErK,EAAAC,EAAAC,cAAA,OAAKI,UAAU,aACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,kBACXN,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiB7J,GAAG,aAAa8J,KAAMG,OAE3CtK,EAAAC,EAAAC,cAAA,OAAKI,UAAU,kBACXN,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiB7J,GAAG,aAAagC,QAAS1B,KAAK0H,QAAU8B,KAAMC,MAC9DzJ,KAAKD,MAAM2G,kBAAoB,EAAIrH,EAAAC,EAAAC,cAAA,YAAOS,KAAKD,MAAM2G,mBAA4B,MAEtFrH,EAAAC,EAAAC,cAAA,OAAKI,UAAU,kBACVK,KAAKD,MAAM+G,cAAgBzH,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiB7J,GAAG,aAAaC,UAAU,cAAc6J,KAAMI,IAASlI,QAAS1B,KAAKwH,UAAcnI,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiB7J,GAAG,aAAa8J,KAAMI,IAASlI,QAAS1B,KAAKmH,OAC7LnH,KAAKD,MAAMwG,YAAc,EAAIlH,EAAAC,EAAAC,cAAA,YAAOS,KAAKD,MAAMwG,aAAsB,MAE1ElH,EAAAC,EAAAC,cAAA,OAAKI,UAAU,kBACVK,KAAKD,MAAMkH,YAAcjH,KAAKD,MAAMwB,KAAOlC,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiB7J,GAAG,aAAagC,QAAS1B,KAAKqI,YAAamB,KAAMK,MAAa,YArDnJ,IAAI3K,SA3eSoE,IAAM7C,WCVvBqJ,EAAW,GAyLAC,6MAtLXhK,MAAQ,CACJ0I,MAAQ,GACRrJ,YAAY,EACZ4K,SAAU,MAEdC,aAAe3G,IAAMC,cACrB2G,UAAUtJ,EAAKsJ,UAAUrJ,KAAfC,OAAAC,EAAA,EAAAD,CAAAF,MACVuJ,WAAWvJ,EAAKuJ,WAAWtJ,KAAhBC,OAAAC,EAAA,EAAAD,CAAAF,MACXwJ,WAAaxJ,EAAKwJ,WAAWvJ,KAAhBC,OAAAC,EAAA,EAAAD,CAAAF,MAEbyJ,aAAe,WACX,IAAMC,EAAe,QAErB,IAAK1J,EAAKb,MAAM0I,MAAMG,MAAM0B,GAAe,OAAO,KAIlD,IAFA,IAAI9H,EAAQ5B,EAAKb,MAAM0I,MAAMG,MAAM0B,GAE1BhK,EAAI,EAAGA,EAAIkC,EAAMtC,OAAQI,IAC9BkC,EAAMlC,GAAKkC,EAAMlC,GAAGyD,QAAQ,IAAK,IAGrC,OAAOvB,sFAIQ,IAAAK,EAAA7C,KACT4B,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CC,EAAQJ,IAASK,OAAOC,YAAYF,MACtC7C,GAAa,EAEjBwC,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IACzB2B,IAAUO,EAAME,EAAKpC,IAAX,QAENlB,EADEoD,EAAME,EAAKpC,IAAX,WACWkC,EAAME,EAAKpC,IAAX,WAEA,2DAI1BqC,KAAK,WACJE,EAAKe,SAAS,CACVxE,oDAIDmL,EAAU1D,GACjB7G,KAAKf,MAAMuL,cAAcD,EAAU1D,GACnC7G,KAAK4D,SAAS,CACV6E,MAAO,0CAKXzI,KAAK4D,SAAS,CACV6E,MAAQzI,KAAKiK,aAAazF,QAAQC,4CAI/B,IAAAJ,EAAArE,KACDyK,EAAczK,KAAKD,MAAM0I,MACzBE,EAAiB3I,KAAKqK,eAExB/C,EAAkB,GAClBoD,EAAqB,GACrBtI,EAAmB,GAEvB,GAA4B,IAAxBqI,EAAavK,OAAc,OAAO,KAEvCc,QAAQC,IAAI0H,GAEX,IAAMgC,EAAY9I,IAASK,OAAOC,YAAYF,MACxCqG,EAAWzG,IAASC,WAAWC,MAAMC,MAAM,UAC3CJ,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAE5CJ,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAO7B,GANIqK,IAAcnI,EAAME,EAAKpC,IAAI2B,QAC7B6H,EAAQ,MAAYa,EACpBb,EAAQ,KAAWtH,EAAME,EAAKpC,IAAIT,UAClCiK,EAAQ,OAAatH,EAAME,EAAKpC,IAAIZ,IAGlCiJ,EACF,IAAK,IAAIO,EAAI,EAAGA,EAAIP,EAAezI,OAAQgJ,IACnCP,EAAeO,KAAO1G,EAAME,EAAKpC,IAAX,KACtBoK,EAAmBlI,EAAME,EAAKpC,IAAX,IAAwBkC,EAAME,EAAKpC,IAAX,eAM3DU,QAAQC,IAAIyJ,KAEb/H,KAAK,SAAAkC,GACJ,IACM0F,EAAY,CACd5D,MAFa,IAAIhB,MAAO4B,cAGxBtF,MAAQ0I,EACRtE,QAAUoE,EACVrE,KAAO0D,EAAQ,KACfvI,KAAMuI,EAAQ,QAEZjD,EAAUyB,EAAS1D,OAAOpE,IAKhC,GAJA+J,EAAS,QAAc1D,EACvByB,EAAStG,MAAM6E,GAAS+D,OAAOL,GAGzB5B,EACF,IAAK,IAAIrI,EAAI,EAAGA,EAAIqI,EAAezI,OAAQI,IACvCgH,EAAgB,GAAKqB,EAAerI,GACpCgH,EAAgB,IAAK,IAAI3B,MAAO4B,cAChCD,EAAgB,GAAK,EACrBA,EAAgB,GAAK,UACrBA,EAAgB,GAAKT,GAErBzE,EAAmBsI,EAAmB/B,EAAerI,KAKjD8B,EAAiBwC,KAAK0C,GAFtBlF,EAAmB,CAACkF,GAQxBtG,QAAQC,IAAIyJ,EAAmBrB,eAAe/B,EAAgB,KAE1DwC,EAAQ,SAAexC,EAAgB,IACzCoD,EAAmBrB,eAAe/B,EAAgB,KAGpD1F,EAAQI,MAAMsF,EAAgB,IAAItF,MAAM,iBAAiBY,IAAIR,GAKrEiC,EAAK+F,WAAWG,EAAU1D,sCAYlC,IAAI3H,EASJ,OAJIA,EAHCc,KAAKD,MAAMX,WAGJY,KAAKD,MAAMX,WAFX,6JAORC,EAAAC,EAAAC,cAAA,OAAKI,UAAU,mBACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,2BACfN,EAAAC,EAAAC,cAAA,OAAKG,GAAG,wBAAwBE,IAAKV,KAGrCG,EAAAC,EAAAC,cAAA,OAAKI,UAAU,yBACXN,EAAAC,EAAAC,cAAA,YAAUwC,IAAK/B,KAAKiK,aAAclE,SAAU/F,KAAKmK,WAAY1F,MAAOzE,KAAKD,MAAM0I,MAAOoC,UAAU,MAAMlL,UAAU,cAAcqG,KAAK,OAAOC,YAAY,sBACtJ5G,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BACXN,EAAAC,EAAAC,cAAA,UAAQyG,KAAK,SAASrG,UAAU,cAAc+B,QAAS1B,KAAKkK,WAA5D,mBA/KCzJ,aCuWVqK,cAnWb,SAAAA,EAAY7L,GAAO,IAAA2B,EAAA,OAAAE,OAAAiK,EAAA,EAAAjK,CAAAd,KAAA8K,IACflK,EAAAE,OAAAkK,EAAA,EAAAlK,CAAAd,KAAAc,OAAAmK,EAAA,EAAAnK,CAAAgK,GAAAI,KAAAlL,KAAMf,KAEDc,MAAQ,CACToL,SAAS,EACTC,UAAW,GACXC,UAAU,EACVC,aAAc,GACdhC,SAAS,EACTiC,aAAY,EACZzB,SAAU,GACV0B,UAAW,IAGf5K,EAAK4J,cAAc5J,EAAK4J,cAAc3J,KAAnBC,OAAAC,EAAA,EAAAD,CAAAF,IACnBA,EAAK6K,aAAa7K,EAAK6K,aAAa5K,KAAlBC,OAAAC,EAAA,EAAAD,CAAAF,IAClBA,EAAK8K,WAAW9K,EAAK8K,WAAW7K,KAAhBC,OAAAC,EAAA,EAAAD,CAAAF,IAChBA,EAAK+K,kBAAkB/K,EAAK+K,kBAAkB9K,KAAvBC,OAAAC,EAAA,EAAAD,CAAAF,IACvBA,EAAKgL,SAAWhL,EAAKgL,SAAS/K,KAAdC,OAAAC,EAAA,EAAAD,CAAAF,IAChBA,EAAKiL,eAAgBjL,EAAKiL,eAAehL,KAApBC,OAAAC,EAAA,EAAAD,CAAAF,IAnBNA,mFAyBf,IAAMkL,EAAa,IAAIvH,OAAQ,UACzBwH,EAAWlI,OAAOC,SAASiI,SAC7BD,EAAWnH,KAAKoH,GACjB/L,KAAK6L,iBAER7L,KAAKyL,gDAIGH,EAAcD,GACrBrL,KAAK4D,SAAS,CAAC0H,eAAchC,SAAQ,EAAMiC,aAAa,EAAOF,mDAOnDd,EAAW1D,GACvB7G,KAAK4D,SAAS,CACZ4H,UAAS,CAAGjB,GAAH9I,OAAAX,OAAAgE,EAAA,EAAAhE,CAAgBd,KAAKD,MAAMyL,uDAMzB,IAAA3I,EAAA7C,KAGRN,EAAKmE,OAAOC,SAASiI,SAAShI,QAAQ,UAAW,IAEnDuH,EAAe,GAEbxB,EAAW,GAEXxB,EAAWzG,IAASC,WAAWC,MAAMC,MAAM,UAC3CJ,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAEhDsG,EAAShG,KAAK,QAAS,SAAAC,GAKrB,IAJA,IAGIyJ,EAHAC,EAAS1J,EAAKE,MACZC,EAAO5B,OAAO4B,KAAKuJ,GACrBvH,EAAQ,EAEHpE,EAAI,EAAGA,EAAIoC,EAAKxC,QAET,IAAVwE,EAF2BpE,IAI/B0L,GAAW,EAGPC,EAAOvJ,EAAKpC,IAAZ,UAA+BZ,IAEjCsM,GAAW,EACXtH,IAGAoF,EAAQ,GAASmC,EAAOvJ,EAAKpC,IAAZ,KAIX2L,EAAOvJ,EAAKpC,IAAZ,MACJ2L,EAAOvJ,EAAKpC,IAAZ,YAAgC2L,EAAOvJ,EAAKpC,IAAZ,MAAyBJ,OAEzD+L,EAAOvJ,EAAKpC,IAAZ,YAAgC,EAI7B2L,EAAOvJ,EAAKpC,IAAZ,cACH2L,EAAOvJ,EAAKpC,IAAZ,kBAAuC2L,EAAOvJ,EAAKpC,IAAZ,YAA+BJ,QAIxE+L,EAAOvJ,EAAKpC,IAAZ,aAAkC2L,EAAOvJ,EAAKpC,IAAZ,KAGlC2L,EAAOvJ,EAAKpC,IAAZ,iBAAqC,GAInC0L,GACJV,EAAa1G,KAAKqH,EAAOvJ,EAAKpC,MAKhC,SAAA4L,GAAUlL,QAAQC,IAAIiL,KAASvJ,KAAK,WAEpCf,EAAQU,KAAK,QAAS,SAAAC,GACpB,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEzBsH,EAAQ,UAAe,EAGvB,IAAK,IAAIxJ,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IACzBwJ,EAAQ,KAAWtH,EAAME,EAAKpC,IAAX,KACnBwJ,EAAQ,MAAYtH,EAAME,EAAKpC,IAAI2B,MACnC6H,EAAQ,KAAWtH,EAAME,EAAKpC,IAAIT,UAClCiK,EAAQ,UAAgB,CAACpK,MAIlCiD,KAAK,SAAAkC,GAENhC,EAAK+I,SAASN,EAAcxB,EAAQ,qDAWzB,IAAAzF,EAAArE,KACPsL,EAAe,GAEfxB,EAAW,GAEXxB,EAAWzG,IAASC,WAAWC,MAAMC,MAAM,UACjCH,IAASC,WAAWC,MAAMC,MAAM,SAGpCM,KAAK,QAAS,SAAAC,GACpB,IAOIoI,EAPEnI,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEnB9C,EAAKmE,OAAOC,SAASiI,SAAShI,QAAQ,IAAK,IAYjD,GAXA+F,EAAQ,SAAepK,EAAGQ,OAAS,EAI9B4J,EAAQ,WACba,EAAY9I,IAASK,OAAOC,YAAYF,OAMpC6H,EAAQ,SACV,IAAK,IAAIxJ,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC3BZ,IAAO8C,EAAME,EAAKpC,IAAX,KACPwJ,EAAQ,MAAYtH,EAAME,EAAKpC,IAAI2B,MACnC6H,EAAQ,KAAWtH,EAAME,EAAKpC,IAAIT,UAClCiK,EAAQ,GAAStH,EAAME,EAAKpC,IAAIZ,GAChCoK,EAAQ,UAAgB,CAACpK,SAM/B,IAAK,IAAIY,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAEzBqK,IAAcnI,EAAME,EAAKpC,IAAX,QACdwJ,EAAQ,MAAYtH,EAAME,EAAKpC,IAAI2B,MACnC6H,EAAQ,KAAWtH,EAAME,EAAKpC,IAAIT,UAClCiK,EAAQ,GAAStH,EAAME,EAAKpC,IAAIZ,GAChCoK,EAAQ,UAAgBtH,EAAME,EAAKpC,IAAI8K,WAOX,qBAA3BtB,EAAQ,UACjBA,EAAQ,UAAgB,CAACA,EAAQ,IAEjCA,EAAQ,UAAclF,KAAKkF,EAAQ,MAEtCnH,KAAK,SAAAkC,GAEJyD,EAAShG,KAAK,QAAS,SAAAC,GAKrB,IAJA,IAGIyJ,EAHAC,EAAS1J,EAAKE,MACZC,EAAO5B,OAAO4B,KAAKuJ,GAGhB3L,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAAI,CAmCnC,GAjCA0L,GAAW,EAGP3H,EAAKqH,WAAW5B,EAAQ,UAAcmC,EAAOvJ,EAAKpC,IAAZ,QAExC0L,GAAW,EAKLC,EAAOvJ,EAAKpC,IAAZ,MACJ2L,EAAOvJ,EAAKpC,IAAZ,YAAgC2L,EAAOvJ,EAAKpC,IAAZ,MAAyBJ,OAEzD+L,EAAOvJ,EAAKpC,IAAZ,YAAgC,EAI7B2L,EAAOvJ,EAAKpC,IAAZ,cACH2L,EAAOvJ,EAAKpC,IAAZ,kBAAuC2L,EAAOvJ,EAAKpC,IAAZ,YAA+BJ,QAIxE+L,EAAOvJ,EAAKpC,IAAZ,aAAkC2L,EAAOvJ,EAAKpC,IAAZ,KAGlC2L,EAAOvJ,EAAKpC,IAAZ,iBAAqC,GAQnC+D,EAAKsH,kBAAkB7B,EAAQ,UAAcmC,EAAOvJ,EAAKpC,IAAZ,aAAiC,CAEhF0L,GAAW,EAILC,EAAOvJ,EAAKpC,IAAZ,MACJ2L,EAAOvJ,EAAKpC,IAAZ,YAAgC2L,EAAOvJ,EAAKpC,IAAZ,MAAyBJ,OAEzD+L,EAAOvJ,EAAKpC,IAAZ,YAAgC,EAI7B2L,EAAOvJ,EAAKpC,IAAZ,cACH2L,EAAOvJ,EAAKpC,IAAZ,kBAAuC2L,EAAOvJ,EAAKpC,IAAZ,YAA+BJ,QAGxE,IAAIiM,EAAU9H,EAAKsH,kBAAkB7B,EAAQ,UAAcmC,EAAOvJ,EAAKpC,IAAZ,aAE3D2L,EAAOvJ,EAAKpC,IAAZ,kBAAuC6L,EAGvCF,EAAOvJ,EAAKpC,IAAZ,aAAkC6L,EAAQA,EAAQjM,OAAO,GAAG,GAG5D+L,EAAOvJ,EAAKpC,IAAZ,iBAAqC,EAMnC0L,IACJV,EAAa1G,KAAKqH,EAAOvJ,EAAKpC,KAC5BoE,KAKJ,SAAAwH,GAAUlL,QAAQC,IAAIiL,KACvBvJ,KAAM,SAAAkC,GACPR,EAAKuH,SAASN,EAAcxB,EAAQ,iDAUjCsC,EAAQC,GAEjB,MADuB,kBAAZD,IAAsBA,EAAS,CAACA,IACpC/K,QAAQ+K,EAAOE,KAAK,SAAAF,GACzB,OAAOA,IAAWC,+CAIJjB,EAAW3E,GAE3B,IAAKA,EAAa,OAAO,EAKzB,IAHA,IAAI8F,EAAS,GAJ2BC,EAAA,SAO/BlM,GACC8K,EAAUkB,KAAK,SAAAG,GACrB,OAAOA,IAAkBhG,EAAYnG,GAAG,MAGxCiM,EAAO3H,KAAK6B,EAAYnG,KALnBA,EAAI,EAAGA,EAAEmG,EAAYvG,OAAQI,IAAIkM,EAAjClM,GAST,OAAsB,IAAlBiM,EAAOrM,QAIJqM,mCAQD,IAAIG,EAAgB1M,KAAKD,MAAMuL,aAAa9F,KAAM,SAAClG,EAAEmG,GACnD,IAAIC,EAAQ,IAAIC,KAAKrG,EAAC,cAAkBsG,UAExC,OADY,IAAID,KAAKF,EAAC,cAAkBG,UACzBF,IAEf1E,QAAQC,IAAI,UAAWyL,GAEvB,IAAIC,EAAmB3M,KAAKD,MAAMyL,UAExC,OACInM,EAAAC,EAAAC,cAAA,OAAKI,UAAU,sBAEZK,KAAKD,MAAMsL,SAAY,KAAOhM,EAAAC,EAAAC,cAACqN,EAAD,CAAYpC,cAAexK,KAAKwK,gBAE9DmC,EAAiBtM,IAAI,SAACoI,EAAMnI,GAErB,OADNU,QAAQC,IAAI,UAAWwH,GAEbpJ,EAAAC,EAAAC,cAACsN,EAAD,CAAOrM,IAAKiI,EAAM5B,QAAS4B,MAAOA,MAK7CiE,EAAcrM,IAAI,SAACoI,EAAMnI,GAElB,OADNU,QAAQC,IAAI,UAAWwH,GAEbpJ,EAAAC,EAAAC,cAACsN,EAAD,CAAOrM,IAAKF,EAAGmI,MAAOA,cA5VzBnF,IAAM7C,WCuIdqM,6MAzIX/M,MAAQ,CACJqG,KAAM,GACN1G,GAAI,GACJ0L,UAAW,GACX2B,UAAY,GACZC,WAAY,GACZ5N,YAAY,EACZ6N,UAAU,sFAGM,IAAApK,EAAA7C,KACT4B,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CsG,EAAWzG,IAASC,WAAWC,MAAMC,MAAM,UAC3CC,EAAQJ,IAASK,OAAOC,YAAYF,MAE1C,SAASiL,EAAqB3K,GAC3B,MAAqB,qBAAVA,EAA8B,EAClCA,EAAKrC,OAGf,IAAIkG,EAAO,GACR1G,EAAK,GACL0L,EAAY,GACZ2B,EAAY,GACZC,EAAa,EACb5N,GAAa,EACb6N,GAAW,EAEdrL,EAAQU,KAAK,QAAS,SAAAC,GAInB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAI2B,IAAUO,EAAME,EAAKpC,IAAX,MAAyB,CACnC8F,EAAO5D,EAAME,EAAKpC,IAAX,UACPZ,EAAK8C,EAAME,EAAKpC,IAAX,GACL8K,EAAY8B,EAAoB1K,EAAME,EAAKpC,IAAX,WAChCyM,EAAYG,EAAoB1K,EAAME,EAAKpC,IAAX,WAChClB,EAAaoD,EAAME,EAAKpC,IAAX,WACb2M,EAAWzK,EAAME,EAAKpC,IAAX,SACX,SAGRqC,KAAK,SAAAkC,GACLyD,EAAShG,KAAK,QAAS,SAAAC,GAInB,IAHA,IAAM0J,EAAS1J,EAAKE,MACdC,EAAO5B,OAAO4B,KAAKuJ,GAEhB3L,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IACzB2B,IAAUgK,EAAOvJ,EAAKpC,IAAZ,OACV0M,MAGTrK,KAAK,SAAAkC,GACCzF,IACDA,EAAa,yDAEZ6N,IACDA,EAAW,qHAEfpK,EAAKe,SAAS,CACVwC,OAAM1G,KAAI0L,YAAW2B,YAAWC,aAAY5N,aAAY6N,kDASpE,IAAI/N,EAKAA,EAHCc,KAAKD,MAAMkN,SAGJjN,KAAKD,MAAMkN,SAFZ,6JAKX,IAAME,EAAQ,CACVC,OAAQ,OACRC,MAAO,OACPC,eAAgB,QAChBC,mBAAoB,SACpBC,gBAAe,OAAA/L,OAASvC,EAAT,MAGnB,OACIG,EAAAC,EAAAC,cAAA,OAAKI,UAAU,qBAEPN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,qBAAqBwN,MAAOA,IAE/C9N,EAAAC,EAAAC,cAAA,OAAKI,UAAU,mBACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,uBACHN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,2BACXN,EAAAC,EAAAC,cAAA,eAEIS,KAAKD,MAAMX,WACXC,EAAAC,EAAAC,cAAA,OAAKG,GAAG,kBAAkBE,IAAKI,KAAKD,MAAMX,aAC1CC,EAAAC,EAAAC,cAAA,OAAKG,GAAG,kBAAkBE,IAAI,iKAI9CP,EAAAC,EAAAC,cAAA,OAAKI,UAAU,yBACXN,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAE,GAAAgC,OAAKzB,KAAKD,MAAML,KACpBL,EAAAC,EAAAC,cAAA,OAAKG,GAAG,eAAeC,UAAU,wBAAwBK,KAAKD,MAAMqG,MACpE/G,EAAAC,EAAAC,cAAA,OAAKG,GAAG,iBAAiBC,UAAU,0BAAnC,IAA8DK,KAAKD,MAAML,OAKrFL,EAAAC,EAAAC,cAAA,OAAKI,UAAU,+BACZN,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI,IACLJ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BACXN,EAAAC,EAAAC,cAAA,MAAIG,GAAG,uBAAP,UACAL,EAAAC,EAAAC,cAAA,MAAIG,GAAG,kBAAkBM,KAAKD,MAAMiN,WAApC,OAIR3N,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI,IACNJ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,6BACXN,EAAAC,EAAAC,cAAA,MAAIG,GAAG,uBAAP,aACAL,EAAAC,EAAAC,cAAA,MAAIG,GAAG,kBAAkBM,KAAKD,MAAMqL,UAApC,MAHR,KAKA/L,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI,IACNJ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,6BACXN,EAAAC,EAAAC,cAAA,MAAIG,GAAG,uBAAP,aACAL,EAAAC,EAAAC,cAAA,MAAIG,GAAG,kBAAkBM,KAAKD,MAAMgN,UAApC,iBA/HVtM,aCqEPgN,6MAnEXC,MAAQ9M,EAAK8M,MAAM7M,KAAXC,OAAAC,EAAA,EAAAD,CAAAF,MAER+M,SAAWrK,IAAMC,cACjBqK,YAActK,IAAMC,iFAEd4B,GACFA,EAAE0I,iBAEF,IAAM5L,EAAQjC,KAAK2N,SAASnJ,QAAQC,MAC9BqJ,EAAW9N,KAAK4N,YAAYpJ,QAAQC,MAE1CzE,KAAKf,MAAMyO,MAAMzL,EAAM6L,oCAInB,OAEAzO,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,qBACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,oCACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,8CACXN,EAAAC,EAAAC,cAAA,UAAIF,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiBC,KAAMuE,MAA3B,sBAEJ1O,EAAAC,EAAAC,cAAA,OAAKI,UAAU,8CACXN,EAAAC,EAAAC,cAAA,UAAIF,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiBC,KAAMwE,MAA3B,iBAEJ3O,EAAAC,EAAAC,cAAA,OAAKI,UAAU,8CACXN,EAAAC,EAAAC,cAAA,UAAIF,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiBC,KAAMG,MAA3B,wBAKZtK,EAAAC,EAAAC,cAAA,OAAKI,UAAU,sBACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,sBACXN,EAAAC,EAAAC,cAAA,QAAM0O,SAAUjO,KAAK0N,OACrBrO,EAAAC,EAAAC,cAAA,SAAOI,UAAU,cAAcoC,IAAK/B,KAAK2N,SAAU3H,KAAK,OAAOC,YAAY,sBAC3E5G,EAAAC,EAAAC,cAAA,SAAOI,UAAU,cAAcoC,IAAK/B,KAAK4N,YAAa5H,KAAK,WAAWC,YAAY,aAClF5G,EAAAC,EAAAC,cAAA,UAAQI,UAAU,YAAYqG,KAAK,UAAnC,UAEA3G,EAAAC,EAAAC,cAAA,KAAGI,UAAU,gBAAb,0BAIJN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,qCACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,+BACXN,EAAAC,EAAAC,cAACgK,EAAA,EAAD,CAAiBC,KAAMuE,MACvB1O,EAAAC,EAAAC,cAAA,MAAIG,GAAG,QAAP,mDAEJL,EAAAC,EAAAC,cAAA,OAAKI,UAAU,+BACXN,EAAAC,EAAAC,cAAA,MAAII,UAAU,gBAAd,uBACAN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BAA0B+B,QAAS1B,KAAKf,MAAMiP,qBAA7D,WACA7O,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BAAf,aAQhBN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,gCA9DL2D,IAAM7C,WCqEjB0N,6MArEXC,SAAWxN,EAAKwN,SAASvN,KAAdC,OAAAC,EAAA,EAAAD,CAAAF,MAEXyN,QAAS/K,IAAMC,cACf+K,SAAUhL,IAAMC,cAChBgL,YAAajL,IAAMC,cACnBiL,UAAYlL,IAAMC,oFAET4B,GACLA,EAAE0I,iBAEF,IAAMzH,EAAKpG,KAAKqO,QAAQ7J,QAAQC,MAC1B2H,EAAQpM,KAAKwO,UAAUhK,QAAQC,MAC/BxC,EAAMjC,KAAKsO,SAAS9J,QAAQC,MAC5BqJ,EAAS9N,KAAKuO,YAAY/J,QAAQC,MAExC,GAAI2B,EAAKlG,OAAS,EAEd,OADA2D,OAAO4K,MAAM,2BACN,KACJ,GAAIrC,EAAOlM,OAAS,EAEvB,OADA2D,OAAO4K,MAAM,8BACN,KACJ,GAAIxM,EAAM/B,OAAS,EAEtB,OADA2D,OAAO4K,MAAO,2BACP,KACJ,GAAIX,EAAW,EAElB,OADAjK,OAAO4K,MAAM,+BACN,KAGX,IAAMC,EAAe,CACjBtI,OACAnE,QACA6L,WACA1B,UAGJpM,KAAKf,MAAMmP,SAASM,oCAGxB,OACIrP,EAAAC,EAAAC,cAAA,OAAKI,UAAU,4BACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,wBACXN,EAAAC,EAAAC,cAAA,sBAEAF,EAAAC,EAAAC,cAAA,QAAM0O,SAAUjO,KAAKoO,UACjB/O,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,sBACAF,EAAAC,EAAAC,cAAA,SAAOyG,KAAK,OAAO6E,UAAW,GAAI5E,YAAY,YAAYlE,IAAK/B,KAAKqO,WAExEhP,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,yBACAF,EAAAC,EAAAC,cAAA,SAAOyG,KAAK,OAAO6E,UAAW,GAAI5E,YAAY,UAAUlE,IAAK/B,KAAKwO,aAEtEnP,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,wBACAF,EAAAC,EAAAC,cAAA,SAAOyG,KAAK,QAAQ6E,UAAW,GAAI5E,YAAY,aAAalE,IAAK/B,KAAKsO,YAE1EjP,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,0BACAF,EAAAC,EAAAC,cAAA,SAAOyG,KAAK,OAAO6E,UAAW,GAAI5E,YAAY,WAAWlE,IAAK/B,KAAKuO,eAE3ElP,EAAAC,EAAAC,cAAA,UAAQyG,KAAK,UAAb,YAEA3G,EAAAC,EAAAC,cAAA,UAAQyG,KAAK,SAAStE,QAAS1B,KAAKf,MAAMiP,qBAA1C,kBAjEY5K,IAAM7C,WCG9BqJ,EAAW,GACX6E,GAAY,EAiFDC,iOAtEF,IAAAhO,EAAAZ,KACCiC,EAAQJ,IAASK,OAAOC,YAAYF,MACpCL,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAqChD,GApCiBH,IAASC,WAAWC,MAAMC,MAAM,UAExCM,KAAK,QAAS,SAAAC,GAMnB,IALA,IAAM0J,EAAS1J,EAAKE,MACdC,EAAO5B,OAAO4B,KAAKuJ,GACrBe,EAAa,EAGR1M,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IACzB2L,EAAOvJ,EAAKpC,IAAI2B,QAAUA,GAC1B+K,IAIRlD,EAAQ,WAAiBkD,IAM7BpL,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC1BkC,EAAME,EAAKpC,IAAI2B,QAAUA,IACzB6H,EAAQ,MAAY7H,EACpB6H,EAAQ,KAAWtH,EAAME,EAAKpC,IAAIT,UAClCiK,EAAQ,OAAatH,EAAME,EAAKpC,IAAIZ,GACpCoK,EAAQ,UAAgBtH,EAAME,EAAKpC,IAAI8K,UACvCtB,EAAQ,UAAgBtH,EAAME,EAAKpC,IAAIuO,YAG/CC,MAAM,SAAA5C,GAAUlL,QAAQC,IAAIiL,MAG1ByC,EACD,IAAII,EAAWC,YAAY,SAAAnK,IACnBxD,QAAQyI,EAAS1D,OAAS/E,QAAQyI,EAASkD,eAC3CiC,cAAcF,GACdJ,GAAY,EACZ/N,EAAKgD,SAAS,MAEnB,KAIP,OAEIvE,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KACInC,EAAAC,EAAAC,cAAA,OAAKI,UAAU,iBACCN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,YACfN,EAAAC,EAAAC,cAAC2P,EAAD,CAASpF,SAAUA,KAGnBzK,EAAAC,EAAAC,cAAA,OAAKI,UAAU,WACfN,EAAAC,EAAAC,cAAC4P,EAAD,CAAUrF,SAAUA,KAGpBzK,EAAAC,EAAAC,cAAA,OAAKI,UAAU,uBArEnB2D,IAAM7C,WCAnB2O,EARC,WACZ,OACI/P,EAAAC,EAAAC,cAAA,OAAKI,UAAU,WACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,eAAcN,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,YAAWF,EAAAC,EAAAC,cAAA,eCgBnJ8P,6MAjBXtP,MAAQ,KACRuP,OAAS1O,EAAK0O,OAAOzO,KAAZC,OAAAC,EAAA,EAAAD,CAAAF,4EAGLZ,KAAKf,MAAMqQ,0CAKX,OACIjQ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,mBACfN,EAAAC,EAAAC,cAAA,QAAMI,UAAU,gBAAgB+B,QAAS1B,KAAKsP,QAA9C,kBAZe7O,aCkBZ8O,6MAjBXxP,MAAQ,KAERyP,SAAW5O,EAAK4O,SAAS3O,KAAdC,OAAAC,EAAA,EAAAD,CAAAF,8EAGPZ,KAAKf,MAAMuQ,4CAIX,OACInQ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,mBACfN,EAAAC,EAAAC,cAAA,QAAMI,UAAU,kBAAkB+B,QAAS1B,KAAKwP,UAAhD,oBAZiB/O,aC4WdgP,6MAvWX1P,MAAQ,CACJqG,KAAM,GACN1G,GAAI,GACJ0L,UAAW,GACX2B,UAAW,GACXC,WAAY,GACZ0C,UAAU,EACVC,iBAAkB,EAClBvQ,YAAY,EACZ6N,UAAU,KAKd2C,YAAchP,EAAKgP,YAAY/O,KAAjBC,OAAAC,EAAA,EAAAD,CAAAF,MA8Hd0O,OAAS,WACL,IAAM1N,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CC,EAAQJ,IAASK,OAAOC,YAAYF,MAEtCoF,EAAoB,GACpBC,EAAkB,GAGhB5H,EAAKkB,EAAKb,MAAML,GAElB0L,OAAYyE,EACZ9C,OAAY8C,EAEZpD,EAAgB,GAEpB7K,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAGzBkC,EAAME,EAAKpC,IAAX,QAA4B2B,IAC5BjB,QAAQC,IAAIuB,EAAME,EAAKpC,KACvB8K,EAAY5I,EAAME,EAAKpC,IAAX,UACZmM,EAAgBjK,EAAME,EAAKpC,IAAX,GAGhBgH,EAAgB,GAAK9E,EAAME,EAAKpC,IAAX,IAIrBZ,IAAO8C,EAAME,EAAKpC,IAAX,KACP+G,EAAoB7E,EAAME,EAAKpC,IAAX,eAIF,qBAAf8K,EACPA,EAAY,CAAC1L,GAEb0L,EAAUxG,KAAKlF,GAInB4H,EAAgB,IAAK,IAAI3B,MAAO4B,cAChCD,EAAgB,GAAK,EACrBA,EAAgB,GAAK,SAEhBD,EAGDA,EAAkBzC,KAAK0C,GAFvBD,EAAoB,CAACC,GAMzB1F,EAAQI,MAAMtC,GAAIsC,MAAM,iBAAiBY,IAAIyE,GAK7C,IAAK,IAAI/G,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAGzBkC,EAAME,EAAKpC,IAAX,KAAyBZ,IACzBsB,QAAQC,IAAIuB,EAAME,EAAKpC,KAGG,qBAF1ByM,EAAYvK,EAAME,EAAKpC,IAAX,WAGRyM,EAAY,CAACN,GAEbM,EAAUnI,KAAK6H,IAK3BzL,QAAQC,IAAI8L,GAEZnL,EAAQI,MAAMtC,GAAIsC,MAAM,aAAaY,IAAImK,GACzCnL,EAAQI,MAAMyK,GAAezK,MAAM,aAAaY,IAAIwI,KAErDzI,KAAM,SAAAkC,GACL7D,QAAQC,IAAI,kBACZL,EAAKgD,SAAS,CACV+L,gBAAgB,EAChB5C,UAAWnM,EAAKb,MAAMgN,UAAW,SAK7CyC,SAAU,WACN,IAAM5N,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CC,EAAQJ,IAASK,OAAOC,YAAYF,MAEtCoF,EAAoB,GAElB3H,EAAKkB,EAAKb,MAAML,GAElB0L,EAAY,GACZ2B,EAAY,GAEZN,EAAgB,GAEpB7K,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAGzBkC,EAAME,EAAKpC,IAAX,QAA4B2B,IAC5BmJ,EAAY5I,EAAME,EAAKpC,IAAX,UACZmM,EAAgBjK,EAAME,EAAKpC,IAAX,IAIhBZ,IAAO8C,EAAME,EAAKpC,IAAX,KACP+G,EAAoB7E,EAAME,EAAKpC,IAAX,eAQpB+G,EAHCA,EAEmC,IAA7BA,EAAkBnH,OACL,GAEAmH,EAAkB/B,OAAO,SAAApE,GACzC,QAASA,EAAa,KAAOuL,GAAqC,WAApBvL,EAAa,MAL3C,GASxBU,EAAQI,MAAMtC,GAAIsC,MAAM,iBAAiBY,IAAIyE,GAM7C+D,EADqB,IAArBA,EAAUlL,OACE,GAEAkL,EAAU9F,OAAO,SAAAwK,GACzB,OAAOA,IAAepQ,IAI9B,IAAK,IAAIY,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAGzBkC,EAAME,EAAKpC,IAAX,KAAyBZ,IAGA,KAFzBqN,EAAYvK,EAAME,EAAKpC,IAAX,WAEEJ,OACV6M,EAAY,GAEZA,EAAUzH,OAAO,SAAAwK,GACb,OAAOA,IAAerD,KAStC7K,EAAQI,MAAMtC,GAAIsC,MAAM,aAAaY,IAAImK,GACzCnL,EAAQI,MAAMyK,GAAezK,MAAM,aAAaY,IAAIwI,KAErDzI,KAAK,SAAAkC,GACJjE,EAAKgD,SAAS,CACV+L,gBAAgB,EAChB5C,UAAWnM,EAAKb,MAAMgN,UAAW,kFArShC3G,EAAM1G,EAAI0L,EAAW2B,EAAWC,EAAY2C,EAAgBvQ,EAAY6N,GAChFjN,KAAK4D,SAAS,CACXwC,OAAM1G,KAAI0L,YAAW2B,YAAWC,aAAY2C,kBAAgBvQ,aAAY6N,yDAI7D,IAAApK,EAAA7C,KAEfgB,QAAQC,IAAI,YAEZ,IAAMW,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CsG,EAAWzG,IAASC,WAAWC,MAAMC,MAAM,UAE7CC,EAAQ,GAERmE,EAAO,GACR1G,EAAKmE,OAAOC,SAASiI,SAAShI,QAAQ,IAAK,IAC3CqH,EAAY,GACZ2B,EAAY,GACZC,EAAa,EACb2C,GAAmB,EACnBvQ,GAAa,EACb6N,GAAW,EAOd,SAASC,EAAqB3K,GAC3B,MAAqB,qBAAVA,EAA8B,EAClCA,EAAKrC,OAKf0B,EAAQU,KAAK,QAAS,SAAAC,GAInB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAIZ,IAAO8C,EAAME,EAAKpC,IAAX,GAAsB,CAC7B8F,EAAO5D,EAAME,EAAKpC,IAAX,UACP8K,EAAY8B,EAAoB1K,EAAME,EAAKpC,IAAX,WAChCyM,EAAYG,EAAoB1K,EAAME,EAAKpC,IAAX,WAChC2B,EAAQO,EAAME,EAAKpC,IAAX,MACRlB,EAAaoD,EAAME,EAAKpC,IAAX,WACb2M,EAAWzK,EAAME,EAAKpC,IAAX,SACX,SAKRqC,KAAK,SAAAkC,GACLyD,EAAShG,KAAK,QAAS,SAAAC,GAInB,IAHA,IAAM0J,EAAS1J,EAAKE,MACdC,EAAO5B,OAAO4B,KAAKuJ,GAEhB3L,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IACzB2B,IAAUgK,EAAOvJ,EAAKpC,IAAZ,OACV0M,MAGTrK,KAAK,SAAAkC,GAEFzF,IACDA,EAAa,yDAEZ6N,IACDA,EAAW,qHAGXpL,IAASK,OAAO8B,mBAAmB,SAACzC,GAChC,GAAIA,EAAM,CACN,IAAMwO,EAAclO,IAASK,OAAOC,YAAYF,MAGhDL,EAAQU,KAAK,QAAS,SAAAC,GAIlB,IAHA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAIyP,IAAgBvN,EAAME,EAAKpC,IAAX,MAAwB,CAEzBkC,EAAME,EAAKpC,IAAX,GAEf,GAAIZ,IAAO8C,EAAME,EAAKpC,IAAX,GAAsB,MAEjC,GAA2C,oBAAhCkC,EAAME,EAAKpC,IAAX,UAA4C,CACnDqP,EAAkB,EAClB,MAOJ,IAHA,IAAMvE,EAAY5I,EAAME,EAAKpC,IAAX,UACZ0P,EAAgBlP,OAAO4B,KAAKF,EAAME,EAAKpC,IAAX,WAEzB4I,EAAI,EAAGA,EAAG8G,EAAc9P,OAAQgJ,IAAK,CAC1C,GAAIxJ,IAAO0L,EAAU4E,EAAc9G,IAAK,CACpCyG,EAAkB,EAClB,MAEAA,EAAkB,GAMlC9M,EAAKe,SAAS,CACVwC,OAAM1G,KAAI0L,YAAW2B,YAAWC,aAAY2C,kBAAiBvQ,aAAY6N,oBAKjFjM,QAAQC,IAAI,iBAAkBmF,EAAM1G,EAAI0L,EAAW2B,EAAWC,EAAY2C,GAC1E9M,EAAKe,SAAS,CACVwC,OAAM1G,KAAI0L,YAAW2B,YAAWC,aAAY2C,kBAAiBvQ,aAAY6N,oDAyL7F,OACI5N,EAAAC,EAAAC,cAAA,OAAKI,UAAU,uBAEVK,KAAKD,MAAMX,WACZC,EAAAC,EAAAC,cAAA,OAAKG,GAAG,kBAAkBE,IAAKI,KAAKD,MAAMX,WAAY6Q,IAAI,oBAC1D5Q,EAAAC,EAAAC,cAAA,OAAKG,GAAG,kBAAkBE,IAAI,6JAA6JqQ,IAAI,oBAE/L5Q,EAAAC,EAAAC,cAAA,MAAIG,GAAG,kBAAkBM,KAAKD,MAAMqG,MACpC/G,EAAAC,EAAAC,cAAA,KAAGG,GAAG,kBAAN,IAAyBM,KAAKD,MAAML,IACpCL,EAAAC,EAAAC,cAAA,KAAGG,GAAG,yBAAN,8BAIkC,IAAhCM,KAAKD,MAAM4P,gBAA0B,KAAwC,IAA/B3P,KAAKD,MAAM4P,gBAAyBtQ,EAAAC,EAAAC,cAAC2Q,EAAD,CAAcZ,OAAQtP,KAAKsP,SAAYjQ,EAAAC,EAAAC,cAAC4Q,EAAD,CAAgBX,SAAUxP,KAAKwP,WAGtJnQ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,yDACZN,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI,IACLJ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BACXN,EAAAC,EAAAC,cAAA,MAAIG,GAAG,uBAAP,UACAL,EAAAC,EAAAC,cAAA,MAAIG,GAAG,kBAAkBM,KAAKD,MAAMiN,WAApC,OAIR3N,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI,IACNJ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,6BACXN,EAAAC,EAAAC,cAAA,MAAIG,GAAG,uBAAP,aACAL,EAAAC,EAAAC,cAAA,MAAIG,GAAG,kBAAkBM,KAAKD,MAAMqL,UAApC,MAHR,KAKA/L,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAMC,GAAI,IACNJ,EAAAC,EAAAC,cAAA,OAAKI,UAAU,6BACXN,EAAAC,EAAAC,cAAA,MAAIG,GAAG,uBAAP,aACAL,EAAAC,EAAAC,cAAA,MAAIG,GAAG,kBAAkBM,KAAKD,MAAMgN,UAApC,gBA9VAtM,aC4EjB2P,6MA5EXrQ,MAAQ,CACJsQ,QAAS,EACTpD,UAAU,sFAGM,IAAApK,EAAA7C,KAEV4B,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAC1CtC,EAAKM,KAAKf,MAAMS,GAClBuN,GAAW,EAEfrL,EAAQU,KAAK,QAAS,SAAAC,GAKlB,IAJA,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAGhBlC,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IACzBZ,IAAO8C,EAAME,EAAKpC,IAAX,IACDkC,EAAME,EAAKpC,IAAX,WACF2M,EAAWzK,EAAME,EAAKpC,IAAX,YAMxBqC,KAAK,WACCsK,IACDA,EAAW,qHAEnBpK,EAAKe,SAAS,CACFqJ,gDAMZ,IAAI/N,EAKAA,EAHCc,KAAKD,MAAMkN,SAGJjN,KAAKD,MAAMkN,SAFZ,6JAOX,IAAME,EAAQ,CACVC,OAAQ,QACRC,MAAO,OACPC,eAAgB,QAChBC,mBAAoB,SACpBC,gBAAe,OAAA/L,OAASvC,EAAT,KACfoR,gBAAiB,QACjBC,UAAW,QAEf,OACIlR,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KAEInC,EAAAC,EAAAC,cAAA,OAAKI,UAAU,sBAAsBwN,MAAOA,IAE5C9N,EAAAC,EAAAC,cAAA,OAAKI,UAAU,wCAGKN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,YACfN,EAAAC,EAAAC,cAACiR,EAAD,OAGAnR,EAAAC,EAAAC,cAAA,OAAKI,UAAU,WACfN,EAAAC,EAAAC,cAAC4P,EAAD,gBArEb1O,aC4ORgQ,6MA9OX1Q,MAAQ,CACJ2Q,WAAY,GACZC,SAAU,GACVxF,QAAS,GACTyF,WAAW,EACXC,cAAe,EACfC,cAAe,EACfC,YAAa,GACbC,UAAW,MAGfC,kBAAoB,SAAC9L,GAEhB,IAAM+L,EAAiB/L,EAAEgM,OAAOC,MAAM,GAEV,cAAxBF,EAAelL,MAAgD,eAAxBkL,EAAelL,KAEnDkL,EAAeG,KAAO,IACvBxN,OAAO4K,MAAM,qDAEX7N,EAAKgD,SAAS,CACX8M,WAAYQ,KAKnBrN,OAAO4K,MAAM,2BACbtJ,EAAEgM,OAAO1M,MAAQ,SAM1B6M,gBAAkB,SAACnM,GACf,IAAMoM,EAAepM,EAAEgM,OAAOC,MAAM,GAET,cAAtBG,EAAavL,MAA8C,eAAtBuL,EAAavL,KAE/CuL,EAAaF,KAAO,IACpBxN,OAAO4K,MAAM,mDAEb7N,EAAKgD,SAAS,CACV+M,SAAUY,KAMjB1N,OAAO4K,MAAM,2BACbtJ,EAAEgM,OAAO1M,MAAQ,SAQ1B+M,OAAS,SAACrM,GACN,IAAMuL,EAAa9P,EAAKb,MAAM2Q,WACxBC,EAAW/P,EAAKb,MAAM4Q,SAEtB/O,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAE1CC,EAAQJ,IAASK,OAAOC,YAAYF,MACpCwP,EAAoB5P,IAAS6P,UAAU3P,IAAnB,IAAAN,OAA2BQ,EAA3B,iBAAAR,OAAgDiP,EAAWtK,OAC/EuL,EAAkB9P,IAAS6P,UAAU3P,IAAnB,IAAAN,OAA2BQ,EAA3B,eAAAR,OAA8CkP,EAASvK,OAIzC,kBAA3BxF,EAAKb,MAAM2Q,YAA4D,kBAAzB9P,EAAKb,MAAM4Q,UAEhE/P,EAAKgD,SAAS,CAACiN,cAAe,IAE7BY,EAAkBG,IAAIlB,GAAYzM,GAAG,gBAAgB,SAAAC,GAClD,IAAI2N,EAAc3N,EAAS4N,iBAAmB5N,EAAS6N,WAAc,IACrEnR,EAAKgD,SAAS,CAACuH,QAAS0G,KAEzB,SAAA3F,GACClL,QAAQC,IAAIiL,IAEb,WAECtK,EAAQU,KAAK,QAAS,SAAAC,GAClB,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEzBiP,EAAkBO,iBAAiBrP,KAAK,SAACsP,GACrC,IAAK,IAAI3R,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAIkC,EAAME,EAAKpC,IAAX,QAA4B2B,EAAO,CACnCL,EAAQI,MAAMQ,EAAME,EAAKpC,IAAX,IAAsB0B,MAAM,cAAcY,IAAIqP,GAC5D,WAMbtP,KAAK,WACJ/B,EAAKgD,SAAS,CACVgN,WAAW,EACXzF,QAAS,EACT2F,cAAe,MAKvBa,EAAgBC,IAAIjB,GAAU1M,GAAG,gBAAgB,SAAAC,GAC7C,IAAI2N,EAAc3N,EAAS4N,iBAAmB5N,EAAS6N,WAAc,IACrEnR,EAAKgD,SAAS,CAACuH,QAAS0G,KACzB,SAAA3F,GACClL,QAAQC,IAAIiL,IACb,WACCtK,EAAQU,KAAK,QAAS,SAAAC,GAClB,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEzBmP,EAAgBK,iBAAiBrP,KAAK,SAACsP,GACnC,IAAK,IAAI3R,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAIkC,EAAME,EAAKpC,IAAX,QAA4B2B,EAAO,CACnCL,EAAQI,MAAMQ,EAAME,EAAKpC,IAAX,IAAsB0B,MAAM,YAAYY,IAAIqP,GAC1D,WAMbtP,KAAK,WACJ/B,EAAKgD,SAAS,CACVgN,WAAW,EACXzF,QAAS,EACT2F,cAAe,WAKU,kBAA3BlQ,EAAKb,MAAM2Q,YAA4D,kBAAzB9P,EAAKb,MAAM4Q,UAGvE/P,EAAKgD,SAAS,CAACiN,cAAe,IAE9BY,EAAkBG,IAAIlB,GAAYzM,GAAG,gBAAgB,SAAAC,GACjD,IAAI2N,EAAc3N,EAAS4N,iBAAmB5N,EAAS6N,WAAc,IACrEnR,EAAKgD,SAAS,CAACuH,QAAS0G,KACzB,SAAA3F,GACClL,QAAQC,IAAIiL,IACb,WAGCtK,EAAQU,KAAK,QAAS,SAAAC,GAClB,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEzBiP,EAAkBO,iBAAiBrP,KAAK,SAACsP,GACrC,IAAK,IAAI3R,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAIkC,EAAME,EAAKpC,IAAX,QAA4B2B,EAAO,CACnCL,EAAQI,MAAMQ,EAAME,EAAKpC,IAAX,IAAsB0B,MAAM,cAAcY,IAAIqP,GAC5D,WAMbtP,KAAK,WACJ/B,EAAKgD,SAAS,CACVgN,WAAW,EACXzF,QAAS,EACT2F,cAAe,UAS3BlQ,EAAKgD,SAAS,CAACiN,cAAe,IAE9Bc,EAAgBC,IAAIjB,GAAU1M,GAAG,gBAAgB,SAAAC,GAC7C,IAAI2N,EAAc3N,EAAS4N,iBAAmB5N,EAAS6N,WAAc,IACrEnR,EAAKgD,SAAS,CAACuH,QAAS0G,KACzB,SAAA3F,GACClL,QAAQC,IAAIiL,IACb,WACCtK,EAAQU,KAAK,QAAS,SAAAC,GAClB,IAAMC,EAAQD,EAAKE,MACbC,EAAO5B,OAAO4B,KAAKF,GAEzBmP,EAAgBK,iBAAiBrP,KAAK,SAACsP,GACnC,IAAK,IAAI3R,EAAI,EAAGA,EAAIoC,EAAKxC,OAAQI,IAC7B,GAAIkC,EAAME,EAAKpC,IAAX,QAA4B2B,EAAO,CACnCL,EAAQI,MAAMQ,EAAME,EAAKpC,IAAX,IAAsB0B,MAAM,YAAYY,IAAIqP,GAC1D,WAMbtP,KAAK,WACJ/B,EAAKgD,SAAS,CACVgN,WAAW,EACXzF,QAAS,EACT2F,cAAe,YAQnCpN,eAAiB,WACb9C,EAAK3B,MAAMyE,0FAOX,OACIrE,EAAAC,EAAAC,cAAA,OAAKI,UAAU,0BACXN,EAAAC,EAAAC,cAAA,OAAKI,UAAU,wBACXN,EAAAC,EAAAC,cAAA,YACAF,EAAAC,EAAAC,cAAA,oCACAF,EAAAC,EAAAC,cAAA,SAAOyG,KAAK,OAAOD,SAAU/F,KAAKiR,kBAAmBtR,UAAU,eAAeyG,KAAK,yBACnF/G,EAAAC,EAAAC,cAAA,wCACAF,EAAAC,EAAAC,cAAA,SAAOyG,KAAK,OAAOD,SAAU/F,KAAKsR,gBAAiB3R,UAAU,eAAeyG,KAAK,4BACjF/G,EAAAC,EAAAC,cAAA,OAAKI,UAAU,wBACVK,KAAKD,MAAMoL,QAAU,EAAI9L,EAAAC,EAAAC,cAAA,0BAAkBS,KAAKD,MAAM+Q,cAA7B,OAAgD9Q,KAAKD,MAAM8Q,cAA3D,KAAkF,KAC3G7Q,KAAKD,MAAM6Q,UAAYvR,EAAAC,EAAAC,cAAA,kBAAU,MAAV,cAAkC,KAC9DF,EAAAC,EAAAC,cAAA,UAAQyG,KAAK,SAAStE,QAAS1B,KAAKwR,OAAQ7R,UAAU,iBAAtD,UAEAN,EAAAC,EAAAC,cAAA,UAAQyG,KAAK,SAAStE,QAAS1B,KAAK0D,eAAgB/D,UAAU,gBAA9D,oBAtOOc,aCoB3BoB,IAASqQ,cAVc,CACnBC,OAAQ,0CACRC,WAAY,+CACZC,YAAa,sDACbC,UAAW,+BACXC,cAAe,2CACfC,kBAAmB,eACnBC,MAAO,wCAKX,IAAM7Q,EAAUC,IAASC,WAAWC,MAAMC,MAAM,SAG5CoC,GAFavC,IAASC,WAAWC,MAAMC,MAAM,WAEpC,GACTmJ,GAAU,EACVuH,GAAa,EACbC,GAAc,EAYGC,6MACpB7S,MAAO,CACJ8S,WAAW,EACX1H,QAASA,KAEX+C,oBAAsBtN,EAAKsN,oBAAoBrN,KAAzBC,OAAAC,EAAA,EAAAD,CAAAF,MACtBwN,SAAWxN,EAAKwN,SAASvN,KAAdC,OAAAC,EAAA,EAAAD,CAAAF,MACX8M,MAAQ9M,EAAK8M,MAAM7M,KAAXC,OAAAC,EAAA,EAAAD,CAAAF,MACRoE,OAASpE,EAAKoE,OAAOnE,KAAZC,OAAAC,EAAA,EAAAD,CAAAF,MAETkS,aAAe,WACblS,EAAKgD,SAAS,CACZuH,SAAQ,OA4EZzH,eAAiB,WACf9C,EAAKgD,SAAS,CACZF,gBAAiB9C,EAAKb,MAAM2D,uGAzE9B1D,KAAK4D,SAAS,CACZiP,WAAY7S,KAAKD,MAAM8S,0CAIrB5Q,EAAO6L,GAAS,IAAAjL,EAAA7C,KACpBA,KAAK4D,SAAS,CAACuH,SAAS,IACxBtJ,IAASK,OAAO6Q,2BAA2B9Q,EAAO6L,GAAUgB,MAAM,SAAA5C,GAC7C,uBAAfA,EAAM8G,KACRnP,OAAO4K,MAAM,wCACW,wBAAfvC,EAAM8G,KACfnP,OAAO4K,MAAM,yCACW,wBAAfvC,EAAM8G,MACfnP,OAAO4K,MAAM,4BAEd9L,KAAK,WACNd,IAASK,OAAO8B,mBAAmB,SAAAzC,GAC7BA,GACF6C,GAAS,EACTvB,EAAKe,SAAS,CACZuH,SAAQ,KAGVtI,EAAKe,SAAS,CAACuH,SAAQ,yCAMvB,IAAA9G,EAAArE,KACN6B,IAASK,OAAO+Q,UAAUtQ,KAAK,WAC7ByB,GAAS,EACTP,OAAOC,SAASC,QAAQ,KACxBM,EAAKT,SAAS,uCAITkG,GACP9I,QAAQC,IAAI6I,GADK,IAGV1D,EAAiC0D,EAAjC1D,KAAMgG,EAA2BtC,EAA3BsC,OAAQnK,EAAmB6H,EAAnB7H,MAAO6L,EAAYhE,EAAZgE,SAGtBoF,EAAU,CACdxT,GAAO0M,EACPvM,UAAcuG,EACdnE,MAAUA,EACVmJ,UAAa,GACZ2B,UAAc,IAGIlL,IAASK,OAAOiR,+BAA+BlR,EAAO6L,GAAUgB,MAAM,SAAS5C,GAElGlL,QAAQC,IAAIiL,EAAM8G,MAClBhS,QAAQC,IAAIiL,EAAM7F,WAEjB1D,KAAK,SAAAxD,GACFA,GACFyC,EAAQI,MAAMoK,GAAQxB,OAAOsI,GAE/BlS,QAAQC,IAAI,cAEZY,IAASK,OAAO6Q,2BAA2B9Q,EAAO6L,GAAUgB,MAAM,SAAA5C,GAChElL,QAAQC,IAAIiL,KACXvJ,KAAK,SAAAxD,GACN0E,OAAOC,SAASsP,oDAYP,IAAAC,EAAArT,KACb,OACEX,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAe8T,SAAUC,kBAEflU,EAAAC,EAAAC,cAACiU,EAAA,EAAD,CAAOC,OAAK,EAACC,KAAM,aAAcC,OAAQ,WACvC,IAAMjU,EAAKmE,OAAOC,SAASiI,SAAShI,QAAQ,UAAW,IACrD,OACE1E,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KACEnC,EAAAC,EAAAC,cAACqU,EAAD,CAAQ5O,OAAQqO,EAAKrO,OAAQtB,eAAgB2P,EAAK3P,iBAEjD2P,EAAKtT,MAAM2D,eAAiBrE,EAAAC,EAAAC,cAACsU,EAAD,CAAcnQ,eAAgB2P,EAAK3P,iBAAoB,KAEpFrE,EAAAC,EAAAC,cAACuU,EAAD,CAAetT,IAAKd,QAK5BL,EAAAC,EAAAC,cAACiU,EAAA,EAAD,CAAOC,OAAK,EAACC,KAAM,OAAQC,OAAQ,WAC/B,IAAMjU,EAAKmE,OAAOC,SAASiI,SAAShI,QAAQ,IAAK,IACjD,OACE1E,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KACEnC,EAAAC,EAAAC,cAACqU,EAAD,CAAQ5O,OAAQqO,EAAKrO,OAAQxE,IAAKd,EAAIgE,eAAgB2P,EAAK3P,iBAE1D2P,EAAKtT,MAAM2D,eAAiBrE,EAAAC,EAAAC,cAACsU,EAAD,CAAcnQ,eAAgB2P,EAAK3P,iBAAoB,KAEpFrE,EAAAC,EAAAC,cAACwU,EAAD,CAAUvT,IAAKd,EAAIA,GAAIA,QAK/BL,EAAAC,EAAAC,cAACiU,EAAA,EAAD,CAAOC,OAAK,EAACC,KAAM,IAAKC,OAAQ,WAC5B,OACEtU,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KACEnC,EAAAC,EAAAC,cAACqU,EAAD,CAAQ5O,OAAQqO,EAAKrO,OAAQtB,eAAgB2P,EAAK3P,iBAEjD2P,EAAKtT,MAAM2D,eAAiBrE,EAAAC,EAAAC,cAACsU,EAAD,CAAcnQ,eAAgB2P,EAAK3P,iBAAoB,KAEpFrE,EAAAC,EAAAC,cAACuU,EAAD,oDAQN,IAAAE,EAAAhU,KACd,OACIX,EAAAC,EAAAC,cAACC,EAAA,EAAD,CAAe8T,SAAUC,kBACrBlU,EAAAC,EAAAC,cAACiU,EAAA,EAAD,CAAOC,OAAK,EAACC,KAAM,OAAQC,OAAQ,WAC3B,IAAMjU,EAAKmE,OAAOC,SAASiI,SAAShI,QAAQ,IAAK,IACjD,OACE1E,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,CAAgBhB,IAAKd,GACnBL,EAAAC,EAAAC,cAACqU,EAAD,CAAQ5O,OAAQgP,EAAKhP,SAGrB3F,EAAAC,EAAAC,cAACwU,EAAD,CAAUvT,IAAKd,QAK3BL,EAAAC,EAAAC,cAACiU,EAAA,EAAD,CAAOC,OAAK,EAACC,KAAM,IAAKC,OAAQ,WAC5B,OACEtU,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KACCwS,EAAKjU,MAAM8S,UAAYxT,EAAAC,EAAAC,cAAC0U,EAAD,CAAe/F,oBAAqB8F,EAAK9F,oBAAqBE,SAAU4F,EAAK5F,WAAe,KACnH4F,EAAKjU,MAAMoL,QAAU9L,EAAAC,EAAAC,cAAC2U,EAAD,MAAa,KACnC7U,EAAAC,EAAAC,cAAC4U,EAAD,CACAzG,MAAOsG,EAAKtG,MACZQ,oBAAqB8F,EAAK9F,4DASlC,IAAAkG,EAAApU,KAGC0S,GACH7Q,IAASK,OAAO8B,mBAAmB,SAASzC,GACtCA,GACFmR,GAAa,EACbtO,GAAO,EACP+G,GAAU,IAGVA,GAAU,EACVuH,GAAa,KAKF1D,YAAa,SAAAnK,IACN,IAAhB8N,GAAyBD,IAC3BC,GAAc,EACdyB,EAAKxQ,SAAS,CACZuH,SAAS,MAGZ,KAMH,OAAI/G,EAEA/E,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KACGxB,KAAKqU,gBAKRhV,EAAAC,EAAAC,cAACF,EAAAC,EAAMkC,SAAP,KACGxB,KAAKsU,yBAjNahR,IAAM7C,WC/BnBY,QACW,cAA7BwC,OAAOC,SAASyQ,UAEe,UAA7B1Q,OAAOC,SAASyQ,UAEhB1Q,OAAOC,SAASyQ,SAAS3L,MACvB,2DCZN4L,IAASb,OAAOtU,EAAAC,EAAAC,cAACkV,EAAD,MAASC,SAASC,eAAe,SD2H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMnS,KAAK,SAAAoS,GACjCA,EAAaC","file":"static/js/main.10105466.chunk.js","sourcesContent":["import React from 'react';\r\nimport {Link} from \"react-router-dom\";\r\n\r\nconst SearchResult = (props) => {\r\n    let image;\r\n\r\n    if (!props.result.profilepic) {\r\n        image = \"https://cdn.britannica.com/67/197567-131-1645A26E.jpg\"\r\n    } else {\r\n        image = props.result.profilepic\r\n    }\r\n    return ( \r\n        <Link to={props.result.id}>\r\n        <div className=\"search-result-container\">\r\n            <img id=\"search-picture\" src={image} />\r\n            <span className=\"search-result-name\">{props.result.firstName}</span>\r\n            <span className=\"search-result-id\">@{props.result.id}</span>\r\n        </div>\r\n        </Link>\r\n     );\r\n}\r\n \r\nexport default SearchResult;","import React, { Component } from 'react';\r\nimport SearchResult from './SearchResult';\r\n\r\nclass SearchContainer extends Component {\r\n    state = {  }\r\n    render() { \r\n        if (this.props.search.length < 1) return null;\r\n        if (this.props.searchState === \"\") return null;\r\n        const results = this.props.search;\r\n        return ( \r\n            <div className=\"search-container-container\">\r\n\r\n                {results.map((result, i) => {\r\n                    return <SearchResult key={i} result={result}/>\r\n                })}                \r\n\r\n                <div className=\"search-result-container\">\r\n                    <h5 className=\"search-result-name\">Search for more...</h5>\r\n                </div>\r\n            </div>\r\n         );\r\n    }\r\n}\r\n \r\nexport default SearchContainer;","import React, { Component } from 'react';\r\nimport {Link} from \"react-router-dom\";\r\n\r\nclass Notification extends Component {\r\n\r\n    state = {\r\n\r\n    }\r\n\r\n    seenNotification = this.seenNotification.bind(this)\r\n\r\n    seenNotification () {\r\n        console.log(\"seenotification\")\r\n        this.props.seenNotification(this.props.notification);\r\n    }\r\n\r\n    render(){ \r\n   \r\n    const notification = this.props.notification;\r\n\r\n    const isTweet = Boolean(notification[4])\r\n    let text= \"\";\r\n    const user = notification[0];\r\n\r\n    if (notification[3] === \"follow\"){\r\n        text = \"is following you.\"\r\n    } else if (notification[3] === \"like\") {\r\n        text = \"liked you tweet.\"\r\n    } else if (notification[3] === \"retweet\"){\r\n        text = \"has retweeted your tweet.\"\r\n    } else if (notification[3] === \"mention\") {\r\n        text = \"has mentioned you in a tweet.\"\r\n    }\r\n\r\n    let seen;\r\n\r\n    if (!notification[2]) seen = \"unseen\"; else seen=\"seen\";\r\n\r\n   \r\n\r\n    return ( \r\n<React.Fragment>\r\n        { isTweet ?\r\n\r\n        \r\n        <div className={`notification-container ${seen}`} onClick={this.seenNotification}>\r\n                    <p className=\"notification-text\">\r\n                        <Link to={user}>\r\n                        <span className=\"notification-user\">@{user} </span>\r\n                        </Link>     \r\n                        <Link to={`/tweet/${notification[4]}`}>\r\n                        {text}\r\n                        </Link>\r\n                    </p>\r\n                </div>\r\n        \r\n\r\n        :\r\n\r\n        <div className={`notification-container ${seen}`} onClick={this.seenNotification}>\r\n            <p className=\"notification-text\">\r\n                <Link to={user}>\r\n                <span className=\"notification-user\">@{user} </span>\r\n                </Link>                \r\n                {text}\r\n            </p>\r\n        </div>\r\n    }\r\n    </React.Fragment>\r\n     );}\r\n}\r\n \r\nexport default Notification;","import React, { Component } from 'react';\r\nimport Notification from \"./Notification\"\r\nimport firebase from \"firebase\";\r\n\r\nclass NotificationsContainer extends Component {\r\n    state = {  }\r\n\r\n    seenNotification = (notification) =>{\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const email = firebase.auth().currentUser.email;\r\n        let oldNotifications = [];\r\n        let loggedUserId = \"\";\r\n\r\n        // notification[2] = 1;\r\n\r\n        usersDB.once(\"value\", data =>{\r\n            const users = data.val();\r\n            const keys = Object.keys(users);\r\n\r\n            \r\n\r\n            for (let i = 0; i < keys.length; i++) {\r\n                if (email == users[keys[i]][\"email\"]){\r\n                    oldNotifications = users[keys[i]][\"notifications\"];\r\n                    loggedUserId = users[keys[i]][\"id\"];\r\n                    break;\r\n                }\r\n            }\r\n\r\n            for (let i = 0; i < oldNotifications.length; i++){\r\n                if (\r\n                        notification[0] === oldNotifications[i][0] &&\r\n                        notification[1] === oldNotifications[i][1] &&\r\n                        notification[2] === oldNotifications[i][2] &&\r\n                        notification[3] === oldNotifications[i][3]\r\n                ) {\r\n                    oldNotifications[i][2] = 1;\r\n                    break\r\n                }\r\n            }\r\n\r\n            \r\n        }).then(() =>{\r\n            usersDB.child(loggedUserId).child(\"notifications\").set(oldNotifications);\r\n        })\r\n    }\r\n    \r\n    render() { \r\n\r\n\r\n\r\n        if (!this.props.notifications) {\r\n            return (\r\n                <div className=\"notifications-container\">\r\n                    <p>There are not notifications to show.</p>\r\n                 </div>\r\n            )\r\n        } else if (this.props.notifications.length === 0) {\r\n            return (<div className=\"notifications-container\">\r\n                    <p>There are not notifications to show.</p>\r\n                 </div>)\r\n        }\r\n\r\n        return ( \r\n            <div className=\"notifications-container\">\r\n                {this.props.notifications.map((notification,i) => {\r\n                   return <Notification notification={notification} seenNotification={this.seenNotification} key={i}/>\r\n                })}\r\n            </div>\r\n         );\r\n    }\r\n}\r\n \r\nexport default NotificationsContainer;","import React, { Component } from 'react';\r\nimport firebase from  \"firebase\";\r\nimport SearchContainer from './SearchContainer';\r\nimport {Link} from \"react-router-dom\";\r\nimport NotificationsContainer from './Notifications/NotificationsContainer';\r\n\r\n;\r\nlet usersArray = [];\r\nlet logged = false;\r\nlet firstCheck = false;\r\n\r\nclass Header extends Component {\r\n    state = { \r\n        search: \"\",\r\n        searchResult : [],\r\n        profilepic: \"https://cdn.britannica.com/67/197567-131-1645A26E.jpg\",\r\n        notifications: [],\r\n        unseenNotifications: 0,\r\n        showNotifications: false,\r\n     }\r\n    refSearch = React.createRef();\r\n\r\n    Logout = this.Logout.bind(this)\r\n    search = this.search.bind(this)\r\n    LogIn = this.LogIn.bind(this)    \r\n\r\n    LogIn() {\r\n        window.location.replace(\"/\")        \r\n    }\r\n\r\n    componentDidMount(){\r\n\r\n        \r\n        \r\n\r\n        \r\n\r\n        \r\n        firebase.auth().onAuthStateChanged((user) => {        \r\n            if (user) { \r\n              const email = firebase.auth().currentUser.email;\r\n              const usersDB = firebase.database().ref().child(\"users\");\r\n                let loggedUserId = false;\r\n              let profilepic = \"\";\r\n\r\n              usersDB.once(\"value\", data =>{\r\n                  const users = data.val();\r\n                  const keys = Object.keys(users);\r\n\r\n                  for (let i = 0; i < keys.length; i++) {\r\n                      if (users[keys[i]][\"email\"] === email) {\r\n                            loggedUserId = users[keys[i]][\"id\"];\r\n                            \r\n                          if (!!users[keys[i]][\"profilepic\"]) {\r\n                               profilepic= users[keys[i]][\"profilepic\"];                               \r\n                               break;                                \r\n                          }\r\n                      }\r\n                  }                    \r\n              }).then(() => {\r\n\r\n\r\n                ////////NOTIFICATIONS\r\n\r\n                if (loggedUserId){\r\n                    usersDB.child(loggedUserId).child(\"notifications\").on(\"value\", snapshot =>{\r\n                        \r\n                        const newNotifications = snapshot.val()\r\n                        let unseenNotifications = 0;\r\n\r\n\r\n                        if (!!newNotifications){\r\n                         for (let i = 0; i < newNotifications.length; i++){\r\n                            if (newNotifications[i][2] === 0){\r\n                                unseenNotifications++;\r\n                            }\r\n                         }\r\n                        } else {\r\n                            return null;\r\n                        }\r\n\r\n                        console.log(newNotifications)\r\n                        \r\n                        this.setState({ \r\n                            \r\n                            unseenNotifications,\r\n                            notifications: snapshot.val()\r\n                        })\r\n                    })\r\n                }\r\n\r\n                //////////////////\r\n\r\n                  if (profilepic.length > 0){\r\n                      this.setState({\r\n                          profilepic,\r\n                          logged: true\r\n                      })\r\n                  } else {\r\n                      this.setState({\r\n                          logged:true\r\n                        })\r\n                  }\r\n              })\r\n              \r\n            }\r\n          });\r\n    }\r\n\r\n    search() {     \r\n        let searchResult=[];\r\n        usersArray= []; \r\n        const usersDB = firebase.database().ref().child(\"users\")\r\n        const regex = new RegExp(this.refSearch.current.value, \"i\");\r\n\r\n        if (this.refSearch.current.value === \"\") {\r\n            this.setState({\r\n                search: \"\"\r\n            })\r\n            return null;\r\n        };\r\n\r\n        usersDB.once(\"value\", data =>{\r\n            const users = data.val();\r\n            const keys = Object.keys(users)            \r\n            let count = 0;\r\n\r\n            for (let i = 0; i < keys.length; i++)   {\r\n                if (count > 5) return null;\r\n                \r\n                if (regex.test(users[keys[i]][\"id\"]) || regex.test(users[keys[i]][\"firstName\"])) {\r\n                    usersArray.push(users[keys[i]]);\r\n                    count++;\r\n                }\r\n            }\r\n            \r\n        }).then(x => {           \r\n            searchResult = [... new Set (usersArray)];\r\n            this.setState({\r\n                searchResult, \r\n                search: this.refSearch.current.value\r\n            })\r\n        })\r\n    }\r\n\r\n    Logout(){\r\n        this.props.logOut();\r\n    }\r\n\r\n    toggleSettings = () => {\r\n        this.props.toggleSettings();\r\n    }\r\n\r\n    toggleNotifications = () => {\r\n        this.setState({\r\n            showNotifications: !this.state.showNotifications\r\n        })\r\n    }\r\n\r\n    render() { \r\n\r\n        \r\n        if (this.state.searchResult.length > 0) this.state.searchResult = getUnique(this.state.searchResult, \"id\");\r\n        var next = false;\r\n\r\n        function getUnique(arr,comp){\r\n\r\n            //store the comparison  values in array\r\n            const unique =  arr.map(e=> e[comp]). \r\n                    // store the keys of the unique objects\r\n                    map((e,i,final) =>final.indexOf(e) === i && i) \r\n                    // eliminate the dead keys & return unique objects\r\n                    .filter((e)=> arr[e]).map(e=>arr[e]);\r\n\r\n            return unique\r\n        }\r\n\r\n        ///////////////////////////////////////////////////////////////\r\n\r\n        let notificationsToShow;\r\n\r\n        if (!!this.state.notifications) {\r\n            const orderedNotifications = this.state.notifications.sort((a,b) => {\r\n                var timeA = new Date(a[1]).getTime()\r\n                var timeB = new Date(b[1]).getTime()\r\n                  return timeB - timeA;\r\n           })\r\n\r\n           notificationsToShow = orderedNotifications.slice(0,9)\r\n        }\r\n\r\n        \r\n////////////////////////////////////////////////////////////////////////\r\n       \r\n        if (this.state.logged) {\r\n            return ( \r\n                <div className=\"header-container\">\r\n                    <div className=\"header-left\">\r\n                    <Link to=\"/\">\r\n                        <h3 className=\"header-button\">Home</h3>\r\n                    </Link>\r\n                    <h3 className=\"header-button\" onClick={this.toggleNotifications}>Notifications</h3>\r\n                    {this.state.unseenNotifications > 0 ? <span className=\"header-notification-number\">{this.state.unseenNotifications}</span> : null}\r\n                    {this.state.showNotifications ? <NotificationsContainer notifications={notificationsToShow}/> : null}\r\n                    <h3 className=\"header-button disabled-button\" >Messages</h3>\r\n                    </div>\r\n                    <div className=\"header-mid\">\r\n                    <h3 id=\"header-logo\">Logo</h3>    \r\n                    </div>\r\n                    <div className=\"header-right\">\r\n                    <input onChange={this.search} ref={this.refSearch} type=\"text\" id=\"header-search\" placeholder=\"Search...\"/>\r\n                    <SearchContainer search={this.state.searchResult} searchState={this.state.search}/>\r\n                    <img id=\"header-profile-picture\" onClick={this.toggleSettings} src={this.state.profilepic}/>\r\n                    <button id=\"header-logout\" onClick={this.Logout}>Log Out</button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else {\r\n            return (\r\n                <div className=\"header-container\">\r\n                    <div className=\"header-left\">\r\n                        <h3 className=\"header-button header-logout\">Home</h3>\r\n                        <h3 className=\"header-button header-logout\">Notifications</h3>\r\n                        <h3 className=\"header-button header-logout\">Messages</h3>\r\n                    </div>\r\n                    <div className=\"header-mid\">\r\n                        <h3 id=\"header-logo\">Logo</h3>    \r\n                    </div>\r\n                    <div className=\"header-right\">\r\n                        <input onChange={this.search} ref={this.refSearch} type=\"text\" id=\"header-search\" placeholder=\"Search...\"/>\r\n                        <SearchContainer search={this.state.searchResult} searchState={this.state.search} />\r\n                        <img id=\"header-profile-picture\" src=\"https://d1nhio0ox7pgb.cloudfront.net/_img/o_collection_png/green_dark_grey/512x512/plain/user.png\"/>\r\n                        <button id=\"header-logout\" onClick={this.LogIn}>Log In</button>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n    }\r\n}\r\n \r\nexport default Header;","/* PARTE SUPERIOR: LLEVA, ID, HORA\r\n    PARTE MEDIA: MENSAJE\r\n    PARTE BAJA: LIKES, RESPUESTAS Y RETWEETS\r\n */\r\n\r\nimport React, { Component } from 'react';\r\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\r\nimport {faComment as faReply, faRetweet, faHeart, faTrash} from \"@fortawesome/free-solid-svg-icons\";\r\nimport {Link} from \"react-router-dom\"\r\nimport firebase from \"firebase\";\r\nimport { thisExpression } from '@babel/types';\r\nimport Swal from \"sweetalert2\";\r\n\r\n class Tweet extends React.Component {\r\n\r\n    state = {\r\n        name: \"\",\r\n        user: \"\",\r\n        profilepic: false,\r\n        message: \"\",\r\n        likes: [],\r\n        likesNumber: \"\",\r\n        retweets: \"\",\r\n        retweetedBy :\"\",\r\n        retweetedByNumber: \"\",\r\n        date: \"\",\r\n        showTime: \"\",\r\n        tweetId: \"\",\r\n        likedByLogged: false,\r\n        showRetweetedBy: false,\r\n        matchingRetweeted: \"\",\r\n        loggedUser: \"0\",\r\n        deleted: false\r\n    }\r\n\r\n    \r\n    componentDidMount(){\r\n        const {name, user, message, likes, retweets, retweetedBy, date, tweetId, likesNumber, retweetedByNumber, showRetweetedBy, matchingRetweeted } = this.props.tweet;\r\n        let profilepic = false;\r\n        var newMessage = [];     \r\n        \r\n\r\n        \r\n        //MENTIONED USERS IN THE MESSAGE\r\n        const mentionRegex = /@\\w+/g;\r\n        var mentionedUsers = message.match(mentionRegex);\r\n     /*    for (let i = 0; i < mentionedUsers.length; i++){\r\n            mentionedUsers[i] = mentionedUsers[i].replace(\"@\", \"\");\r\n            mentionedUsers[i] = [mentionedUsers[i], 0];\r\n        } */\r\n        // the number inside of mentioned users array determines if the users exists.\r\n\r\n        const approvedUsers = {};\r\n\r\n        //////////////////////////\r\n        \r\n        const tweetLikesDB = firebase.database().ref().child(\"tweets\").child(tweetId).child(\"likes\");\r\n        let email;\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n\r\n        //CHECK IF LOGGED\r\n        if (!!firebase.auth().currentUser){\r\n            email = firebase.auth().currentUser.email\r\n        }\r\n\r\n        let loggedUser = \"\";\r\n\r\n        const tweetDate = new Date(date);\r\n        const thisMoment = new Date()\r\n        let timeAgo = (thisMoment-tweetDate)/1000;\r\n        let showTime = \"\";\r\n        \r\n        let likedByLogged = false;\r\n\r\n        \r\n        // TIME AGO TO SHOW\r\n        if        (timeAgo < 61) {\r\n            showTime = `${Math.floor(timeAgo)} seconds ago`\r\n        } else if (timeAgo < 3600) {\r\n            timeAgo = Math.floor(timeAgo / 60);\r\n            showTime = `${timeAgo} minutes ago`\r\n            if (timeAgo === 1) showTime = `${timeAgo} minute ago`\r\n        } else if (timeAgo < 86400) {\r\n            timeAgo = Math.floor(timeAgo / 3600);\r\n            showTime = `${timeAgo} hours ago`\r\n            if (timeAgo === 1) showTime = `${timeAgo} hour ago`\r\n        } else if (timeAgo < 604800) {\r\n            timeAgo = Math.floor(timeAgo / 86400);\r\n            showTime = `${timeAgo} days ago`\r\n            if (timeAgo === 1) showTime = `${timeAgo} day ago`\r\n        } else if (timeAgo < 2419200) {\r\n            timeAgo = Math.floor(timeAgo / 604800);\r\n            showTime = `${timeAgo} weeks ago`\r\n            if (timeAgo === 1) showTime = `${timeAgo} week ago`\r\n        } else if (timeAgo < 29030400) {\r\n            timeAgo = Math.floor(timeAgo / 2419200);\r\n            showTime = `${timeAgo} months ago`\r\n            if (timeAgo === 1) showTime = `${timeAgo} month ago`\r\n        } else {\r\n            timeAgo = Math.floor(timeAgo / 29030400);\r\n            showTime = `${timeAgo} years ago`\r\n            if (timeAgo === 1) showTime = `${timeAgo} year ago`\r\n        }\r\n\r\n        usersDB.once(\"value\", data =>{\r\n            const users = data.val();\r\n            const keys = Object.keys(users);\r\n            let count= 0;\r\n\r\n            //  GET LOGGED USER ID IN ORDER TO CHECK LIKED\r\n            for (let i = 0; i < keys.length; i++){\r\n                // if (count === 2) break;\r\n                if (email === users[keys[i]][\"email\"]) {\r\n                    loggedUser = users[keys[i]][\"id\"];\r\n                    count++;\r\n                }\r\n\r\n            //GET TWEETER USER TO GET PROFILEPIC\r\n                if (user === users[keys[i]][\"id\"]) {\r\n                    if (!!users[keys[i]][\"profilepic\"]) {\r\n                        profilepic = users[keys[i]][\"profilepic\"];\r\n                        count++;\r\n                    } else {\r\n                        profilepic = \"https://cdn.britannica.com/67/197567-131-1645A26E.jpg\"\r\n                        count++;\r\n                    }\r\n                }\r\n\r\n            //CREATE PROPERTY IF USER IS FOUND - SO IT CAN BE CHECKED IF USER EXISTS.\r\n                if (!!mentionedUsers) {\r\n                    for (let j = 0; j < mentionedUsers.length; j++) {\r\n                        if (mentionedUsers[j].replace(\"@\",\"\") == users[keys[i]][\"id\"]){\r\n                            approvedUsers[mentionedUsers[j].replace(\"@\",\"\")] = 1\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // PENDANT: SPLIT THEN <FRAGMENT> THE STRING WITH HTML TO SHOW IN REACT\r\n            var splittedMessage = message.split(\" \");\r\n            \r\n                  \r\n            for (let i = 0; i < splittedMessage.length; i++) {\r\n                if (splittedMessage[i][0] == \"@\" && approvedUsers.hasOwnProperty(splittedMessage[i].replace(\"@\",\"\"))) {\r\n                        newMessage.push(<React.Fragment><Link to={splittedMessage[i].replace(\"@\", \"\")} ><span className=\"mention-user\">{splittedMessage[i]}</span></Link></React.Fragment>)\r\n                        newMessage.push(\" \")\r\n                } else {\r\n                    newMessage.push(splittedMessage[i])\r\n                    newMessage.push(\" \")\r\n                }                \r\n            }\r\n\r\n\r\n\r\n\r\n\r\n\r\n        }).then(x => {\r\n            tweetLikesDB.once(\"value\", data=>{\r\n                const likes = data.val();\r\n    \r\n                if (!likes) {\r\n                    return null\r\n                } else {\r\n                    for (let i = 0; i < likes.length; i++){\r\n                        if (likes[i] === loggedUser) {\r\n                            likedByLogged = true;\r\n                        }\r\n                    }\r\n                }\r\n            }).then(x => {\r\n                this.setState({\r\n                    name, \r\n                    user, \r\n                    message : newMessage, \r\n                    likes, \r\n                    retweets, \r\n                    retweetedBy, \r\n                    date, \r\n                    showTime, \r\n                    tweetId, \r\n                    likedByLogged, \r\n                    likesNumber, \r\n                    retweetedByNumber, \r\n                    showRetweetedBy, \r\n                    matchingRetweeted, \r\n                    profilepic, \r\n                    loggedUser,\r\n                    updated: true\r\n                })\r\n            })\r\n        })\r\n\r\n        \r\n    }\r\n\r\n    like = () => {\r\n        let email;\r\n\r\n        if (!!firebase.auth().currentUser){\r\n            email = firebase.auth().currentUser.email\r\n        } else {\r\n            return null;\r\n        }\r\n\r\n\r\n        const tweetLikesDB = firebase.database().ref().child(\"tweets\").child(this.state.tweetId).child(\"likes\");\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n\r\n        let loggedUser = \"\";\r\n        let likes = [];\r\n        let userNotifications = [];\r\n        let newNotification = [];\r\n\r\n        if (!Boolean(email))  return null;\r\n\r\n        usersDB.once(\"value\", data =>{\r\n            const users = data.val();\r\n            const keys = Object.keys(users);\r\n\r\n            \r\n\r\n            for (let i = 0; i < keys.length; i++){\r\n                if (email === users[keys[i]][\"email\"]) {\r\n                    loggedUser = users[keys[i]][\"id\"];\r\n                    newNotification[0] = users[keys[i]][\"id\"];\r\n                }\r\n\r\n                if (this.state.user === users[keys[i]][\"id\"]) {\r\n                    userNotifications = users[keys[i]][\"notifications\"]\r\n                }\r\n            }\r\n\r\n            newNotification[1] = new Date().toISOString();\r\n            newNotification[2] = 0;\r\n            newNotification[3] = \"like\";\r\n            newNotification[4] = this.state.tweetId;\r\n\r\n            // newNotification = [user, date, 0, like, twID]\r\n\r\n            if (!userNotifications) {\r\n                userNotifications = [newNotification]\r\n            } else {\r\n                userNotifications.push(newNotification)\r\n            }\r\n           \r\n        }).then(() => {\r\n            tweetLikesDB.once(\"value\", data => {\r\n                likes = data.val()\r\n                if (!likes) {\r\n                    likes = [loggedUser];\r\n                } else {\r\n                    likes.push(loggedUser);\r\n                }\r\n            }).then(x =>{\r\n                tweetLikesDB.set(likes);\r\n\r\n                //SEND NOTIFICATION ONLY IF USER IS DIFFERENT.\r\n                // OBJECTIVE: NOT SELF NOTIFICATIONS.\r\n                if (newNotification[0] !== this.state.user){\r\n                    usersDB.child(this.state.user).child(\"notifications\").set(userNotifications);\r\n                }\r\n\r\n                this.setState({\r\n                    likedByLogged: true,\r\n                    likesNumber: this.state.likesNumber+1})\r\n            })\r\n        })\r\n\r\n        \r\n\r\n\r\n\r\n    }\r\n\r\n    dislike = () => {\r\n        let email;\r\n\r\n        if (!!firebase.auth().currentUser){\r\n            email = firebase.auth().currentUser.email\r\n        } else {\r\n            return null;\r\n        }\r\n\r\n        let userNotifications = [];\r\n        let newNotification = [];\r\n\r\n        const tweetLikesDB = firebase.database().ref().child(\"tweets\").child(this.state.tweetId).child(\"likes\");\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n\r\n        let loggedUser = \"\";\r\n        let likes = [];\r\n\r\n        usersDB.once(\"value\", data =>{\r\n            const users = data.val();\r\n            const keys = Object.keys(users);\r\n\r\n            for (let i = 0; i < keys.length; i++){\r\n                if (email === users[keys[i]][\"email\"]) {\r\n                    loggedUser = users[keys[i]][\"id\"];\r\n                }\r\n\r\n                //GET DISLIKED TWEET USER NOTIFICATIONS\r\n                if (this.state.user === users[keys[i]][\"id\"]){\r\n                    userNotifications = users[keys[i]][\"notifications\"];\r\n                }\r\n            }\r\n\r\n            /////DELETE LIKE NOTIFICATION\r\n            if (!userNotifications){\r\n                userNotifications = [];\r\n            } else if (userNotifications.length === 1) {\r\n                userNotifications = []\r\n            } else {\r\n                userNotifications = userNotifications.filter(notification => {\r\n                    return !(notification[0] === loggedUser && notification[4] === this.state.tweetId)\r\n                })\r\n            }\r\n\r\n            if (loggedUser !== this.state.user) {\r\n            usersDB.child(this.state.user).child(\"notifications\").set(userNotifications)\r\n            }\r\n            //////////////////////////////\r\n\r\n        }).then(() => {\r\n\r\n            tweetLikesDB.once(\"value\", data => {\r\n                likes = data.val()\r\n                if (likes.length === 1) {\r\n                    likes = [];\r\n                } else {\r\n                    likes = likes.filter(userid => {\r\n                        return userid !== loggedUser\r\n                    });\r\n                }\r\n            }).then(x =>{\r\n                tweetLikesDB.set(likes)\r\n                this.setState({\r\n                    likedByLogged: false,\r\n                    likesNumber: this.state.likesNumber-1\r\n                })\r\n            })\r\n\r\n        })\r\n\r\n        \r\n\r\n\r\n    }\r\n\r\n    retweet =() => {\r\n        \r\n        let email;\r\n\r\n        if (!!firebase.auth().currentUser){\r\n            email = firebase.auth().currentUser.email\r\n        } else {\r\n            return null;\r\n        }\r\n        \r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const tweetRetweetedDB = firebase.database().ref().child(\"tweets\").child(this.state.tweetId).child(\"retweetedBy\");\r\n        \r\n        let loggedUser = \"\";\r\n\r\n        let userNotifications = [];\r\n        let newNotification = [];\r\n\r\n\r\n        Swal.fire({\r\n            title: 'Wanna retweet this?',\r\n            type: 'info',\r\n            showCancelButton: true,\r\n            confirmButtonColor: '#1da1f2',\r\n            cancelButtonColor: '#d33',\r\n            confirmButtonText: 'Yes, Retweet'\r\n          }).then((result) => {\r\n            if (result.value) {\r\n\r\n                usersDB.once(\"value\", data =>{\r\n                    const users = data.val();\r\n                    const keys = Object.keys(users);\r\n                    let count = 0;\r\n        \r\n                    for (let i = 0; i < keys.length; i++){\r\n                        if (count === 2) break;\r\n                        if (users[keys[i]][\"email\"] === email) {\r\n                            loggedUser = users[keys[i]][\"id\"];\r\n                            newNotification[0] = users[keys[i]][\"id\"];\r\n                            count++\r\n                        }\r\n\r\n                        if (users[keys[i]][\"id\"] === this.state.user) {\r\n                            userNotifications = users[keys[i]][\"notifications\"];\r\n                            count++\r\n                        }\r\n                    }\r\n\r\n                    newNotification[1] = new Date().toISOString();\r\n                    newNotification[2] = 0;\r\n                    newNotification[3] = \"retweet\";\r\n                    newNotification[4] = this.state.tweetId;\r\n\r\n                    // newNotification = [user, date, 0, like, twID]\r\n\r\n                    if (!userNotifications) {\r\n                        userNotifications = [newNotification]\r\n                    } else {\r\n                        userNotifications.push(newNotification)\r\n                    }\r\n\r\n        \r\n                    \r\n                }).then(x =>{\r\n                    tweetRetweetedDB.once(\"value\", data =>{\r\n                        let retweetedBy = data.val()\r\n                        const retweetDate = new Date().toISOString();\r\n                        const newRetweet = [loggedUser, retweetDate];\r\n                     \r\n                        if (!retweetedBy) {\r\n                            retweetedBy = [newRetweet];\r\n                        } else {\r\n                            retweetedBy.push(newRetweet);\r\n                        }\r\n        \r\n                        tweetRetweetedDB.set(retweetedBy);\r\n                        usersDB.child(this.state.user).child(\"notifications\").set(userNotifications);\r\n        \r\n                    }).then(x=>{\r\n                        Swal.fire(\r\n                            'Retweeted!',\r\n                            \"\",\r\n                            'success'\r\n                          )\r\n                          this.setState({\r\n                              retweetedByNumber: this.state.retweetedByNumber+1\r\n                          })\r\n                    })\r\n        \r\n        \r\n                })\r\n\r\n\r\n              \r\n            }\r\n          })\r\n\r\n        \r\n\r\n    }\r\n\r\n    deleteTweet = () =>{\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const tweetsDB = firebase.database().ref().child(\"tweets\");\r\n        let sameUser = false;\r\n\r\n        Swal.fire({\r\n            title: 'Are you sure?',\r\n            text: \"You won't be able to revert this\",\r\n            type: 'warning',\r\n            showCancelButton: true,\r\n            confirmButtonColor: '#3085d6',\r\n            cancelButtonColor: '#d33',\r\n            confirmButtonText: 'Yes, delete it!'\r\n          }).then((result) => {\r\n            if (result.value) {\r\n                usersDB.once(\"value\", data => {\r\n                    const users = data.val();\r\n                    const keys = Object.keys(users);\r\n        \r\n                    for (let i = 0; i < keys.length; i++){\r\n                        if (this.state.loggedUser === users[keys[i]][\"id\"]) {\r\n                            sameUser = true;\r\n                            break;\r\n                        }\r\n                    }\r\n        \r\n                    if (sameUser == false) return null;\r\n        \r\n                    //THIS DELETES TWEET.\r\n                    tweetsDB.child(this.state.tweetId).set(null);\r\n        \r\n                }).then( () => {\r\n                    this.setState({\r\n                        deleted:true\r\n                    })\r\n                    Swal.fire(\r\n                        'Deleted!',\r\n                        'Your tweet has been deleted.',\r\n                        'success'\r\n                      )\r\n                })\r\n            }\r\n          })\r\n\r\n        \r\n\r\n        \r\n    }\r\n\r\n     render(){   \r\n\r\n        if (this.state.deleted) return null;\r\n\r\n        let image;\r\n\r\n        if (!this.state.profilepic) {\r\n            image = \"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812\";\r\n        } else {\r\n            image = this.state.profilepic;\r\n        }\r\n\r\n        return ( \r\n            <React.Fragment>\r\n                \r\n                <div className=\"Contenedor\">\r\n\r\n                { this.state.showRetweetedBy ?\r\n                <div className=\"retweetedBy\">\r\n                    <FontAwesomeIcon icon={faRetweet}/> <span>Retweet by {this.state.matchingRetweeted[this.state.matchingRetweeted.length-1][0]}</span>\r\n                </div> : null}\r\n\r\n                <div className=\"tweet-container\">            \r\n                    <div className=\"tweet-picture\">\r\n                        <img id=\"tweet-picture\" src={image}/>\r\n                    </div>\r\n\r\n                    <div className=\"tweet-inside-container\">\r\n                        <div className=\"tweet-top\">\r\n                            <Link to={`/${this.state.user}`}>\r\n                            <span className=\"tweet-userName\">{this.state.name} </span>\r\n                            </Link>\r\n                            <Link to={`/${this.state.user}`}>\r\n                            <span className=\"tweet-userId\">@{this.state.user}</span>\r\n                            </Link>\r\n                            <span className=\"tweet-date\">{this.state.showTime}</span>\r\n                        </div>\r\n\r\n                        <div className=\"tweet-mid\">\r\n                            <div className=\"tweet-mid-message\">\r\n                                {!!this.state.message.length ? this.state.message.map(word => word) : null}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"tweet-bot\">\r\n                            <div className=\"tweet-bot-icon\">\r\n                                <FontAwesomeIcon id=\"react-icon\" icon={faReply}/>\r\n                            </div>\r\n                            <div className=\"tweet-bot-icon\">\r\n                                <FontAwesomeIcon id=\"react-icon\" onClick={this.retweet}  icon={faRetweet}/>\r\n                                {this.state.retweetedByNumber > 0 ? <span>{this.state.retweetedByNumber}</span> : null}\r\n                            </div>\r\n                            <div className=\"tweet-bot-icon\">    \r\n                                {this.state.likedByLogged ? <FontAwesomeIcon id=\"react-icon\" className=\"liked-heart\" icon={faHeart} onClick={this.dislike} /> : <FontAwesomeIcon id=\"react-icon\" icon={faHeart} onClick={this.like} />}                                \r\n                                {this.state.likesNumber > 0 ? <span>{this.state.likesNumber}</span> : null}\r\n                            </div>\r\n                            <div className=\"tweet-bot-icon\">\r\n                                {this.state.loggedUser == this.state.user ? <FontAwesomeIcon id=\"react-icon\" onClick={this.deleteTweet} icon={faTrash}/> : null}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                </div>\r\n            </React.Fragment>\r\n        );}\r\n }\r\n  \r\n export default Tweet;","import React, {Component} from 'react'\r\nimport firebase from \"firebase\";\r\n\r\nvar userData = {};\r\n\r\nclass WriteTweet extends Component {\r\n    state = { \r\n        tweet : \"\",\r\n        profilepic: false,\r\n        mentions: [],\r\n     }\r\n    refTweetText = React.createRef();\r\n    sendTweet=this.sendTweet.bind(this);\r\n    writeTweet=this.writeTweet.bind(this);\r\n    cleanState = this.cleanState.bind(this);\r\n\r\n    checkMention = () => {\r\n        const mentionRegex = /@\\w+/g;\r\n\r\n        if (!this.state.tweet.match(mentionRegex)) return null;\r\n\r\n        let users = this.state.tweet.match(mentionRegex);\r\n\r\n        for (let i = 0; i < users.length; i++){\r\n            users[i] = users[i].replace(\"@\", \"\");\r\n        }\r\n\r\n        return users;        \r\n        \r\n    }\r\n\r\n    componentDidMount(){\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const email = firebase.auth().currentUser.email;\r\n        let profilepic = false;\r\n\r\n        usersDB.once(\"value\", data =>{\r\n            const users = data.val();\r\n            const keys = Object.keys(users);\r\n\r\n            for (let i = 0; i < keys.length; i++){\r\n                if (email === users[keys[i]][\"email\"]){\r\n                    if (!!users[keys[i]][\"profilepic\"]){\r\n                        profilepic = users[keys[i]][\"profilepic\"];\r\n                    } else {\r\n                        profilepic = \"https://cdn.britannica.com/67/197567-131-1645A26E.jpg\";\r\n                    }\r\n                }\r\n            }\r\n        }).then(() =>{\r\n            this.setState({\r\n                profilepic\r\n            })\r\n        })\r\n    }\r\n    cleanState(tweetData,tweetId){\r\n        this.props.refreshRender(tweetData,tweetId);\r\n        this.setState({\r\n            tweet: \"\"\r\n        })\r\n    }\r\n\r\n    writeTweet(){\r\n        this.setState({\r\n            tweet : this.refTweetText.current.value\r\n        })\r\n    }\r\n\r\n    sendTweet(){\r\n        const tweetMessage= this.state.tweet;\r\n        const mentionedUsers = this.checkMention();\r\n\r\n        let newNotification = [];\r\n        let usersNotifications = {};\r\n        let oldNotifications = [];        \r\n\r\n        if (tweetMessage.length === 0) return null;\r\n\r\n       console.log(mentionedUsers)\r\n        \r\n        const userEmail = firebase.auth().currentUser.email;\r\n        const tweetsDB = firebase.database().ref().child(\"tweets\")\r\n        const usersDB = firebase.database().ref().child(\"users\")\r\n        \r\n            usersDB.once(\"value\", data => {\r\n                const users = data.val();\r\n                const keys = Object.keys(users)\r\n\r\n                for (let i = 0; i < keys.length; i++){\r\n                    if (userEmail === users[keys[i]].email) {\r\n                        userData[\"email\"] = userEmail;\r\n                        userData[\"name\"] = users[keys[i]].firstName;\r\n                        userData[\"userId\"] = users[keys[i]].id;\r\n                    }\r\n\r\n                    if (!!mentionedUsers) {\r\n                        for (let j = 0; j < mentionedUsers.length; j++) {\r\n                            if (mentionedUsers[j] === users[keys[i]][\"id\"]) {\r\n                                usersNotifications[users[keys[i]][\"id\"]] = users[keys[i]][\"notifications\"];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                console.log(usersNotifications)\r\n\r\n            }).then(x => {\r\n                const tweetDate= new Date().toISOString();\r\n                const tweetData = {\r\n                    date : tweetDate,\r\n                    email : userEmail,\r\n                    message : tweetMessage,\r\n                    name : userData[\"name\"],\r\n                    user: userData[\"userId\"]\r\n                }\r\n                const tweetId = tweetsDB.push().key;\r\n                tweetData[\"tweetId\"] = tweetId;\r\n                tweetsDB.child(tweetId).update(tweetData)\r\n\r\n                //NOTIFICATION TO MENTIONED USERS\r\n                if (!!mentionedUsers) {\r\n                    for (let i = 0; i < mentionedUsers.length; i++){\r\n                        newNotification[0] = mentionedUsers[i];\r\n                        newNotification[1] = new Date().toISOString()\r\n                        newNotification[2] = 0;\r\n                        newNotification[3] = \"mention\";\r\n                        newNotification[4] = tweetId;\r\n\r\n                        oldNotifications = usersNotifications[mentionedUsers[i]];\r\n\r\n                        if (!oldNotifications) {\r\n                            oldNotifications = [newNotification];\r\n                        } else {\r\n                            oldNotifications.push(newNotification)\r\n                        };\r\n\r\n                        //HASOWNPROPERTY CHECKS IF USER EXISTS, IF IT DOES. IT SENDS NOTIFICATION\r\n                        //CHECKS IF THE USER WHO WROTE THE TWEET IS MENTIONED, THEN NO NOTIFICATION WILL BE SEND.\r\n\r\n                        console.log(usersNotifications.hasOwnProperty(newNotification[0]))\r\n\r\n                        if (userData[\"userId\"] === newNotification[0] ||\r\n                         !usersNotifications.hasOwnProperty(newNotification[0])) {\r\n\r\n                        } else {\r\n                        usersDB.child(newNotification[0]).child(\"notifications\").set(oldNotifications);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                this.cleanState(tweetData,tweetId)            \r\n            })\r\n        \r\n        \r\n\r\n        \r\n    }\r\n\r\n    \r\n\r\n    render() { \r\n\r\n        let image;\r\n\r\n        if (!this.state.profilepic) {\r\n            image = \"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812\";\r\n        } else {\r\n            image = this.state.profilepic;\r\n        }\r\n\r\n\r\n        return ( \r\n            <div className=\"write-container\">\r\n                <div className=\"write-picture-container\">\r\n                <img id=\"write-profile-picture\" src={image}/>\r\n                </div>\r\n                \r\n                <div className=\"write-input-container\">\r\n                    <textarea ref={this.refTweetText} onChange={this.writeTweet} value={this.state.tweet} maxLength=\"250\" className=\"write-input\" type=\"text\" placeholder=\"What's happening?\" />\r\n                    <div className=\"write-bottom-container\">\r\n                        <button type=\"button\" className=\"write-tweet\" onClick={this.sendTweet}>Tweet</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n         );\r\n    }\r\n}\r\n \r\nexport default WriteTweet;","import React, { Component } from 'react';\r\nimport Tweet from './Tweet';\r\nimport firebase from \"firebase\";\r\nimport WriteTweet from './WriteTweet';\r\nimport { faTintSlash } from '@fortawesome/free-solid-svg-icons';\r\n\r\n\r\nclass TimeLine extends React.Component {\r\n\r\n  constructor(props) {\r\n      super(props);\r\n\r\n      this.state = { \r\n          loading: false,\r\n          following: [],\r\n          userPage: true,\r\n          tweetsToShow: [],\r\n          updated: false,\r\n          pageChanged:false,\r\n          userData: {},\r\n          newTweets: [],\r\n      }\r\n\r\n      this.refreshRender=this.refreshRender.bind(this)\r\n      this.searchTweets=this.searchTweets.bind(this)\r\n      this.matchUsers=this.matchUsers.bind(this)\r\n      this.matchUsersRetweet=this.matchUsersRetweet.bind(this)\r\n      this.reRender = this.reRender.bind(this)\r\n      this.searchOneTweet= this.searchOneTweet.bind(this)\r\n      \r\n    }\r\n    \r\n    \r\n    componentDidMount(){\r\n      const tweetRegex = new RegExp (\"/tweet\");\r\n      const pathname = window.location.pathname;\r\n      if (tweetRegex.test(pathname)){\r\n         this.searchOneTweet();\r\n        } else {\r\n      this.searchTweets()\r\n    }\r\n    }\r\n         \r\n     reRender(tweetsToShow, userPage){         \r\n       this.setState({tweetsToShow, updated:true, pageChanged: false, userPage})\r\n     }\r\n    \r\n\r\n\r\n\r\n     //THIS IS FOR UPDATING 1 TWEET, WHEN WRITTEN AND SENT.\r\n     refreshRender(tweetData, tweetId){\r\n       this.setState({\r\n         newTweets: [tweetData,...this.state.newTweets]\r\n       })\r\n    }\r\n    //////////////////////////////////////////////////////////\r\n\r\n\r\n    searchOneTweet(){\r\n      //THIS IS WHEN YOU NEED ONLY 1 TWEET IN THE TIMELINE\r\n      //WHEN YOU ARE REDIRECTED FROM THE NOTIFICATIONS\r\n      const id = window.location.pathname.replace(\"/tweet/\", \"\");\r\n\r\n      let tweetsToShow = [];\r\n\r\n        var userData = {};\r\n\r\n      const tweetsDB = firebase.database().ref().child(\"tweets\");\r\n      const usersDB = firebase.database().ref().child(\"users\");\r\n\r\n      tweetsDB.once(\"value\", data => {\r\n        let tweets = data.val()\r\n        const keys = Object.keys(tweets)\r\n        let count = 0;\r\n        let approved;\r\n        for (let i = 0; i < keys.length; i++){\r\n\r\n          if (count === 1) break;\r\n\r\n          approved = false;\r\n          \r\n\r\n          if (tweets[keys[i]][\"tweetId\"] === id) {\r\n\r\n            approved = true;\r\n            count++;\r\n\r\n            //GET USER OF TWEET\r\n            userData[\"id\"] = tweets[keys[i]][\"user\"];\r\n            \r\n            \r\n            //CHECK HOW MANY LIKES\r\n            if (!!tweets[keys[i]][\"likes\"]){\r\n              tweets[keys[i]][\"likesNumber\"]= tweets[keys[i]][\"likes\"].length;\r\n            } else {\r\n              tweets[keys[i]][\"likesNumber\"]= 0;\r\n            }\r\n\r\n            //NUMBER OF RETWEETS\r\n            if(!!tweets[keys[i]][\"retweetedBy\"]) {\r\n              tweets[keys[i]][\"retweetedByNumber\"] = tweets[keys[i]][\"retweetedBy\"].length;\r\n            }\r\n\r\n            //ORDERING DATE\r\n            tweets[keys[i]][\"orderingDate\"] = tweets[keys[i]][\"date\"];\r\n\r\n            //SHOWRETWEETEDBY\r\n            tweets[keys[i]][\"showRetweetedBy\"] = false;\r\n\r\n          } \r\n\r\n          if (approved) {\r\n          tweetsToShow.push(tweets[keys[i]])\r\n          }\r\n        }      \r\n        \r\n      \r\n      },error => {console.log(error)}).then(() => {\r\n\r\n        usersDB.once(\"value\", data => {\r\n          const users = data.val();\r\n          const keys = Object.keys(users)\r\n\r\n          userData[\"userPage\"] = true;            \r\n          \r\n \r\n          for (let i = 0; i < keys.length; i++) {\r\n              if (userData[\"id\"] === users[keys[i]][\"id\"] ) {\r\n                  userData[\"email\"] = users[keys[i]].email\r\n                  userData[\"name\"] = users[keys[i]].firstName\r\n                  userData[\"following\"] = [id];\r\n              }\r\n          }\r\n         \r\n      }).then(x =>{\r\n\r\n        this.reRender(tweetsToShow, userData[\"userPage\"]);\r\n      \r\n    })\r\n\r\n\r\n      })\r\n           \r\n\r\n          \r\n    }\r\n\r\n    searchTweets() {\r\n        let tweetsToShow = [];\r\n\r\n        var userData = {};\r\n\r\n      const tweetsDB = firebase.database().ref().child(\"tweets\");\r\n      const usersDB = firebase.database().ref().child(\"users\");\r\n           \r\n\r\n          usersDB.once(\"value\", data => {\r\n            const users = data.val();\r\n            const keys = Object.keys(users)\r\n\r\n            const id = window.location.pathname.replace(\"/\", \"\");\r\n            userData[\"userPage\"] = id.length > 1;            \r\n            \r\n\r\n            let userEmail;\r\n            if (!userData[\"userPage\"]){     \r\n            userEmail = firebase.auth().currentUser.email;\r\n            }\r\n            \r\n            \r\n            \r\n\r\n            if (userData[\"userPage\"]) {\r\n              for (let i = 0; i < keys.length; i++) {\r\n                if (id === users[keys[i]][\"id\"] ) {\r\n                    userData[\"email\"] = users[keys[i]].email\r\n                    userData[\"name\"] = users[keys[i]].firstName\r\n                    userData[\"id\"] = users[keys[i]].id\r\n                    userData[\"following\"] = [id];\r\n                }\r\n            }\r\n\r\n            } else {\r\n\r\n              for (let i = 0; i < keys.length; i++) {\r\n                \r\n                  if (userEmail === users[keys[i]][\"email\"] ) {\r\n                      userData[\"email\"] = users[keys[i]].email\r\n                      userData[\"name\"] = users[keys[i]].firstName\r\n                      userData[\"id\"] = users[keys[i]].id\r\n                      userData[\"following\"] = users[keys[i]].following;\r\n                  }\r\n              }\r\n            }\r\n\r\n\r\n            //THIS ADD TO FOLLOWING IS FOR SHOWING OWN USER'S TWEETS\r\n            if (typeof(userData[\"following\"]) === \"undefined\") {\r\n              userData[\"following\"] = [userData[\"id\"]];\r\n            } else {\r\n              userData[\"following\"].push(userData[\"id\"]);\r\n            }            \r\n        }).then(x =>{\r\n\r\n            tweetsDB.once(\"value\", data => {\r\n              let tweets = data.val()\r\n              const keys = Object.keys(tweets)\r\n              let count = 0;\r\n              let approved;\r\n              for (let i = 0; i < keys.length; i++){\r\n\r\n                approved = false;\r\n                \r\n\r\n                if (this.matchUsers(userData[\"following\"],tweets[keys[i]][\"user\"])) {\r\n\r\n                  approved = true;\r\n\r\n                  \r\n                  \r\n                  //CHECK HOW MANY LIKES\r\n                  if (!!tweets[keys[i]][\"likes\"]){\r\n                    tweets[keys[i]][\"likesNumber\"]= tweets[keys[i]][\"likes\"].length;\r\n                  } else {\r\n                    tweets[keys[i]][\"likesNumber\"]= 0;\r\n                  }\r\n\r\n                  //NUMBER OF RETWEETS\r\n                  if(!!tweets[keys[i]][\"retweetedBy\"]) {\r\n                    tweets[keys[i]][\"retweetedByNumber\"] = tweets[keys[i]][\"retweetedBy\"].length;\r\n                  }\r\n\r\n                  \r\n                  tweets[keys[i]][\"orderingDate\"] = tweets[keys[i]][\"date\"];\r\n\r\n                  //SHOWRETWEETEDBY\r\n                  tweets[keys[i]][\"showRetweetedBy\"] = false;\r\n\r\n                  //PUSH FOUND TWEET\r\n                  /* tweetsToShow.push(tweets[keys[i]])\r\n                  count++; */\r\n                } \r\n\r\n                \r\n                if (this.matchUsersRetweet(userData[\"following\"],tweets[keys[i]][\"retweetedBy\"])) {\r\n\r\n                  approved = true;\r\n\r\n\r\n                  //CHECK HOW MANY LIKES\r\n                  if (!!tweets[keys[i]][\"likes\"]){\r\n                    tweets[keys[i]][\"likesNumber\"]= tweets[keys[i]][\"likes\"].length;\r\n                  } else {\r\n                    tweets[keys[i]][\"likesNumber\"]= 0;\r\n                  }\r\n\r\n                  //NUMBER OF RETWEETS\r\n                  if(!!tweets[keys[i]][\"retweetedBy\"]) {\r\n                    tweets[keys[i]][\"retweetedByNumber\"] = tweets[keys[i]][\"retweetedBy\"].length;\r\n                  }\r\n\r\n                  var matches = this.matchUsersRetweet(userData[\"following\"],tweets[keys[i]][\"retweetedBy\"]);\r\n                  \r\n                  tweets[keys[i]][\"matchingRetweeted\"] = matches;\r\n\r\n                  //ITS SUPPOSED TO TAKE THE LAST DATE\r\n                  tweets[keys[i]][\"orderingDate\"] = matches[matches.length-1][1];\r\n                  \r\n                  //SHOWRETWEETEDBY\r\n                  tweets[keys[i]][\"showRetweetedBy\"] = true;\r\n\r\n                  //PUSH FOUND TWEET\r\n                 \r\n                }\r\n\r\n                if (approved) {\r\n                tweetsToShow.push(tweets[keys[i]])\r\n                  count++;\r\n                }\r\n              }      \r\n              \r\n            \r\n            },error => {console.log(error)})\r\n            .then( x => {\r\n            this.reRender(tweetsToShow, userData[\"userPage\"]);\r\n          })\r\n\r\n        })\r\n\r\n\r\n           \r\n      \r\n    }\r\n\r\n    matchUsers(userId, tweetUser) { \r\n      if (typeof(userId) === \"string\") userId = [userId];\r\n      return Boolean(userId.find(userId =>{\r\n        return userId === tweetUser\r\n      }))\r\n    }\r\n\r\n    matchUsersRetweet(following, retweetedBy) { \r\n\r\n      if (!retweetedBy) return false;\r\n\r\n      let matchs = [];\r\n      var found = undefined;\r\n\r\n      for (let i = 0; i<retweetedBy.length; i++){\r\n        found = following.find(followingUser =>{\r\n          return followingUser === retweetedBy[i][0]\r\n        })\r\n        if (!!found) {\r\n          matchs.push(retweetedBy[i])\r\n        }\r\n      }\r\n\r\n      if (matchs.length === 0) {\r\n        return false;\r\n      }\r\n\r\n      return matchs;\r\n    }\r\n    \r\n\r\n    \r\n    render() { \r\n  \r\n            // SORTING FROM DATE\r\n            var showingTweets = this.state.tweetsToShow.sort( (a,b) => {       \r\n              var timeA = new Date(a[\"orderingDate\"]).getTime()\r\n              var timeB = new Date(b[\"orderingDate\"]).getTime()\r\n              return timeB - timeA;\r\n              })\r\n              console.log(\"showing\", showingTweets)\r\n\r\n              var showingNewTweets = this.state.newTweets;\r\n\r\n        return ( \r\n            <div className=\"timeLine-container\">\r\n\r\n              {this.state.userPage ?  null : <WriteTweet refreshRender={this.refreshRender}/>}\r\n\r\n              {showingNewTweets.map((tweet,i) => {        \r\n                console.log(\"sending\", tweet)            \r\n                      return (\r\n                          <Tweet key={tweet.tweetId} tweet={tweet}/>\r\n                      )\r\n                  })\r\n              }\r\n\r\n              {showingTweets.map((tweet,i) => {        \r\n                console.log(\"sending\", tweet)            \r\n                      return (\r\n                          <Tweet key={i} tweet={tweet} />\r\n                      )\r\n                  })\r\n              }\r\n            </div>\r\n         );\r\n    }\r\n}\r\n \r\nexport default TimeLine;","import React, { Component } from 'react';\r\nimport {Link} from \"react-router-dom\";\r\nimport firebase from \"firebase\";\r\n\r\nclass UserBox extends Component {\r\n    state = { \r\n        name: \"\",\r\n        id: \"\",\r\n        following: \"\",\r\n        followers : \"\",\r\n        tweetCount: \"\",\r\n        profilepic: false,\r\n        coverpic: false,\r\n     }\r\n\r\n     componentDidMount(){\r\n         const usersDB = firebase.database().ref().child(\"users\");\r\n         const tweetsDB = firebase.database().ref().child(\"tweets\");\r\n         const email = firebase.auth().currentUser.email;\r\n\r\n         function fromUndefinedToZero (data) {\r\n            if (typeof(data) === \"undefined\") return 0;\r\n            return data.length;\r\n        }\r\n\r\n         let name = \"\",\r\n            id = \"\",\r\n            following = \"\",\r\n            followers = \"\",\r\n            tweetCount = 0,\r\n            profilepic = false,\r\n            coverpic = false;\r\n\r\n         usersDB.once(\"value\", data => {\r\n            const users = data.val();\r\n            const keys = Object.keys(users);\r\n\r\n            for (let i = 0; i < keys.length; i++){\r\n                if (email === users[keys[i]][\"email\"]) {\r\n                    name = users[keys[i]][\"firstName\"];\r\n                    id = users[keys[i]][\"id\"];\r\n                    following = fromUndefinedToZero(users[keys[i]][\"following\"]);\r\n                    followers = fromUndefinedToZero(users[keys[i]][\"followers\"]);\r\n                    profilepic = users[keys[i]][\"profilepic\"]\r\n                    coverpic = users[keys[i]][\"coverpic\"]\r\n                    break;                    \r\n                }\r\n            }\r\n         }).then(x => {\r\n            tweetsDB.once(\"value\", data => {\r\n                const tweets = data.val();\r\n                const keys = Object.keys(tweets);\r\n\r\n                for (let i = 0; i < keys.length; i++) {\r\n                    if (email === tweets[keys[i]][\"email\"]) {\r\n                        tweetCount++;\r\n                    }\r\n                }\r\n            }).then(x => {\r\n                if (!profilepic) {\r\n                    profilepic = \"https://cdn.britannica.com/67/197567-131-1645A26E.jpg\"\r\n                }\r\n                if (!coverpic) {\r\n                    coverpic = \"https://images.unsplash.com/photo-1518791841217-8f162f1e1131?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80\"\r\n                }\r\n                this.setState({\r\n                    name, id, following, followers, tweetCount, profilepic, coverpic\r\n                })\r\n            })\r\n         })\r\n     }\r\n\r\n\r\n    render() {   \r\n\r\n        let image;\r\n\r\n        if (!this.state.coverpic) {\r\n            image= \"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812\";\r\n        } else {\r\n            image = this.state.coverpic\r\n        }\r\n\r\n        const style = {\r\n            height: 95+\"px\",\r\n            width: 100+\"%\",\r\n            backgroundSize: \"cover\",\r\n            backgroundPosition: \"center\",\r\n            backgroundImage: `url(${image})`,\r\n        }\r\n        \r\n        return (\r\n            <div className=\"userBox-container\">\r\n                    \r\n                    <div className=\"userBox-background\" style={style}></div>\r\n\r\n                <div className=\"userBox-content\">\r\n                    <div className=\"userBox-content-top\">\r\n                                <div className=\"userBox-content-picture\">\r\n                                    <picture>\r\n                                        {\r\n                                        this.state.profilepic ?\r\n                                        <img id=\"profile-picture\" src={this.state.profilepic}/> :\r\n                                        <img id=\"profile-picture\" src=\"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812\"/>\r\n                                        }\r\n                                    </picture>\r\n                                </div>\r\n                        <div className=\"userBox-content-right\">\r\n                            <Link to={`${this.state.id}`}>\r\n                                <div id=\"userBox-name\" className=\"userBox-content-name\">{this.state.name}</div>\r\n                                <div id=\"userBox-userId\" className=\"userBox-content-userId\">@{this.state.id}</div>\r\n                            </Link>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"userBox-content-information\">\r\n                       <Link to={\"\"} >\r\n                            <div className=\"userBox-content-tweets\">\r\n                                <h5 id=\"userBox-information\">Tweets</h5>\r\n                                <h5 id=\"userBox-number\">{this.state.tweetCount} </h5>\r\n                            </div> \r\n                        </Link>\r\n\r\n                        <Link to={\"\"}> \r\n                            <div className=\"userBox-content-following\">\r\n                                <h5 id=\"userBox-information\">Following</h5>\r\n                                <h5 id=\"userBox-number\">{this.state.following} </h5>\r\n                            </div> </Link>\r\n                        <Link to={\"\"}>\r\n                            <div className=\"userBox-content-followers\">\r\n                                <h5 id=\"userBox-information\">Followers</h5>\r\n                                <h5 id=\"userBox-number\">{this.state.followers} </h5>\r\n                            </div> \r\n                        </Link>\r\n                    </div>\r\n                    \r\n                </div>\r\n            </div>\r\n          );\r\n    }\r\n}\r\n \r\nexport default UserBox;","import React from 'react';\r\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\r\nimport {faSearch, faPeopleCarry, faComment as faReply} from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nclass LandingPage extends React.Component {\r\n\r\n    logIn = this.logIn.bind(this);\r\n\r\n    emailRef = React.createRef()\r\n    passwordRef = React.createRef();\r\n\r\n    logIn(e){\r\n        e.preventDefault();\r\n\r\n        const email = this.emailRef.current.value;\r\n        const password = this.passwordRef.current.value;\r\n\r\n        this.props.logIn(email,password)\r\n    }\r\n\r\n    render(){\r\n            return (  \r\n            \r\n            <div className=\"landing-page-container\">\r\n                <div className=\"landing-page-left\">\r\n                    <div className=\"landing-page-left-text-container\">\r\n                        <div className=\"landing-page-left-1 landing-page-left-text\">\r\n                            <h3><FontAwesomeIcon icon={faSearch}/>    Twitter Clone</h3>\r\n                        </div>\r\n                        <div className=\"landing-page-left-2 landing-page-left-text\">\r\n                            <h3><FontAwesomeIcon icon={faPeopleCarry}/>    Made by:</h3>\r\n                        </div>\r\n                        <div className=\"landing-page-left-3 landing-page-left-text\">\r\n                            <h3><FontAwesomeIcon icon={faReply}/>    Ronny Legones</h3>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"landing-page-right\">\r\n                    <div className=\"landing-page-login\">\r\n                        <form onSubmit={this.logIn}>\r\n                        <input className=\"login-input\" ref={this.emailRef} type=\"text\" placeholder=\"Email or Username\"/>\r\n                        <input className=\"login-input\" ref={this.passwordRef} type=\"password\" placeholder=\"Password\"/>\r\n                        <button className=\"login-btn\" type=\"submit\" >Login</button>                        \r\n                        </form>\r\n                        <p className=\"login-forgot\">Forgot your password?</p>\r\n                    </div>\r\n\r\n\r\n                    <div className=\"landing-page-right-text-container\">\r\n                        <div className=\"landing-page-right-box\">\r\n                            <div className=\"landing-page-right-box-text\">\r\n                                <FontAwesomeIcon icon={faSearch}/>\r\n                                <h3 id=\"hola\">    Discover what is happening at this moment.</h3>\r\n                            </div>\r\n                            <div className=\"landing-page-right-box-join\">\r\n                                <h3 className=\"join-twitter\">Join Twitter today.</h3>\r\n                                <div className=\"landing-page-btn-signup\" onClick={this.props.toggleRegisterPopUp}>Sign Up</div>\r\n                                <div className=\"landing-page-btn-login\">Login</div>\r\n                            </div>\r\n                        </div>                    \r\n                    </div>\r\n                </div>\r\n\r\n                \r\n\r\n                <div className=\"landing-page-footer\">\r\n\r\n                </div>\r\n            </div>\r\n        );}\r\n}\r\n \r\nexport default LandingPage;","import React from 'react'\r\n\r\nclass RegisterPopUp extends React.Component {\r\n\r\n    register = this.register.bind(this)\r\n\r\n    refName= React.createRef()\r\n    refEmail= React.createRef()\r\n    refPassword= React.createRef()\r\n    refUserId = React.createRef()\r\n\r\n    register(e){\r\n        e.preventDefault()\r\n\r\n        const name=this.refName.current.value\r\n        const userId= this.refUserId.current.value\r\n        const email=this.refEmail.current.value\r\n        const password=this.refPassword.current.value\r\n\r\n        if (name.length < 2) {\r\n            window.alert(\"Your name is too short.\")\r\n            return null;\r\n        } else if (userId.length < 4) {\r\n            window.alert(\"Your user id is too short.\")\r\n            return null;\r\n        } else if (email.length < 5) {\r\n            window.alert (\"Your email is too short\")\r\n            return null;\r\n        } else if (password < 4){\r\n            window.alert(\"Your password is too short.\")\r\n            return null;\r\n        }\r\n\r\n        const registerData = {\r\n            name,\r\n            email,\r\n            password,\r\n            userId\r\n        }\r\n        \r\n        this.props.register(registerData);\r\n    }\r\n    render(){\r\n    return ( \r\n        <div className=\"register-popup-container\" >\r\n            <div className=\"register-popup-inner\">\r\n                <h1>Register</h1>\r\n                \r\n                <form onSubmit={this.register}>\r\n                    <div>\r\n                        <label>Name:</label>\r\n                        <input type=\"text\" maxLength={20} placeholder=\"your name\" ref={this.refName}/>\r\n                    </div>\r\n                    <div>\r\n                        <label>User ID:</label>\r\n                        <input type=\"text\" maxLength={15} placeholder=\"your id\" ref={this.refUserId}/>\r\n                    </div>\r\n                    <div>\r\n                        <label>E-mail:</label>\r\n                        <input type=\"email\" maxLength={30} placeholder=\"your email\" ref={this.refEmail}/>\r\n                    </div>\r\n                    <div>\r\n                        <label>Password:</label>\r\n                        <input type=\"text\" maxLength={16} placeholder=\"password\" ref={this.refPassword}/>\r\n                    </div>\r\n                <button type=\"submit\">Sign Up</button>\r\n                </form>\r\n                <button type=\"button\" onClick={this.props.toggleRegisterPopUp}>Close</button>\r\n            </div>\r\n        </div>\r\n     );}\r\n}\r\n \r\nexport default RegisterPopUp;","import React from 'react'\r\nimport UserBox from \"./UserBox\";\r\nimport TimeLine from \"./TimeLine\"\r\nimport firebase from \"firebase\";\r\n\r\nvar userData = {};\r\nvar propsSent = false;\r\nvar homeTweets = {};\r\nvar tweetMessage = \"\";\r\n\r\nclass LoggedLanding extends React.Component {    \r\n\r\n    componentWillMount(){\r\n\r\n    }\r\n   \r\n\r\n    render (){\r\n        const email = firebase.auth().currentUser.email\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const tweetsDB = firebase.database().ref().child(\"tweets\");\r\n\r\n        tweetsDB.once(\"value\", data => {\r\n            const tweets = data.val();\r\n            const keys = Object.keys(tweets);\r\n            let tweetCount = 0;\r\n            let tweetHomeCount = 0;\r\n\r\n            for (let i = 0; i < keys.length; i++) {\r\n                if (tweets[keys[i]].email === email) {\r\n                    tweetCount++;\r\n                }                \r\n            }\r\n\r\n            userData[\"tweetCount\"] = tweetCount;\r\n        })\r\n\r\n        \r\n        \r\n\r\n        usersDB.once(\"value\", data => {\r\n            const users = data.val()\r\n            const keys = Object.keys(users)\r\n\r\n            for (let i = 0; i < keys.length; i++) {\r\n               if (users[keys[i]].email === email) {\r\n                   userData[\"email\"] = email;\r\n                   userData[\"name\"] = users[keys[i]].firstName;\r\n                   userData[\"userId\"] = users[keys[i]].id;\r\n                   userData[\"following\"] = users[keys[i]].following;\r\n                   userData[\"followers\"] = users[keys[i]].folowers;\r\n               }\r\n            }\r\n        }).catch(error => {console.log(error)})\r\n\r\n        //INTERVAL FOR LOADING INFO\r\n        if (!propsSent){\r\n            var interval = setInterval(x => {\r\n                if (Boolean(userData.name) || Boolean(userData.tweetCount)) {\r\n                    clearInterval(interval)\r\n                    propsSent = true;\r\n                    this.setState({})\r\n                }\r\n            }, 2000)\r\n        }\r\n        ////////////////////////////////////////////////////////////////////\r\n\r\n        return ( \r\n            \r\n            <React.Fragment>\r\n                <div className=\"app-container\">\r\n                                <div className=\"app-left\">\r\n                                <UserBox userData={userData}/>\r\n                                </div>\r\n                    \r\n                                <div className=\"app-mid\">\r\n                                <TimeLine userData={userData}/>\r\n                                </div>\r\n\r\n                                <div className=\"app-right\">\r\n                                </div>\r\n                </div>\r\n            </React.Fragment>\r\n            \r\n        );}\r\n}\r\n \r\nexport default LoggedLanding;","import React from 'react';\r\n\r\nconst Loading = () => {\r\n    return ( \r\n        <div className=\"loading\">\r\n            <div className=\"lds-default\"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>\r\n        </div>\r\n     );\r\n}\r\n \r\nexport default Loading;","import React, { Component } from 'react';\r\nimport firebase from \"firebase\";\r\n\r\nclass FollowButton extends Component {\r\n    state = {  }\r\n    follow = this.follow.bind(this)\r\n\r\n    follow(){\r\n        this.props.follow();\r\n    }\r\n\r\n    render() { \r\n        \r\n        return ( \r\n            <div className=\"follow-unfollow\">\r\n            <span className=\"follow-button\" onClick={this.follow}>Follow</span>\r\n            </div>\r\n         );\r\n    }\r\n}\r\n \r\nexport default FollowButton;","import React, { Component } from 'react';\r\nimport firebase from \"firebase\";\r\n\r\nclass UnfollowButton extends Component {\r\n    state = {  }\r\n\r\n    unfollow = this.unfollow.bind(this)\r\n\r\n    unfollow(){\r\n        this.props.unfollow();\r\n    }\r\n\r\n    render() { \r\n        return ( \r\n            <div className=\"follow-unfollow\">\r\n            <span className=\"unfollow-button\" onClick={this.unfollow}>Unfollow</span>\r\n            </div>\r\n         );\r\n    }\r\n}\r\n \r\nexport default UnfollowButton;","import React, { Component } from 'react';\r\nimport firebase from \"firebase\";\r\nimport FollowButton from \"./FollowButton\";\r\nimport UnfollowButton from \"./UnfollowButton\";\r\nimport {Link} from \"react-router-dom\";\r\n\r\n\r\nclass UserBoxInUserPage extends Component {\r\n    state = { \r\n        name: \"\",\r\n        id: \"\",\r\n        following: \"\",\r\n        followers: \"\",\r\n        tweetCount: \"\",\r\n        notFound: false,\r\n        followingButton: -1,\r\n        profilepic: false,\r\n        coverpic: false,\r\n     }\r\n\r\n    /* follow = this.follow.bind(this);\r\n    unfollow = this.unfollow.bind(this); */\r\n    sendToState = this.sendToState.bind(this)\r\n\r\n     sendToState(name, id, following, followers, tweetCount, followingButton,profilepic, coverpic){\r\n         this.setState({\r\n            name, id, following, followers, tweetCount, followingButton,profilepic, coverpic\r\n         })\r\n     }\r\n\r\n    componentDidMount(){\r\n\r\n        console.log(\"mounting\")\r\n\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const tweetsDB = firebase.database().ref().child(\"tweets\");\r\n        \r\n        let email = \"\";\r\n\r\n        let name = \"\",\r\n           id = window.location.pathname.replace(\"/\", \"\"),\r\n           following = \"\",\r\n           followers = \"\",\r\n           tweetCount = 0,\r\n           followingButton = -1,\r\n           profilepic = false,\r\n           coverpic = false;\r\n\r\n           // -1 No loggeado\r\n           // 0 Sin seguir\r\n           // 1 Siguiendo\r\n        \r\n\r\n        function fromUndefinedToZero (data) {\r\n           if (typeof(data) === \"undefined\") return 0;\r\n           return data.length;\r\n       }\r\n\r\n        \r\n\r\n        usersDB.once(\"value\", data => {\r\n           const users = data.val();\r\n           const keys = Object.keys(users);\r\n\r\n           for (let i = 0; i < keys.length; i++){\r\n               if (id === users[keys[i]][\"id\"]) {\r\n                   name = users[keys[i]][\"firstName\"];\r\n                   following = fromUndefinedToZero(users[keys[i]][\"following\"]);\r\n                   followers = fromUndefinedToZero(users[keys[i]][\"followers\"]);\r\n                   email = users[keys[i]][\"email\"];\r\n                   profilepic = users[keys[i]][\"profilepic\"]\r\n                   coverpic = users[keys[i]][\"coverpic\"]                   \r\n                   break;                    \r\n               }\r\n           }\r\n\r\n          \r\n        }).then(x => {\r\n           tweetsDB.once(\"value\", data => {\r\n               const tweets = data.val();\r\n               const keys = Object.keys(tweets);\r\n\r\n               for (let i = 0; i < keys.length; i++) {\r\n                   if (email === tweets[keys[i]][\"email\"]) {\r\n                       tweetCount++;\r\n                   }\r\n               }\r\n           }).then(x => {\r\n\r\n            if (!profilepic) {\r\n                profilepic = \"https://cdn.britannica.com/67/197567-131-1645A26E.jpg\"\r\n            }\r\n            if (!coverpic) {\r\n                coverpic = \"https://images.unsplash.com/photo-1518791841217-8f162f1e1131?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80\"\r\n            }\r\n\r\n                firebase.auth().onAuthStateChanged((user) => {       \r\n                    if (user) { \r\n                        const loggedEmail = firebase.auth().currentUser.email;\r\n        \r\n                        //FOLLOWING BUTTON ACTIVATION (OR NOT)\r\n                        usersDB.once(\"value\", data => {\r\n                            const users = data.val();\r\n                            const keys = Object.keys(users);\r\n\r\n                            for (let i = 0; i < keys.length; i++){\r\n                                if (loggedEmail === users[keys[i]][\"email\"]){\r\n\r\n                                    const userId = users[keys[i]][\"id\"];\r\n\r\n                                    if (id === users[keys[i]][\"id\"]) break;\r\n\r\n                                    if (typeof(users[keys[i]][\"following\"]) == \"undefined\"){\r\n                                        followingButton = 0;\r\n                                        break;\r\n                                    }\r\n                                    \r\n                                    \r\n                                    const following = users[keys[i]][\"following\"];\r\n                                    const followingKeys = Object.keys(users[keys[i]][\"following\"]);\r\n\r\n                                    for (let j = 0; j <followingKeys.length; j++) {\r\n                                        if (id === following[followingKeys[j]]) {\r\n                                            followingButton = 1;\r\n                                            break;\r\n                                        } else {\r\n                                            followingButton = 0;\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            this.setState({\r\n                                name, id, following, followers, tweetCount, followingButton, profilepic, coverpic\r\n                             })\r\n\r\n                        })\r\n                    } else {\r\n                        console.log(\"no user logged\", name, id, following, followers, tweetCount, followingButton)\r\n                        this.setState({\r\n                            name, id, following, followers, tweetCount, followingButton, profilepic, coverpic\r\n                         })\r\n                    }\r\n                })\r\n           })\r\n        })\r\n    }\r\n\r\n    follow = () => {\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const email = firebase.auth().currentUser.email;\r\n\r\n        let userNotifications = [];\r\n        let newNotification = [];\r\n\r\n        //ID of the userPage\r\n        const id = this.state.id;\r\n\r\n        let following = undefined;\r\n        let followers = undefined;\r\n\r\n        let followingUser = \"\";\r\n\r\n        usersDB.once(\"value\", data => {\r\n            const users = data.val();\r\n            const keys = Object.keys(users)\r\n\r\n            for (let i = 0; i < keys.length; i++) {\r\n\r\n                //ADDING TO FOLLOWING\r\n                if (users[keys[i]][\"email\"] === email) {\r\n                    console.log(users[keys[i]])\r\n                    following = users[keys[i]][\"following\"]\r\n                    followingUser = users[keys[i]][\"id\"];\r\n\r\n                    //Add the follower ID to the notifications\r\n                    newNotification[0] = users[keys[i]][\"id\"];\r\n                }\r\n\r\n                //GET NOTIFICATIONS OF FOLLOWED\r\n                if (id === users[keys[i]][\"id\"]) {\r\n                    userNotifications = users[keys[i]][\"notifications\"]\r\n                }\r\n            }\r\n\r\n            if (typeof(following) === \"undefined\") {\r\n                following = [id];\r\n            } else {\r\n                following.push(id);\r\n            }\r\n\r\n            //NOTIFICATIONS\r\n            newNotification[1] = new Date().toISOString();\r\n            newNotification[2] = 0;\r\n            newNotification[3] = \"follow\";\r\n            \r\n            if (!userNotifications){\r\n                userNotifications = [newNotification];\r\n            } else {\r\n                userNotifications.push(newNotification)\r\n            }\r\n\r\n            \r\n            usersDB.child(id).child(\"notifications\").set(userNotifications);\r\n\r\n            /////////////////////////\r\n\r\n            \r\n            for (let i = 0; i < keys.length; i++){\r\n\r\n                //ADDING TO FOLLOWERS\r\n                if (users[keys[i]][\"id\"] === id) {\r\n                    console.log(users[keys[i]])\r\n                    followers = users[keys[i]][\"followers\"];\r\n\r\n                    if (typeof(followers) === \"undefined\") {\r\n                        followers = [followingUser];\r\n                    } else {\r\n                        followers.push(followingUser);\r\n                    }\r\n                }                \r\n            }\r\n\r\n            console.log(followers)\r\n            \r\n            usersDB.child(id).child(\"followers\").set(followers);\r\n            usersDB.child(followingUser).child(\"following\").set(following);\r\n            \r\n        }).then( x => {\r\n            console.log(\"following done\")\r\n            this.setState({\r\n                followingButton:1,\r\n                followers: this.state.followers +1\r\n            })\r\n        })\r\n    }\r\n\r\n    unfollow =() => {\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const email = firebase.auth().currentUser.email;\r\n\r\n        let userNotifications = [];\r\n\r\n        const id = this.state.id;\r\n\r\n        let following = [];\r\n        let followers = [];\r\n\r\n        let followingUser = \"\";\r\n\r\n        usersDB.once(\"value\", data => {\r\n            const users = data.val();\r\n            const keys = Object.keys(users)\r\n\r\n            for (let i = 0; i < keys.length; i++) {\r\n\r\n                //DELETE FROM FOLLOWING\r\n                if (users[keys[i]][\"email\"] === email) {\r\n                    following = users[keys[i]][\"following\"]\r\n                    followingUser = users[keys[i]][\"id\"];\r\n                }\r\n\r\n                //GET UNFOLLOWED NOTIFICATIONS\r\n                if (id === users[keys[i]][\"id\"]){\r\n                    userNotifications = users[keys[i]][\"notifications\"];\r\n                }\r\n            }\r\n\r\n            /// DELETE FOLLOW NOTIFICATIONS\r\n                if (!userNotifications) {\r\n                    userNotifications = [];\r\n                } else if (userNotifications.length === 1) {\r\n                    userNotifications = []\r\n                } else {\r\n                    userNotifications = userNotifications.filter(notification => {\r\n                        return !(notification[0] === followingUser && notification[3] === \"follow\")\r\n                    })\r\n                }\r\n\r\n                usersDB.child(id).child(\"notifications\").set(userNotifications)\r\n\r\n            ///////////////////////////////\r\n\r\n\r\n            if (following.length === 1) {\r\n                following = [];\r\n            } else {\r\n                following = following.filter(followedId => {\r\n                    return followedId !== id;\r\n                })\r\n            }\r\n\r\n            for (let i = 0; i < keys.length; i++){\r\n\r\n                //DELETE FROM FOLLOWERS\r\n                if (users[keys[i]][\"id\"] === id) {\r\n                    followers = users[keys[i]][\"followers\"];\r\n\r\n                    if (followers.length === 1) {\r\n                        followers = [];\r\n                    } else {\r\n                        followers.filter(followedId => {\r\n                            return followedId !== followingUser\r\n                        });\r\n                    }\r\n                }\r\n\r\n                \r\n            }\r\n\r\n            \r\n            usersDB.child(id).child(\"followers\").set(followers);\r\n            usersDB.child(followingUser).child(\"following\").set(following);\r\n            \r\n        }).then(x => {\r\n            this.setState({\r\n                followingButton:0,\r\n                followers: this.state.followers -1\r\n            })\r\n        })\r\n    }\r\n\r\n\r\n    render() {                \r\n\r\n        return ( \r\n            <div className=\"userBoxUP-container\">\r\n                {/* PROFILE PIC HERE  */}\r\n                {this.state.profilepic ?\r\n                <img id=\"userBoxUP-image\" src={this.state.profilepic} alt=\"profile picture\"/> :\r\n                <img id=\"userBoxUP-image\" src=\"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812\" alt=\"profile picture\"/>}\r\n\r\n                <h3 id=\"userBoxUP-name\">{this.state.name}</h3>\r\n                <p id=\"userBoxUP-user\">@{this.state.id}</p>\r\n                <p id=\"userBoxUP-description\">Non editable description.</p>    \r\n\r\n                \r\n\r\n                {(this.state.followingButton === -1) ? null : ((this.state.followingButton === 0) ? <FollowButton follow={this.follow}/> : <UnfollowButton unfollow={this.unfollow}/>) }\r\n\r\n                    \r\n                    <div className=\"userBox-content-information userBoxInUserPage-content\">\r\n                       <Link to={\"\"} >\r\n                            <div className=\"userBox-content-tweets\">\r\n                                <h5 id=\"userBox-information\">Tweets</h5>\r\n                                <h5 id=\"userBox-number\">{this.state.tweetCount} </h5>\r\n                            </div> \r\n                        </Link>\r\n\r\n                        <Link to={\"\"}> \r\n                            <div className=\"userBox-content-following\">\r\n                                <h5 id=\"userBox-information\">Following</h5>\r\n                                <h5 id=\"userBox-number\">{this.state.following} </h5>\r\n                            </div> </Link>\r\n                        <Link to={\"\"}>\r\n                            <div className=\"userBox-content-followers\">\r\n                                <h5 id=\"userBox-information\">Followers</h5>\r\n                                <h5 id=\"userBox-number\">{this.state.followers} </h5>\r\n                            </div> \r\n                        </Link>\r\n                    </div>\r\n\r\n            </div>\r\n         );\r\n    }\r\n}\r\n \r\nexport default UserBoxInUserPage;","import React, { Component } from 'react';\r\nimport TimeLine from \"./TimeLine\";\r\nimport firebase from \"firebase\";\r\nimport UserBoxInUserPage from './UserBoxInUserPage';\r\n\r\n\r\nclass UserPage extends Component {\r\n    state = { \r\n        loaded : false,\r\n        coverpic: false,\r\n     }\r\n\r\n     componentDidMount(){\r\n\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n        const id = this.props.id;\r\n        let coverpic = false;\r\n\r\n        usersDB.once(\"value\", data => {\r\n            const users = data.val();\r\n            const keys = Object.keys(users)\r\n            \r\n\r\n            for (let i = 0; i < keys.length; i++) {\r\n                if (id === users[keys[i]][\"id\"]) {\r\n                    if (!!users[keys[i]][\"coverpic\"]) {\r\n                        coverpic = users[keys[i]][\"coverpic\"]\r\n                    }\r\n                   \r\n                }\r\n\r\n            }\r\n        }).then(() => {\r\n            if (!coverpic) {\r\n                coverpic = \"https://images.unsplash.com/photo-1518791841217-8f162f1e1131?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80\"\r\n            }\r\n        this.setState({\r\n                    coverpic\r\n               })\r\n        })\r\n     }\r\n\r\n    render() { \r\n        let image;\r\n\r\n        if (!this.state.coverpic) {\r\n            image= \"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812\";\r\n        } else {\r\n            image = this.state.coverpic\r\n        }\r\n\r\n        \r\n\r\n        const style = {\r\n            height: 300+\"px\",\r\n            width: 100+\"%\",\r\n            backgroundSize: \"cover\",\r\n            backgroundPosition: \"center\",\r\n            backgroundImage: `url(${image})`,\r\n            backgroundColor: \"white\",\r\n            marginTop: \"50px\"\r\n        }\r\n        return ( \r\n            <React.Fragment>  \r\n\r\n                <div className=\"userpage-background\" style={style}></div>             \r\n\r\n                <div className=\"app-container app-container-userPage\">\r\n\r\n                \r\n                                    <div className=\"app-left\">\r\n                                    <UserBoxInUserPage/>\r\n                                    </div>\r\n                        \r\n                                    <div className=\"app-mid\">\r\n                                    <TimeLine/>\r\n                                    </div>\r\n                </div>\r\n            </React.Fragment>\r\n         );\r\n    }\r\n}\r\n \r\nexport default UserPage;","import React, { Component } from 'react';\r\nimport firebase from \"firebase\";\r\n\r\nclass ChangeThings extends Component {\r\n    state = { \r\n        profilePic: \"\",\r\n        coverPic: \"\",\r\n        loading: \"\",\r\n        completed: false,\r\n        filesToUpload: 0,\r\n        uploadedFiles: 0,\r\n        profileLink: \"\",\r\n        coverLink: \"\",\r\n     }\r\n\r\n    profilePicHandler = (e) => {\r\n\r\n         const profilePicFile = e.target.files[0]\r\n\r\n         if (profilePicFile.type === \"image/png\" || profilePicFile.type === \"image/jpeg\" ){\r\n\r\n            if (profilePicFile.size > 1000000) {\r\n               window.alert(\"Please use a lower size image for the profile pic\")\r\n            } else {\r\n                 this.setState({\r\n                    profilePic: profilePicFile\r\n                })\r\n            }\r\n            \r\n         } else {\r\n             window.alert(\"Please use png or jpeg.\")\r\n             e.target.value = null;\r\n         }\r\n\r\n         \r\n     }\r\n\r\n    coverPicHandler = (e) => {\r\n        const coverPicFile = e.target.files[0]\r\n\r\n         if (coverPicFile.type === \"image/png\" || coverPicFile.type === \"image/jpeg\" ){\r\n            \r\n            if (coverPicFile.size > 1000000) {\r\n                window.alert(\"Please use a lower size image for the cover pic\")\r\n            } else {\r\n                this.setState({\r\n                    coverPic: coverPicFile\r\n                })\r\n            }\r\n            \r\n            \r\n         } else {\r\n             window.alert(\"Please use png or jpeg.\")\r\n             e.target.value = null;\r\n         }\r\n\r\n\r\n    }\r\n\r\n    //////////////////////////////////////////////////////////////////////////\r\n\r\n    upload = (e) => {\r\n        const profilePic = this.state.profilePic;\r\n        const coverPic = this.state.coverPic;   \r\n\r\n        const usersDB = firebase.database().ref().child(\"users\");\r\n\r\n        const email = firebase.auth().currentUser.email;\r\n        const profileStorageRef = firebase.storage().ref(`/${email}/profilepics/${profilePic.name}`)\r\n        const coverStorageRef = firebase.storage().ref(`/${email}/coverpics/${coverPic.name}`)\r\n        \r\n\r\n\r\n        if (typeof(this.state.profilePic) === \"object\" && typeof(this.state.coverPic) === \"object\"){\r\n\r\n            this.setState({filesToUpload: 2})\r\n            \r\n             profileStorageRef.put(profilePic).on(\"state_changed\",snapshot => {\r\n                let percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n                this.setState({loading: percentage})\r\n\r\n            }, error => {\r\n                console.log(error);  \r\n\r\n            }, () => {\r\n                //UPLOAD PROFILEPIC LINK\r\n                usersDB.once(\"value\", data => {\r\n                    const users = data.val();\r\n                    const keys = Object.keys(users);\r\n\r\n                    profileStorageRef.getDownloadURL().then((url) => {\r\n                        for (let i = 0; i < keys.length; i++){\r\n                            if (users[keys[i]][\"email\"] === email) {\r\n                                usersDB.child(users[keys[i]][\"id\"]).child(\"profilepic\").set(url)                             \r\n                                break;\r\n                            }\r\n                        }\r\n                    })\r\n\r\n                    \r\n                }).then(() => {\r\n                    this.setState({\r\n                        completed: false,\r\n                        loading: 0,\r\n                        uploadedFiles: 1,\r\n                    })                    \r\n                })\r\n\r\n                //UPLOAD COVERPIC LINK\r\n                coverStorageRef.put(coverPic).on(\"state_changed\",snapshot => {\r\n                    let percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n                    this.setState({loading: percentage})\r\n                }, error => {\r\n                    console.log(error);                \r\n                }, () => {\r\n                    usersDB.once(\"value\", data => {\r\n                        const users = data.val();\r\n                        const keys = Object.keys(users);\r\n    \r\n                        coverStorageRef.getDownloadURL().then((url) => {\r\n                            for (let i = 0; i < keys.length; i++){\r\n                                if (users[keys[i]][\"email\"] === email) {\r\n                                    usersDB.child(users[keys[i]][\"id\"]).child(\"coverpic\").set(url)                             \r\n                                    break;\r\n                                }\r\n                            }\r\n                        })\r\n    \r\n                        \r\n                    }).then(() => {\r\n                        this.setState({\r\n                            completed: true,\r\n                            loading: 0,\r\n                            uploadedFiles: 2,\r\n                        })\r\n                    })\r\n                })\r\n            } )\r\n        } else if (typeof(this.state.profilePic) === \"object\" && typeof(this.state.coverPic) === \"string\") {\r\n            \r\n            //UPLOAD ONLY PROFILEPIC\r\n            this.setState({filesToUpload: 1})\r\n\r\n            profileStorageRef.put(profilePic).on(\"state_changed\",snapshot => {\r\n                let percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n                this.setState({loading: percentage})\r\n            }, error => {\r\n                console.log(error);                \r\n            }, () => {\r\n\r\n\r\n                usersDB.once(\"value\", data => {\r\n                    const users = data.val();\r\n                    const keys = Object.keys(users);\r\n\r\n                    profileStorageRef.getDownloadURL().then((url) => {\r\n                        for (let i = 0; i < keys.length; i++){\r\n                            if (users[keys[i]][\"email\"] === email) {\r\n                                usersDB.child(users[keys[i]][\"id\"]).child(\"profilepic\").set(url)                             \r\n                                break;\r\n                            }\r\n                        }\r\n                    })\r\n\r\n                    \r\n                }).then(() => {\r\n                    this.setState({\r\n                        completed: true,\r\n                        loading: 0,\r\n                        uploadedFiles: 1,\r\n                    })\r\n                })\r\n\r\n            } )\r\n\r\n        } else {\r\n\r\n            //UPLOAD ONLY COVERPIC\r\n            this.setState({filesToUpload: 1})\r\n\r\n            coverStorageRef.put(coverPic).on(\"state_changed\",snapshot => {\r\n                let percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n                this.setState({loading: percentage})\r\n            }, error => {\r\n                console.log(error);                \r\n            }, () => {\r\n                usersDB.once(\"value\", data => {\r\n                    const users = data.val();\r\n                    const keys = Object.keys(users);\r\n\r\n                    coverStorageRef.getDownloadURL().then((url) => {\r\n                        for (let i = 0; i < keys.length; i++){\r\n                            if (users[keys[i]][\"email\"] === email) {\r\n                                usersDB.child(users[keys[i]][\"id\"]).child(\"coverpic\").set(url)                             \r\n                                break;\r\n                            }\r\n                        }\r\n                    })\r\n\r\n                    \r\n                }).then(() => {\r\n                    this.setState({\r\n                        completed: true,\r\n                        loading: 0,\r\n                        uploadedFiles: 1,\r\n                    })\r\n                })\r\n            })\r\n        }\r\n\r\n}\r\n\r\n    toggleSettings = () => {\r\n        this.props.toggleSettings();\r\n    }\r\n\r\n    render() { \r\n\r\n        \r\n\r\n        return ( \r\n            <div className=\"changeThings-container\">\r\n                <div className=\"changeThings-content\">\r\n                    <form >\r\n                    <h3>Change Profile Picture</h3>\r\n                    <input type=\"file\" onChange={this.profilePicHandler} className=\"upload-image\" name=\"profile-picture-file\"/>\r\n                    <h3>Change Big Profile Picture</h3>\r\n                    <input type=\"file\" onChange={this.coverPicHandler} className=\"upload-image\" name=\"profileBig-picture-file\"/>\r\n                    <div className=\"changeThings-buttons\">\r\n                        {this.state.loading > 0 ? <h3>Uploading... {this.state.uploadedFiles} of {this.state.filesToUpload} </h3> : null}\r\n                        {this.state.completed ? <h3>Image{\"(s)\"} uploaded.</h3> : null}\r\n                    <button type=\"button\" onClick={this.upload} className=\"upload-button\">Upload</button>\r\n                    \r\n                    <button type=\"button\" onClick={this.toggleSettings} className=\"close-button\">Close</button>\r\n                    </div>\r\n                    </form>\r\n                </div>   \r\n            </div>\r\n         );\r\n    }\r\n}\r\n \r\nexport default ChangeThings;","import React from 'react';\nimport firebase from \"firebase\";\nimport {BrowserRouter, Switch, Link, Route} from \"react-router-dom\"\nimport Header from './components/Header';\nimport TimeLine from './components/TimeLine';\nimport UserBox from './components/UserBox';\nimport LandingPage from './components/LandingPage';\nimport RegisterPopUp from './components/RegisterPopUp';\nimport LoggedLanding from './components/LoggedLanding';\nimport Loading from './components/Loading';\nimport UserPage from './components/UserPage';\nimport ChangeThings from './components/ChangeThings';\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyCbz4cCoC6aj2XaDIpqp4E7uKfUIuLkij0\",\n    authDomain: \"directorio-de-negocios-a257b.firebaseapp.com\",\n    databaseURL: \"https://directorio-de-negocios-a257b.firebaseio.com\",\n    projectId: \"directorio-de-negocios-a257b\",\n    storageBucket: \"directorio-de-negocios-a257b.appspot.com\",\n    messagingSenderId: \"156581943217\",\n    appId: \"1:156581943217:web:2838e8736b764738\"\n}\n\nfirebase.initializeApp(firebaseConfig);\n\nconst usersDB = firebase.database().ref().child(\"users\")\nconst tweetsDB = firebase.database().ref().child(\"tweets\")\n\nlet logged = false;\nlet loading = true;\nlet firstCheck = false;\nlet stateSetted = false;\n\nconst Extructura = {\n  \"id\" : \"rojolelo\",\n  \"firstName\" : \"Ronny\",\n  \"lastName\" : \"Legones\",\n  \"email\" : [\"otrocorreo@correo.com\"],\n  \"following\": [],\n   \"followers\" : []\n}\n\n\nexport default class App extends React.Component {\n\tstate= {\n    showPopUp: false,\n    loading: loading,\n  }\n  toggleRegisterPopUp = this.toggleRegisterPopUp.bind(this)\n  register = this.register.bind(this)\n  logIn = this.logIn.bind(this)\n  logOut = this.logOut.bind(this);\n\n  loadingFalse = () => {\n    this.setState({\n      loading:false\n    })\n  }\n\n  toggleRegisterPopUp(){\n    this.setState({\n      showPopUp: !this.state.showPopUp\n    })\n  }\n\n  logIn(email, password){\n    this.setState({loading: true})\n    firebase.auth().signInWithEmailAndPassword(email, password).catch(error => {\n      if (error.code === \"auth/invalid-email\"){\n        window.alert(\"The email address is badly formatted\")\n      } else if (error.code === \"auth/wrong-password\"){\n        window.alert(\"The password you entered is incorrect\")\n      } else if (error.code === \"auth/user-not-found\"){\n        window.alert(\"The user doesnt exist.\")\n      }\n    }).then(() => {\n      firebase.auth().onAuthStateChanged(user => {\n        if (user) {\n          logged = true;\n          this.setState({\n            loading:false\n          })\n        } else {\n          this.setState({loading:false})\n        }\n      })\n    })  \n  }\n\n  logOut(){\n    firebase.auth().signOut().then(()=>{\n      logged = false;\n      window.location.replace(\"/\")\n      this.setState({})\n  });\n  }\n  \n  register(userData){{\n    console.log(userData)\n\n    const {name, userId, email, password} = userData;\n\n\n    const newUser = {\n      \"id\" : userId,\n      \"firstName\" : name,\n      \"email\" : email,\n      \"following\": [],\n       \"followers\" : []\n    }\n\n    var userCredential = firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {\n      // Handle Errors here.\n      console.log(error.code);\n      console.log(error.message);\n      // ...\n    }).then(result => {\n      if (result) {\n        usersDB.child(userId).update(newUser)        \n      }\n      console.log(\"user in db\")\n\n      firebase.auth().signInWithEmailAndPassword(email, password).catch(error => {\n        console.log(error)\n      }).then(result => {\n        window.location.reload()\n      })  \n    })\n    \n  }}\n\n  toggleSettings = () => {\n    this.setState({\n      toggleSettings: !this.state.toggleSettings\n    })\n  }\n\n  renderLogged() {\n    return (\n      <BrowserRouter basename={process.env.PUBLIC_URL}>\n\n                <Route exact path={\"/tweet/:id\"} render={() => {\n                  const id = window.location.pathname.replace(\"/tweet/\", \"\")\n                    return (\n                      <React.Fragment>\n                        <Header logOut={this.logOut} toggleSettings={this.toggleSettings}/>\n\n                        {this.state.toggleSettings ? <ChangeThings toggleSettings={this.toggleSettings}/> : null}\n                    \n                        <LoggedLanding key={id}/>\n                      </React.Fragment>\n                  )\n                }}/>\n                \n                <Route exact path={\"/:id\"} render={() => {\n                    const id = window.location.pathname.replace(\"/\", \"\")\n                    return (\n                      <React.Fragment>\n                        <Header logOut={this.logOut} key={id} toggleSettings={this.toggleSettings}/>\n                    \n                        {this.state.toggleSettings ? <ChangeThings toggleSettings={this.toggleSettings}/> : null}\n\n                        <UserPage key={id} id={id}/>\n                      </React.Fragment>\n                  )\n                }}/>\n                \n                <Route exact path={\"/\"} render={() => {\n                    return (\n                      <React.Fragment>\n                        <Header logOut={this.logOut} toggleSettings={this.toggleSettings}/>\n\n                        {this.state.toggleSettings ? <ChangeThings toggleSettings={this.toggleSettings}/> : null}\n                    \n                        <LoggedLanding/>\n                      </React.Fragment>\n                  )\n                }}/>\n        </BrowserRouter>\n    )\n  }\n \n  renderNoLogged(){\n    return (\n        <BrowserRouter basename={process.env.PUBLIC_URL}>\n            <Route exact path={\"/:id\"} render={() => {\n                    const id = window.location.pathname.replace(\"/\", \"\")\n                    return (\n                      <React.Fragment key={id}>\n                        <Header logOut={this.logOut}/>\n                    \n                      \n                        <UserPage key={id}/>\n                      </React.Fragment>\n                  )\n                }}/>  \n\n            <Route exact path={\"/\"} render={() => {\n                return (\n                  <React.Fragment>\n                  {this.state.showPopUp ? <RegisterPopUp toggleRegisterPopUp={this.toggleRegisterPopUp} register={this.register} /> : null}\n                  {this.state.loading ? <Loading/> : null}\n                  <LandingPage \n                  logIn={this.logIn}\n                  toggleRegisterPopUp={this.toggleRegisterPopUp}/>                  \n                  </React.Fragment>\n                )\n            }}/>\n        </BrowserRouter>\n        )\n  }\n  \n\n\trender() {\n\n// Loading for checking already Logged user    \n      if (!firstCheck) {\n        firebase.auth().onAuthStateChanged(function(user) {        \n          if (user) {\n            firstCheck = true;  \n            logged=true;\n            loading = false;              \n\n          } else {\n            loading = false;\n            firstCheck = true;            \n          }\n        });        \n      } \n\n        var interval = setInterval( x => {\n          if (stateSetted === false && firstCheck) {\n            stateSetted = true;\n            this.setState({\n              loading: false\n            })\n          }\n        }, 2000)\n///////////////////////////////////////////////////      \n\n      \n\n        \n        if (logged) {          \n          return (\n            <React.Fragment>\n              {this.renderLogged()}\n            </React.Fragment>\n          )\n        } else {\n          return (\n            <React.Fragment>\n              {this.renderNoLogged()}\n            </React.Fragment>\n          )\n        } \n\t}\n}\n\n\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}