(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,a){e.exports=a(269)},117:function(e,t,a){},269:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(108),r=a.n(o),l=(a(117),a(4)),c=a(5),s=a(7),u=a(6),d=a(9),h=a(8),f=a(2),m=a.n(f),g=a(11),p=a(25),w=a(45),v=function(e){var t;return t=e.result.profilepic?e.result.profilepic:"https://cdn.britannica.com/67/197567-131-1645A26E.jpg",i.a.createElement(g.b,{to:e.result.id},i.a.createElement("div",{className:"search-result-container"},i.a.createElement("img",{id:"search-picture",src:t}),i.a.createElement("span",{className:"search-result-name"},e.result.firstName),i.a.createElement("span",{className:"search-result-id"},"@",e.result.id)))},b=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(this.props.search.length<1)return null;if(""===this.props.searchState)return null;var e=this.props.search;return i.a.createElement("div",{className:"search-container-container"},e.map(function(e,t){return i.a.createElement(v,{key:t,result:e})}),i.a.createElement("div",{className:"search-result-container"},i.a.createElement("h5",{className:"search-result-name"},"Search for more...")))}}]),t}(n.Component),E=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={},a.seenNotification=a.seenNotification.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"seenNotification",value:function(){console.log("seenotification"),this.props.seenNotification(this.props.notification)}},{key:"render",value:function(){var e,t=this.props.notification,a=Boolean(t[4]),n="",o=t[0];return"follow"===t[3]?n="is following you.":"like"===t[3]?n="liked you tweet.":"retweet"===t[3]?n="has retweeted your tweet.":"mention"===t[3]&&(n="has mentioned you in a tweet."),e=t[2]?"seen":"unseen",i.a.createElement(i.a.Fragment,null,a?i.a.createElement("div",{className:"notification-container ".concat(e),onClick:this.seenNotification},i.a.createElement("p",{className:"notification-text"},i.a.createElement(g.b,{to:o},i.a.createElement("span",{className:"notification-user"},"@",o," ")),i.a.createElement(g.b,{to:"/tweet/".concat(t[4])},n))):i.a.createElement("div",{className:"notification-container ".concat(e),onClick:this.seenNotification},i.a.createElement("p",{className:"notification-text"},i.a.createElement(g.b,{to:o},i.a.createElement("span",{className:"notification-user"},"@",o," ")),n)))}}]),t}(n.Component),y=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={},a.seenNotification=function(e){var t=m.a.database().ref().child("users"),a=m.a.auth().currentUser.email,n=[],i="";t.once("value",function(t){for(var o=t.val(),r=Object.keys(o),l=0;l<r.length;l++)if(a==o[r[l]].email){n=o[r[l]].notifications,i=o[r[l]].id;break}for(var c=0;c<n.length;c++)if(e[0]===n[c][0]&&e[1]===n[c][1]&&e[2]===n[c][2]&&e[3]===n[c][3]){n[c][2]=1;break}}).then(function(){t.child(i).child("notifications").set(n)})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return this.props.notifications?0===this.props.notifications.length?i.a.createElement("div",{className:"notifications-container"},i.a.createElement("p",null,"There are not notifications to show.")):i.a.createElement("div",{className:"notifications-container"},this.props.notifications.map(function(t,a){return i.a.createElement(E,{notification:t,seenNotification:e.seenNotification,key:a})})):i.a.createElement("div",{className:"notifications-container"},i.a.createElement("p",null,"There are not notifications to show."))}}]),t}(n.Component),k=[],N=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={search:"",searchResult:[],profilepic:"https://cdn.britannica.com/67/197567-131-1645A26E.jpg",notifications:[],unseenNotifications:0,showNotifications:!1},a.refSearch=i.a.createRef(),a.Logout=a.Logout.bind(Object(d.a)(a)),a.search=a.search.bind(Object(d.a)(a)),a.LogIn=a.LogIn.bind(Object(d.a)(a)),a.toggleSettings=function(){a.props.toggleSettings()},a.toggleNotifications=function(){a.setState({showNotifications:!a.state.showNotifications})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"LogIn",value:function(){window.location.replace("/twitter-clone/")}},{key:"componentDidMount",value:function(){var e=this;m.a.auth().onAuthStateChanged(function(t){if(t){var a=m.a.auth().currentUser.email,n=m.a.database().ref().child("users"),i=!1,o="";n.once("value",function(e){for(var t=e.val(),n=Object.keys(t),r=0;r<n.length;r++)if(t[n[r]].email===a&&(i=t[n[r]].id,t[n[r]].profilepic)){o=t[n[r]].profilepic;break}}).then(function(){i&&n.child(i).child("notifications").on("value",function(t){var a=t.val(),n=0;if(!a)return null;for(var i=0;i<a.length;i++)0===a[i][2]&&n++;console.log(a),e.setState({unseenNotifications:n,notifications:t.val()})}),o.length>0?e.setState({profilepic:o,logged:!0}):e.setState({logged:!0})})}})}},{key:"search",value:function(){var e=this,t=[];k=[];var a=m.a.database().ref().child("users"),n=new RegExp(this.refSearch.current.value,"i");if(""===this.refSearch.current.value)return this.setState({search:""}),null;a.once("value",function(e){for(var t=e.val(),a=Object.keys(t),i=0,o=0;o<a.length;o++){if(i>5)return null;(n.test(t[a[o]].id)||n.test(t[a[o]].firstName))&&(k.push(t[a[o]]),i++)}}).then(function(a){t=Object(w.a)(new Set(k)),e.setState({searchResult:t,search:e.refSearch.current.value})})}},{key:"Logout",value:function(){this.props.logOut()}},{key:"render",value:function(){var e,t;this.state.searchResult.length>0&&(this.state.searchResult=(e=this.state.searchResult,t="id",e.map(function(e){return e[t]}).map(function(e,t,a){return a.indexOf(e)===t&&t}).filter(function(t){return e[t]}).map(function(t){return e[t]})));var a;this.state.notifications&&(a=this.state.notifications.sort(function(e,t){var a=new Date(e[1]).getTime();return new Date(t[1]).getTime()-a}).slice(0,9));return this.state.logged?i.a.createElement("div",{className:"header-container"},i.a.createElement("div",{className:"header-left"},i.a.createElement(g.b,{to:"/"},i.a.createElement("h3",{className:"header-button"},"Home")),i.a.createElement("h3",{className:"header-button",onClick:this.toggleNotifications},"Notifications"),this.state.unseenNotifications>0?i.a.createElement("span",{className:"header-notification-number"},this.state.unseenNotifications):null,this.state.showNotifications?i.a.createElement(y,{notifications:a}):null,i.a.createElement("h3",{className:"header-button disabled-button"},"Messages")),i.a.createElement("div",{className:"header-mid"},i.a.createElement("h3",{id:"header-logo"},"Logo")),i.a.createElement("div",{className:"header-right"},i.a.createElement("input",{onChange:this.search,ref:this.refSearch,type:"text",id:"header-search",placeholder:"Search..."}),i.a.createElement(b,{search:this.state.searchResult,searchState:this.state.search}),i.a.createElement("img",{id:"header-profile-picture",onClick:this.toggleSettings,src:this.state.profilepic}),i.a.createElement("button",{id:"header-logout",onClick:this.Logout},"Log Out"))):i.a.createElement("div",{className:"header-container"},i.a.createElement("div",{className:"header-left"},i.a.createElement("h3",{className:"header-button header-logout"},"Home"),i.a.createElement("h3",{className:"header-button header-logout"},"Notifications"),i.a.createElement("h3",{className:"header-button header-logout"},"Messages")),i.a.createElement("div",{className:"header-mid"},i.a.createElement("h3",{id:"header-logo"},"Logo")),i.a.createElement("div",{className:"header-right"},i.a.createElement("input",{onChange:this.search,ref:this.refSearch,type:"text",id:"header-search",placeholder:"Search..."}),i.a.createElement(b,{search:this.state.searchResult,searchState:this.state.search}),i.a.createElement("img",{id:"header-profile-picture",src:"https://d1nhio0ox7pgb.cloudfront.net/_img/o_collection_png/green_dark_grey/512x512/plain/user.png"}),i.a.createElement("button",{id:"header-logout",onClick:this.LogIn},"Log In")))}}]),t}(n.Component),O=a(17),j=a(15),S=(a(133),a(34)),B=a.n(S),x=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={name:"",user:"",profilepic:!1,message:"",likes:[],likesNumber:"",retweets:"",retweetedBy:"",retweetedByNumber:"",date:"",showTime:"",tweetId:"",likedByLogged:!1,showRetweetedBy:!1,matchingRetweeted:"",loggedUser:"0",deleted:!1},a.like=function(){var e;if(!m.a.auth().currentUser)return null;e=m.a.auth().currentUser.email;var t=m.a.database().ref().child("tweets").child(a.state.tweetId).child("likes"),n=m.a.database().ref().child("users"),i="",o=[],r=[],l=[];if(!Boolean(e))return null;n.once("value",function(t){for(var n=t.val(),o=Object.keys(n),c=0;c<o.length;c++)e===n[o[c]].email&&(i=n[o[c]].id,l[0]=n[o[c]].id),a.state.user===n[o[c]].id&&(r=n[o[c]].notifications);l[1]=(new Date).toISOString(),l[2]=0,l[3]="like",l[4]=a.state.tweetId,r?r.push(l):r=[l]}).then(function(){t.once("value",function(e){(o=e.val())?o.push(i):o=[i]}).then(function(e){t.set(o),l[0]!==a.state.user&&n.child(a.state.user).child("notifications").set(r),a.setState({likedByLogged:!0,likesNumber:a.state.likesNumber+1})})})},a.dislike=function(){var e;if(!m.a.auth().currentUser)return null;e=m.a.auth().currentUser.email;var t=[],n=m.a.database().ref().child("tweets").child(a.state.tweetId).child("likes"),i=m.a.database().ref().child("users"),o="",r=[];i.once("value",function(n){for(var r=n.val(),l=Object.keys(r),c=0;c<l.length;c++)e===r[l[c]].email&&(o=r[l[c]].id),a.state.user===r[l[c]].id&&(t=r[l[c]].notifications);t=t?1===t.length?[]:t.filter(function(e){return!(e[0]===o&&e[4]===a.state.tweetId)}):[],o!==a.state.user&&i.child(a.state.user).child("notifications").set(t)}).then(function(){n.once("value",function(e){r=1===(r=e.val()).length?[]:r.filter(function(e){return e!==o})}).then(function(e){n.set(r),a.setState({likedByLogged:!1,likesNumber:a.state.likesNumber-1})})})},a.retweet=function(){var e;if(!m.a.auth().currentUser)return null;e=m.a.auth().currentUser.email;var t=m.a.database().ref().child("users"),n=m.a.database().ref().child("tweets").child(a.state.tweetId).child("retweetedBy"),i="",o=[],r=[];B.a.fire({title:"Wanna retweet this?",type:"info",showCancelButton:!0,confirmButtonColor:"#1da1f2",cancelButtonColor:"#d33",confirmButtonText:"Yes, Retweet"}).then(function(l){l.value&&t.once("value",function(t){for(var n=t.val(),l=Object.keys(n),c=0,s=0;s<l.length&&2!==c;s++)n[l[s]].email===e&&(i=n[l[s]].id,r[0]=n[l[s]].id,c++),n[l[s]].id===a.state.user&&(o=n[l[s]].notifications,c++);r[1]=(new Date).toISOString(),r[2]=0,r[3]="retweet",r[4]=a.state.tweetId,o?o.push(r):o=[r]}).then(function(e){n.once("value",function(e){var r=e.val(),l=(new Date).toISOString(),c=[i,l];r?r.push(c):r=[c],n.set(r),t.child(a.state.user).child("notifications").set(o)}).then(function(e){B.a.fire("Retweeted!","","success"),a.setState({retweetedByNumber:a.state.retweetedByNumber+1})})})})},a.deleteTweet=function(){var e=m.a.database().ref().child("users"),t=m.a.database().ref().child("tweets"),n=!1;B.a.fire({title:"Are you sure?",text:"You won't be able to revert this",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(function(i){i.value&&e.once("value",function(e){for(var i=e.val(),o=Object.keys(i),r=0;r<o.length;r++)if(a.state.loggedUser===i[o[r]].id){n=!0;break}if(0==n)return null;t.child(a.state.tweetId).set(null)}).then(function(){a.setState({deleted:!0}),B.a.fire("Deleted!","Your tweet has been deleted.","success")})})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e,t=this,a=this.props.tweet,n=a.name,o=a.user,r=a.message,l=a.likes,c=a.retweets,s=a.retweetedBy,u=a.date,d=a.tweetId,h=a.likesNumber,f=a.retweetedByNumber,p=a.showRetweetedBy,w=a.matchingRetweeted,v=!1,b=[],E=r.match(/@\w+/g),y={},k=m.a.database().ref().child("tweets").child(d).child("likes"),N=m.a.database().ref().child("users");m.a.auth().currentUser&&(e=m.a.auth().currentUser.email);var O="",j=new Date(u),S=(new Date-j)/1e3,B="",x=!1;S<61?B="".concat(Math.floor(S)," seconds ago"):S<3600?(S=Math.floor(S/60),B="".concat(S," minutes ago"),1===S&&(B="".concat(S," minute ago"))):S<86400?(S=Math.floor(S/3600),B="".concat(S," hours ago"),1===S&&(B="".concat(S," hour ago"))):S<604800?(S=Math.floor(S/86400),B="".concat(S," days ago"),1===S&&(B="".concat(S," day ago"))):S<2419200?(S=Math.floor(S/604800),B="".concat(S," weeks ago"),1===S&&(B="".concat(S," week ago"))):S<29030400?(S=Math.floor(S/2419200),B="".concat(S," months ago"),1===S&&(B="".concat(S," month ago"))):(S=Math.floor(S/29030400),B="".concat(S," years ago"),1===S&&(B="".concat(S," year ago"))),N.once("value",function(t){for(var a=t.val(),n=Object.keys(a),l=0;l<n.length;l++)if(e===a[n[l]].email&&(O=a[n[l]].id,0),o===a[n[l]].id&&(a[n[l]].profilepic?(v=a[n[l]].profilepic,0):(v="https://cdn.britannica.com/67/197567-131-1645A26E.jpg",0)),E)for(var c=0;c<E.length;c++)E[c].replace("@","")==a[n[l]].id&&(y[E[c].replace("@","")]=1);for(var s=r.split(" "),u=0;u<s.length;u++)"@"==s[u][0]&&y.hasOwnProperty(s[u].replace("@",""))?(b.push(i.a.createElement(i.a.Fragment,null,i.a.createElement(g.b,{to:s[u].replace("@","")},i.a.createElement("span",{className:"mention-user"},s[u])))),b.push(" ")):(b.push(s[u]),b.push(" "))}).then(function(e){k.once("value",function(e){var t=e.val();if(!t)return null;for(var a=0;a<t.length;a++)t[a]===O&&(x=!0)}).then(function(e){t.setState({name:n,user:o,message:b,likes:l,retweets:c,retweetedBy:s,date:u,showTime:B,tweetId:d,likedByLogged:x,likesNumber:h,retweetedByNumber:f,showRetweetedBy:p,matchingRetweeted:w,profilepic:v,loggedUser:O,updated:!0})})})}},{key:"render",value:function(){return this.state.deleted?null:(e=this.state.profilepic?this.state.profilepic:"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812",i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"Contenedor"},this.state.showRetweetedBy?i.a.createElement("div",{className:"retweetedBy"},i.a.createElement(O.a,{icon:j.d})," ",i.a.createElement("span",null,"Retweet by ",this.state.matchingRetweeted[this.state.matchingRetweeted.length-1][0])):null,i.a.createElement("div",{className:"tweet-container"},i.a.createElement("div",{className:"tweet-picture"},i.a.createElement("img",{id:"tweet-picture",src:e})),i.a.createElement("div",{className:"tweet-inside-container"},i.a.createElement("div",{className:"tweet-top"},i.a.createElement(g.b,{to:"/".concat(this.state.user)},i.a.createElement("span",{className:"tweet-userName"},this.state.name," ")),i.a.createElement(g.b,{to:"/".concat(this.state.user)},i.a.createElement("span",{className:"tweet-userId"},"@",this.state.user)),i.a.createElement("span",{className:"tweet-date"},this.state.showTime)),i.a.createElement("div",{className:"tweet-mid"},i.a.createElement("div",{className:"tweet-mid-message"},this.state.message.length?this.state.message.map(function(e){return e}):null)),i.a.createElement("div",{className:"tweet-bot"},i.a.createElement("div",{className:"tweet-bot-icon"},i.a.createElement(O.a,{id:"react-icon",icon:j.a})),i.a.createElement("div",{className:"tweet-bot-icon"},i.a.createElement(O.a,{id:"react-icon",onClick:this.retweet,icon:j.d}),this.state.retweetedByNumber>0?i.a.createElement("span",null,this.state.retweetedByNumber):null),i.a.createElement("div",{className:"tweet-bot-icon"},this.state.likedByLogged?i.a.createElement(O.a,{id:"react-icon",className:"liked-heart",icon:j.b,onClick:this.dislike}):i.a.createElement(O.a,{id:"react-icon",icon:j.b,onClick:this.like}),this.state.likesNumber>0?i.a.createElement("span",null,this.state.likesNumber):null),i.a.createElement("div",{className:"tweet-bot-icon"},this.state.loggedUser==this.state.user?i.a.createElement(O.a,{id:"react-icon",onClick:this.deleteTweet,icon:j.f}):null)))))));var e}}]),t}(i.a.Component),U={},C=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={tweet:"",profilepic:!1,mentions:[]},a.refTweetText=i.a.createRef(),a.sendTweet=a.sendTweet.bind(Object(d.a)(a)),a.writeTweet=a.writeTweet.bind(Object(d.a)(a)),a.cleanState=a.cleanState.bind(Object(d.a)(a)),a.checkMention=function(){var e=/@\w+/g;if(!a.state.tweet.match(e))return null;for(var t=a.state.tweet.match(e),n=0;n<t.length;n++)t[n]=t[n].replace("@","");return t},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=m.a.database().ref().child("users"),a=m.a.auth().currentUser.email,n=!1;t.once("value",function(e){for(var t=e.val(),i=Object.keys(t),o=0;o<i.length;o++)a===t[i[o]].email&&(n=t[i[o]].profilepic?t[i[o]].profilepic:"https://cdn.britannica.com/67/197567-131-1645A26E.jpg")}).then(function(){e.setState({profilepic:n})})}},{key:"cleanState",value:function(e,t){this.props.refreshRender(e,t),this.setState({tweet:""})}},{key:"writeTweet",value:function(){this.setState({tweet:this.refTweetText.current.value})}},{key:"sendTweet",value:function(){var e=this,t=this.state.tweet,a=this.checkMention(),n=[],i={},o=[];if(0===t.length)return null;console.log(a);var r=m.a.auth().currentUser.email,l=m.a.database().ref().child("tweets"),c=m.a.database().ref().child("users");c.once("value",function(e){for(var t=e.val(),n=Object.keys(t),o=0;o<n.length;o++)if(r===t[n[o]].email&&(U.email=r,U.name=t[n[o]].firstName,U.userId=t[n[o]].id),a)for(var l=0;l<a.length;l++)a[l]===t[n[o]].id&&(i[t[n[o]].id]=t[n[o]].notifications);console.log(i)}).then(function(s){var u={date:(new Date).toISOString(),email:r,message:t,name:U.name,user:U.userId},d=l.push().key;if(u.tweetId=d,l.child(d).update(u),a)for(var h=0;h<a.length;h++)n[0]=a[h],n[1]=(new Date).toISOString(),n[2]=0,n[3]="mention",n[4]=d,(o=i[a[h]])?o.push(n):o=[n],console.log(i.hasOwnProperty(n[0])),U.userId!==n[0]&&i.hasOwnProperty(n[0])&&c.child(n[0]).child("notifications").set(o);e.cleanState(u,d)})}},{key:"render",value:function(){var e;return e=this.state.profilepic?this.state.profilepic:"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812",i.a.createElement("div",{className:"write-container"},i.a.createElement("div",{className:"write-picture-container"},i.a.createElement("img",{id:"write-profile-picture",src:e})),i.a.createElement("div",{className:"write-input-container"},i.a.createElement("textarea",{ref:this.refTweetText,onChange:this.writeTweet,value:this.state.tweet,maxLength:"250",className:"write-input",type:"text",placeholder:"What's happening?"}),i.a.createElement("div",{className:"write-bottom-container"},i.a.createElement("button",{type:"button",className:"write-tweet",onClick:this.sendTweet},"Tweet"))))}}]),t}(n.Component),R=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={loading:!1,following:[],userPage:!0,tweetsToShow:[],updated:!1,pageChanged:!1,userData:{},newTweets:[]},a.refreshRender=a.refreshRender.bind(Object(d.a)(a)),a.searchTweets=a.searchTweets.bind(Object(d.a)(a)),a.matchUsers=a.matchUsers.bind(Object(d.a)(a)),a.matchUsersRetweet=a.matchUsersRetweet.bind(Object(d.a)(a)),a.reRender=a.reRender.bind(Object(d.a)(a)),a.searchOneTweet=a.searchOneTweet.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=new RegExp("/tweet"),t=window.location.pathname;e.test(t)?this.searchOneTweet():this.searchTweets()}},{key:"reRender",value:function(e,t){this.setState({tweetsToShow:e,updated:!0,pageChanged:!1,userPage:t})}},{key:"refreshRender",value:function(e,t){this.setState({newTweets:[e].concat(Object(w.a)(this.state.newTweets))})}},{key:"searchOneTweet",value:function(){var e=this,t=window.location.pathname.replace("/tweet/",""),a=[],n={},i=m.a.database().ref().child("tweets"),o=m.a.database().ref().child("users");i.once("value",function(e){for(var i,o=e.val(),r=Object.keys(o),l=0,c=0;c<r.length&&1!==l;c++)i=!1,o[r[c]].tweetId===t&&(i=!0,l++,n.id=o[r[c]].user,o[r[c]].likes?o[r[c]].likesNumber=o[r[c]].likes.length:o[r[c]].likesNumber=0,o[r[c]].retweetedBy&&(o[r[c]].retweetedByNumber=o[r[c]].retweetedBy.length),o[r[c]].orderingDate=o[r[c]].date,o[r[c]].showRetweetedBy=!1),i&&a.push(o[r[c]])},function(e){console.log(e)}).then(function(){o.once("value",function(e){var a=e.val(),i=Object.keys(a);n.userPage=!0;for(var o=0;o<i.length;o++)n.id===a[i[o]].id&&(n.email=a[i[o]].email,n.name=a[i[o]].firstName,n.following=[t])}).then(function(t){e.reRender(a,n.userPage)})})}},{key:"searchTweets",value:function(){var e=this,t=[],a={},n=m.a.database().ref().child("tweets");m.a.database().ref().child("users").once("value",function(e){var t,n=e.val(),i=Object.keys(n),o=window.location.pathname.replace("/twitter-clone/","");if(a.userPage=o.length>1,a.userPage||(t=m.a.auth().currentUser.email),a.userPage)for(var r=0;r<i.length;r++)o===n[i[r]].id&&(a.email=n[i[r]].email,a.name=n[i[r]].firstName,a.id=n[i[r]].id,a.following=[o]);else for(var l=0;l<i.length;l++)t===n[i[l]].email&&(a.email=n[i[l]].email,a.name=n[i[l]].firstName,a.id=n[i[l]].id,a.following=n[i[l]].following);"undefined"===typeof a.following?a.following=[a.id]:a.following.push(a.id)}).then(function(i){n.once("value",function(n){for(var i,o=n.val(),r=Object.keys(o),l=0;l<r.length;l++){if(i=!1,e.matchUsers(a.following,o[r[l]].user)&&(i=!0,o[r[l]].likes?o[r[l]].likesNumber=o[r[l]].likes.length:o[r[l]].likesNumber=0,o[r[l]].retweetedBy&&(o[r[l]].retweetedByNumber=o[r[l]].retweetedBy.length),o[r[l]].orderingDate=o[r[l]].date,o[r[l]].showRetweetedBy=!1),e.matchUsersRetweet(a.following,o[r[l]].retweetedBy)){i=!0,o[r[l]].likes?o[r[l]].likesNumber=o[r[l]].likes.length:o[r[l]].likesNumber=0,o[r[l]].retweetedBy&&(o[r[l]].retweetedByNumber=o[r[l]].retweetedBy.length);var c=e.matchUsersRetweet(a.following,o[r[l]].retweetedBy);o[r[l]].matchingRetweeted=c,o[r[l]].orderingDate=c[c.length-1][1],o[r[l]].showRetweetedBy=!0}i&&(t.push(o[r[l]]),0)}},function(e){console.log(e)}).then(function(n){e.reRender(t,a.userPage)})})}},{key:"matchUsers",value:function(e,t){return"string"===typeof e&&(e=[e]),Boolean(e.find(function(e){return e===t}))}},{key:"matchUsersRetweet",value:function(e,t){if(!t)return!1;for(var a=[],n=function(n){e.find(function(e){return e===t[n][0]})&&a.push(t[n])},i=0;i<t.length;i++)n(i);return 0!==a.length&&a}},{key:"render",value:function(){var e=this.state.tweetsToShow.sort(function(e,t){var a=new Date(e.orderingDate).getTime();return new Date(t.orderingDate).getTime()-a});console.log("showing",e);var t=this.state.newTweets;return i.a.createElement("div",{className:"timeLine-container"},this.state.userPage?null:i.a.createElement(C,{refreshRender:this.refreshRender}),t.map(function(e,t){return console.log("sending",e),i.a.createElement(x,{key:e.tweetId,tweet:e})}),e.map(function(e,t){return console.log("sending",e),i.a.createElement(x,{key:t,tweet:e})}))}}]),t}(i.a.Component),T=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={name:"",id:"",following:"",followers:"",tweetCount:"",profilepic:!1,coverpic:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=m.a.database().ref().child("users"),a=m.a.database().ref().child("tweets"),n=m.a.auth().currentUser.email;function i(e){return"undefined"===typeof e?0:e.length}var o="",r="",l="",c="",s=0,u=!1,d=!1;t.once("value",function(e){for(var t=e.val(),a=Object.keys(t),s=0;s<a.length;s++)if(n===t[a[s]].email){o=t[a[s]].firstName,r=t[a[s]].id,l=i(t[a[s]].following),c=i(t[a[s]].followers),u=t[a[s]].profilepic,d=t[a[s]].coverpic;break}}).then(function(t){a.once("value",function(e){for(var t=e.val(),a=Object.keys(t),i=0;i<a.length;i++)n===t[a[i]].email&&s++}).then(function(t){u||(u="https://cdn.britannica.com/67/197567-131-1645A26E.jpg"),d||(d="https://images.unsplash.com/photo-1518791841217-8f162f1e1131?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80"),e.setState({name:o,id:r,following:l,followers:c,tweetCount:s,profilepic:u,coverpic:d})})})}},{key:"render",value:function(){var e;e=this.state.coverpic?this.state.coverpic:"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812";var t={height:"95px",width:"100%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url(".concat(e,")")};return i.a.createElement("div",{className:"userBox-container"},i.a.createElement("div",{className:"userBox-background",style:t}),i.a.createElement("div",{className:"userBox-content"},i.a.createElement("div",{className:"userBox-content-top"},i.a.createElement("div",{className:"userBox-content-picture"},i.a.createElement("picture",null,this.state.profilepic?i.a.createElement("img",{id:"profile-picture",src:this.state.profilepic}):i.a.createElement("img",{id:"profile-picture",src:"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812"}))),i.a.createElement("div",{className:"userBox-content-right"},i.a.createElement(g.b,{to:"".concat(this.state.id)},i.a.createElement("div",{id:"userBox-name",className:"userBox-content-name"},this.state.name),i.a.createElement("div",{id:"userBox-userId",className:"userBox-content-userId"},"@",this.state.id)))),i.a.createElement("div",{className:"userBox-content-information"},i.a.createElement(g.b,{to:""},i.a.createElement("div",{className:"userBox-content-tweets"},i.a.createElement("h5",{id:"userBox-information"},"Tweets"),i.a.createElement("h5",{id:"userBox-number"},this.state.tweetCount," "))),i.a.createElement(g.b,{to:""},i.a.createElement("div",{className:"userBox-content-following"},i.a.createElement("h5",{id:"userBox-information"},"Following"),i.a.createElement("h5",{id:"userBox-number"},this.state.following," "))," "),i.a.createElement(g.b,{to:""},i.a.createElement("div",{className:"userBox-content-followers"},i.a.createElement("h5",{id:"userBox-information"},"Followers"),i.a.createElement("h5",{id:"userBox-number"},this.state.followers," "))))))}}]),t}(n.Component),P=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).logIn=a.logIn.bind(Object(d.a)(a)),a.emailRef=i.a.createRef(),a.passwordRef=i.a.createRef(),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"logIn",value:function(e){e.preventDefault();var t=this.emailRef.current.value,a=this.passwordRef.current.value;this.props.logIn(t,a)}},{key:"render",value:function(){return i.a.createElement("div",{className:"landing-page-container"},i.a.createElement("div",{className:"landing-page-left"},i.a.createElement("div",{className:"landing-page-left-text-container"},i.a.createElement("div",{className:"landing-page-left-1 landing-page-left-text"},i.a.createElement("h3",null,i.a.createElement(O.a,{icon:j.e}),"    Twitter Clone")),i.a.createElement("div",{className:"landing-page-left-2 landing-page-left-text"},i.a.createElement("h3",null,i.a.createElement(O.a,{icon:j.c}),"    Made by:")),i.a.createElement("div",{className:"landing-page-left-3 landing-page-left-text"},i.a.createElement("h3",null,i.a.createElement(O.a,{icon:j.a}),"    Ronny Legones")))),i.a.createElement("div",{className:"landing-page-right"},i.a.createElement("div",{className:"landing-page-login"},i.a.createElement("form",{onSubmit:this.logIn},i.a.createElement("input",{className:"login-input",ref:this.emailRef,type:"text",placeholder:"Email or Username"}),i.a.createElement("input",{className:"login-input",ref:this.passwordRef,type:"password",placeholder:"Password"}),i.a.createElement("button",{className:"login-btn",type:"submit"},"Login")),i.a.createElement("p",{className:"login-forgot"},"Forgot your password?")),i.a.createElement("div",{className:"landing-page-right-text-container"},i.a.createElement("div",{className:"landing-page-right-box"},i.a.createElement("div",{className:"landing-page-right-box-text"},i.a.createElement(O.a,{icon:j.e}),i.a.createElement("h3",{id:"hola"},"    Discover what is happening at this moment.")),i.a.createElement("div",{className:"landing-page-right-box-join"},i.a.createElement("h3",{className:"join-twitter"},"Join Twitter today."),i.a.createElement("div",{className:"landing-page-btn-signup",onClick:this.props.toggleRegisterPopUp},"Sign Up"),i.a.createElement("div",{className:"landing-page-btn-login"},"Login"))))),i.a.createElement("div",{className:"landing-page-footer"}))}}]),t}(i.a.Component),I=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).register=a.register.bind(Object(d.a)(a)),a.refName=i.a.createRef(),a.refEmail=i.a.createRef(),a.refPassword=i.a.createRef(),a.refUserId=i.a.createRef(),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"register",value:function(e){e.preventDefault();var t=this.refName.current.value,a=this.refUserId.current.value,n=this.refEmail.current.value,i=this.refPassword.current.value;if(t.length<2)return window.alert("Your name is too short."),null;if(a.length<4)return window.alert("Your user id is too short."),null;if(n.length<5)return window.alert("Your email is too short"),null;if(i<4)return window.alert("Your password is too short."),null;var o={name:t,email:n,password:i,userId:a};this.props.register(o)}},{key:"render",value:function(){return i.a.createElement("div",{className:"register-popup-container"},i.a.createElement("div",{className:"register-popup-inner"},i.a.createElement("h1",null,"Register"),i.a.createElement("form",{onSubmit:this.register},i.a.createElement("div",null,i.a.createElement("label",null,"Name:"),i.a.createElement("input",{type:"text",maxLength:20,placeholder:"your name",ref:this.refName})),i.a.createElement("div",null,i.a.createElement("label",null,"User ID:"),i.a.createElement("input",{type:"text",maxLength:15,placeholder:"your id",ref:this.refUserId})),i.a.createElement("div",null,i.a.createElement("label",null,"E-mail:"),i.a.createElement("input",{type:"email",maxLength:30,placeholder:"your email",ref:this.refEmail})),i.a.createElement("div",null,i.a.createElement("label",null,"Password:"),i.a.createElement("input",{type:"text",maxLength:16,placeholder:"password",ref:this.refPassword})),i.a.createElement("button",{type:"submit"},"Sign Up")),i.a.createElement("button",{type:"button",onClick:this.props.toggleRegisterPopUp},"Close")))}}]),t}(i.a.Component),D={},L=!1,A=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=this,t=m.a.auth().currentUser.email,a=m.a.database().ref().child("users");if(m.a.database().ref().child("tweets").once("value",function(e){for(var a=e.val(),n=Object.keys(a),i=0,o=0;o<n.length;o++)a[n[o]].email===t&&i++;D.tweetCount=i}),a.once("value",function(e){for(var a=e.val(),n=Object.keys(a),i=0;i<n.length;i++)a[n[i]].email===t&&(D.email=t,D.name=a[n[i]].firstName,D.userId=a[n[i]].id,D.following=a[n[i]].following,D.followers=a[n[i]].folowers)}).catch(function(e){console.log(e)}),!L)var n=setInterval(function(t){(Boolean(D.name)||Boolean(D.tweetCount))&&(clearInterval(n),L=!0,e.setState({}))},2e3);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"app-container"},i.a.createElement("div",{className:"app-left"},i.a.createElement(T,{userData:D})),i.a.createElement("div",{className:"app-mid"},i.a.createElement(R,{userData:D})),i.a.createElement("div",{className:"app-right"})))}}]),t}(i.a.Component),F=function(){return i.a.createElement("div",{className:"loading"},i.a.createElement("div",{className:"lds-default"},i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null)))},M=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={},a.follow=a.follow.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"follow",value:function(){this.props.follow()}},{key:"render",value:function(){return i.a.createElement("div",{className:"follow-unfollow"},i.a.createElement("span",{className:"follow-button",onClick:this.follow},"Follow"))}}]),t}(n.Component),W=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={},a.unfollow=a.unfollow.bind(Object(d.a)(a)),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"unfollow",value:function(){this.props.unfollow()}},{key:"render",value:function(){return i.a.createElement("div",{className:"follow-unfollow"},i.a.createElement("span",{className:"unfollow-button",onClick:this.unfollow},"Unfollow"))}}]),t}(n.Component),z=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={name:"",id:"",following:"",followers:"",tweetCount:"",notFound:!1,followingButton:-1,profilepic:!1,coverpic:!1},a.sendToState=a.sendToState.bind(Object(d.a)(a)),a.follow=function(){var e=m.a.database().ref().child("users"),t=m.a.auth().currentUser.email,n=[],i=[],o=a.state.id,r=void 0,l=void 0,c="";e.once("value",function(a){for(var s=a.val(),u=Object.keys(s),d=0;d<u.length;d++)s[u[d]].email===t&&(console.log(s[u[d]]),r=s[u[d]].following,c=s[u[d]].id,i[0]=s[u[d]].id),o===s[u[d]].id&&(n=s[u[d]].notifications);"undefined"===typeof r?r=[o]:r.push(o),i[1]=(new Date).toISOString(),i[2]=0,i[3]="follow",n?n.push(i):n=[i],e.child(o).child("notifications").set(n);for(var h=0;h<u.length;h++)s[u[h]].id===o&&(console.log(s[u[h]]),"undefined"===typeof(l=s[u[h]].followers)?l=[c]:l.push(c));console.log(l),e.child(o).child("followers").set(l),e.child(c).child("following").set(r)}).then(function(e){console.log("following done"),a.setState({followingButton:1,followers:a.state.followers+1})})},a.unfollow=function(){var e=m.a.database().ref().child("users"),t=m.a.auth().currentUser.email,n=[],i=a.state.id,o=[],r=[],l="";e.once("value",function(a){for(var c=a.val(),s=Object.keys(c),u=0;u<s.length;u++)c[s[u]].email===t&&(o=c[s[u]].following,l=c[s[u]].id),i===c[s[u]].id&&(n=c[s[u]].notifications);n=n?1===n.length?[]:n.filter(function(e){return!(e[0]===l&&"follow"===e[3])}):[],e.child(i).child("notifications").set(n),o=1===o.length?[]:o.filter(function(e){return e!==i});for(var d=0;d<s.length;d++)c[s[d]].id===i&&(1===(r=c[s[d]].followers).length?r=[]:r.filter(function(e){return e!==l}));e.child(i).child("followers").set(r),e.child(l).child("following").set(o)}).then(function(e){a.setState({followingButton:0,followers:a.state.followers-1})})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"sendToState",value:function(e,t,a,n,i,o,r,l){this.setState({name:e,id:t,following:a,followers:n,tweetCount:i,followingButton:o,profilepic:r,coverpic:l})}},{key:"componentDidMount",value:function(){var e=this;console.log("mounting");var t=m.a.database().ref().child("users"),a=m.a.database().ref().child("tweets"),n="",i="",o=window.location.pathname.replace("/twitter-clone/",""),r="",l="",c=0,s=-1,u=!1,d=!1;function h(e){return"undefined"===typeof e?0:e.length}t.once("value",function(e){for(var t=e.val(),a=Object.keys(t),c=0;c<a.length;c++)if(o===t[a[c]].id){i=t[a[c]].firstName,r=h(t[a[c]].following),l=h(t[a[c]].followers),n=t[a[c]].email,u=t[a[c]].profilepic,d=t[a[c]].coverpic;break}}).then(function(h){a.once("value",function(e){for(var t=e.val(),a=Object.keys(t),i=0;i<a.length;i++)n===t[a[i]].email&&c++}).then(function(a){u||(u="https://cdn.britannica.com/67/197567-131-1645A26E.jpg"),d||(d="https://images.unsplash.com/photo-1518791841217-8f162f1e1131?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80"),m.a.auth().onAuthStateChanged(function(a){if(a){var n=m.a.auth().currentUser.email;t.once("value",function(t){for(var a=t.val(),h=Object.keys(a),f=0;f<h.length;f++)if(n===a[h[f]].email){a[h[f]].id;if(o===a[h[f]].id)break;if("undefined"==typeof a[h[f]].following){s=0;break}for(var m=a[h[f]].following,g=Object.keys(a[h[f]].following),p=0;p<g.length;p++){if(o===m[g[p]]){s=1;break}s=0}}e.setState({name:i,id:o,following:r,followers:l,tweetCount:c,followingButton:s,profilepic:u,coverpic:d})})}else console.log("no user logged",i,o,r,l,c,s),e.setState({name:i,id:o,following:r,followers:l,tweetCount:c,followingButton:s,profilepic:u,coverpic:d})})})})}},{key:"render",value:function(){return i.a.createElement("div",{className:"userBoxUP-container"},this.state.profilepic?i.a.createElement("img",{id:"userBoxUP-image",src:this.state.profilepic,alt:"profile picture"}):i.a.createElement("img",{id:"userBoxUP-image",src:"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812",alt:"profile picture"}),i.a.createElement("h3",{id:"userBoxUP-name"},this.state.name),i.a.createElement("p",{id:"userBoxUP-user"},"@",this.state.id),i.a.createElement("p",{id:"userBoxUP-description"},"Non editable description."),-1===this.state.followingButton?null:0===this.state.followingButton?i.a.createElement(M,{follow:this.follow}):i.a.createElement(W,{unfollow:this.unfollow}),i.a.createElement("div",{className:"userBox-content-information userBoxInUserPage-content"},i.a.createElement(g.b,{to:""},i.a.createElement("div",{className:"userBox-content-tweets"},i.a.createElement("h5",{id:"userBox-information"},"Tweets"),i.a.createElement("h5",{id:"userBox-number"},this.state.tweetCount," "))),i.a.createElement(g.b,{to:""},i.a.createElement("div",{className:"userBox-content-following"},i.a.createElement("h5",{id:"userBox-information"},"Following"),i.a.createElement("h5",{id:"userBox-number"},this.state.following," "))," "),i.a.createElement(g.b,{to:""},i.a.createElement("div",{className:"userBox-content-followers"},i.a.createElement("h5",{id:"userBox-information"},"Followers"),i.a.createElement("h5",{id:"userBox-number"},this.state.followers," ")))))}}]),t}(n.Component),H=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={loaded:!1,coverpic:!1},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=m.a.database().ref().child("users"),a=this.props.id,n=!1;t.once("value",function(e){for(var t=e.val(),i=Object.keys(t),o=0;o<i.length;o++)a===t[i[o]].id&&t[i[o]].coverpic&&(n=t[i[o]].coverpic)}).then(function(){n||(n="https://images.unsplash.com/photo-1518791841217-8f162f1e1131?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&w=1000&q=80"),e.setState({coverpic:n})})}},{key:"render",value:function(){var e;e=this.state.coverpic?this.state.coverpic:"https://firebasestorage.googleapis.com/v0/b/directorio-de-negocios-a257b.appspot.com/o/whitefondo.jpg?alt=media&token=22ddf22f-d657-43d7-a472-c115e58c1812";var t={height:"300px",width:"100%",backgroundSize:"cover",backgroundPosition:"center",backgroundImage:"url(".concat(e,")"),backgroundColor:"white",marginTop:"50px"};return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"userpage-background",style:t}),i.a.createElement("div",{className:"app-container app-container-userPage"},i.a.createElement("div",{className:"app-left"},i.a.createElement(z,null)),i.a.createElement("div",{className:"app-mid"},i.a.createElement(R,null))))}}]),t}(n.Component),_=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={profilePic:"",coverPic:"",loading:"",completed:!1,filesToUpload:0,uploadedFiles:0,profileLink:"",coverLink:""},a.profilePicHandler=function(e){var t=e.target.files[0];"image/png"===t.type||"image/jpeg"===t.type?t.size>1e6?window.alert("Please use a lower size image for the profile pic"):a.setState({profilePic:t}):(window.alert("Please use png or jpeg."),e.target.value=null)},a.coverPicHandler=function(e){var t=e.target.files[0];"image/png"===t.type||"image/jpeg"===t.type?t.size>1e6?window.alert("Please use a lower size image for the cover pic"):a.setState({coverPic:t}):(window.alert("Please use png or jpeg."),e.target.value=null)},a.upload=function(e){var t=a.state.profilePic,n=a.state.coverPic,i=m.a.database().ref().child("users"),o=m.a.auth().currentUser.email,r=m.a.storage().ref("/".concat(o,"/profilepics/").concat(t.name)),l=m.a.storage().ref("/".concat(o,"/coverpics/").concat(n.name));"object"===typeof a.state.profilePic&&"object"===typeof a.state.coverPic?(a.setState({filesToUpload:2}),r.put(t).on("state_changed",function(e){var t=e.bytesTransferred/e.totalBytes*100;a.setState({loading:t})},function(e){console.log(e)},function(){i.once("value",function(e){var t=e.val(),a=Object.keys(t);r.getDownloadURL().then(function(e){for(var n=0;n<a.length;n++)if(t[a[n]].email===o){i.child(t[a[n]].id).child("profilepic").set(e);break}})}).then(function(){a.setState({completed:!1,loading:0,uploadedFiles:1})}),l.put(n).on("state_changed",function(e){var t=e.bytesTransferred/e.totalBytes*100;a.setState({loading:t})},function(e){console.log(e)},function(){i.once("value",function(e){var t=e.val(),a=Object.keys(t);l.getDownloadURL().then(function(e){for(var n=0;n<a.length;n++)if(t[a[n]].email===o){i.child(t[a[n]].id).child("coverpic").set(e);break}})}).then(function(){a.setState({completed:!0,loading:0,uploadedFiles:2})})})})):"object"===typeof a.state.profilePic&&"string"===typeof a.state.coverPic?(a.setState({filesToUpload:1}),r.put(t).on("state_changed",function(e){var t=e.bytesTransferred/e.totalBytes*100;a.setState({loading:t})},function(e){console.log(e)},function(){i.once("value",function(e){var t=e.val(),a=Object.keys(t);r.getDownloadURL().then(function(e){for(var n=0;n<a.length;n++)if(t[a[n]].email===o){i.child(t[a[n]].id).child("profilepic").set(e);break}})}).then(function(){a.setState({completed:!0,loading:0,uploadedFiles:1})})})):(a.setState({filesToUpload:1}),l.put(n).on("state_changed",function(e){var t=e.bytesTransferred/e.totalBytes*100;a.setState({loading:t})},function(e){console.log(e)},function(){i.once("value",function(e){var t=e.val(),a=Object.keys(t);l.getDownloadURL().then(function(e){for(var n=0;n<a.length;n++)if(t[a[n]].email===o){i.child(t[a[n]].id).child("coverpic").set(e);break}})}).then(function(){a.setState({completed:!0,loading:0,uploadedFiles:1})})}))},a.toggleSettings=function(){a.props.toggleSettings()},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"changeThings-container"},i.a.createElement("div",{className:"changeThings-content"},i.a.createElement("form",null,i.a.createElement("h3",null,"Change Profile Picture"),i.a.createElement("input",{type:"file",onChange:this.profilePicHandler,className:"upload-image",name:"profile-picture-file"}),i.a.createElement("h3",null,"Change Big Profile Picture"),i.a.createElement("input",{type:"file",onChange:this.coverPicHandler,className:"upload-image",name:"profileBig-picture-file"}),i.a.createElement("div",{className:"changeThings-buttons"},this.state.loading>0?i.a.createElement("h3",null,"Uploading... ",this.state.uploadedFiles," of ",this.state.filesToUpload," "):null,this.state.completed?i.a.createElement("h3",null,"Image","(s)"," uploaded."):null,i.a.createElement("button",{type:"button",onClick:this.upload,className:"upload-button"},"Upload"),i.a.createElement("button",{type:"button",onClick:this.toggleSettings,className:"close-button"},"Close")))))}}]),t}(n.Component);m.a.initializeApp({apiKey:"AIzaSyCbz4cCoC6aj2XaDIpqp4E7uKfUIuLkij0",authDomain:"directorio-de-negocios-a257b.firebaseapp.com",databaseURL:"https://directorio-de-negocios-a257b.firebaseio.com",projectId:"directorio-de-negocios-a257b",storageBucket:"directorio-de-negocios-a257b.appspot.com",messagingSenderId:"156581943217",appId:"1:156581943217:web:2838e8736b764738"});var Y=m.a.database().ref().child("users"),J=(m.a.database().ref().child("tweets"),!1),q=!0,Q=!1,K=!1,X=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={showPopUp:!1,loading:q},a.toggleRegisterPopUp=a.toggleRegisterPopUp.bind(Object(d.a)(a)),a.register=a.register.bind(Object(d.a)(a)),a.logIn=a.logIn.bind(Object(d.a)(a)),a.logOut=a.logOut.bind(Object(d.a)(a)),a.loadingFalse=function(){a.setState({loading:!1})},a.toggleSettings=function(){a.setState({toggleSettings:!a.state.toggleSettings})},a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"toggleRegisterPopUp",value:function(){this.setState({showPopUp:!this.state.showPopUp})}},{key:"logIn",value:function(e,t){var a=this;this.setState({loading:!0}),m.a.auth().signInWithEmailAndPassword(e,t).catch(function(e){"auth/invalid-email"===e.code?window.alert("The email address is badly formatted"):"auth/wrong-password"===e.code?window.alert("The password you entered is incorrect"):"auth/user-not-found"===e.code&&window.alert("The user doesnt exist.")}).then(function(){m.a.auth().onAuthStateChanged(function(e){e?(J=!0,a.setState({loading:!1})):a.setState({loading:!1})})})}},{key:"logOut",value:function(){var e=this;m.a.auth().signOut().then(function(){J=!1,window.location.replace("/twitter-clone/"),e.setState({})})}},{key:"register",value:function(e){console.log(e);var t=e.name,a=e.userId,n=e.email,i=e.password,o={id:a,firstName:t,email:n,following:[],followers:[]};m.a.auth().createUserWithEmailAndPassword(n,i).catch(function(e){console.log(e.code),console.log(e.message)}).then(function(e){e&&Y.child(a).update(o),console.log("user in db"),m.a.auth().signInWithEmailAndPassword(n,i).catch(function(e){console.log(e)}).then(function(e){window.location.reload()})})}},{key:"renderLogged",value:function(){var e=this;return i.a.createElement(g.a,{basename:"/twitter-clone"},i.a.createElement(p.a,{exact:!0,path:"/tweet/:id",render:function(){var t=window.location.pathname.replace("/tweet/","");return i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{logOut:e.logOut,toggleSettings:e.toggleSettings}),e.state.toggleSettings?i.a.createElement(_,{toggleSettings:e.toggleSettings}):null,i.a.createElement(A,{key:t}))}}),i.a.createElement(p.a,{exact:!0,path:"/:id",render:function(){var t=window.location.pathname.replace("/twitter-clone/","");return i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{logOut:e.logOut,key:t,toggleSettings:e.toggleSettings}),e.state.toggleSettings?i.a.createElement(_,{toggleSettings:e.toggleSettings}):null,i.a.createElement(H,{key:t,id:t}))}}),i.a.createElement(p.a,{exact:!0,path:"/",render:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{logOut:e.logOut,toggleSettings:e.toggleSettings}),e.state.toggleSettings?i.a.createElement(_,{toggleSettings:e.toggleSettings}):null,i.a.createElement(A,null))}}))}},{key:"renderNoLogged",value:function(){var e=this;return i.a.createElement(g.a,{basename:"/twitter-clone"},i.a.createElement(p.a,{exact:!0,path:"/:id",render:function(){var t=window.location.pathname.replace("/twitter-clone/","");return i.a.createElement(i.a.Fragment,{key:t},i.a.createElement(N,{logOut:e.logOut}),i.a.createElement(H,{key:t}))}}),i.a.createElement(p.a,{exact:!0,path:"/",render:function(){return i.a.createElement(i.a.Fragment,null,e.state.showPopUp?i.a.createElement(I,{toggleRegisterPopUp:e.toggleRegisterPopUp,register:e.register}):null,e.state.loading?i.a.createElement(F,null):null,i.a.createElement(P,{logIn:e.logIn,toggleRegisterPopUp:e.toggleRegisterPopUp}))}}))}},{key:"render",value:function(){var e=this;Q||m.a.auth().onAuthStateChanged(function(e){e?(Q=!0,J=!0,q=!1):(q=!1,Q=!0)});setInterval(function(t){!1===K&&Q&&(K=!0,e.setState({loading:!1}))},2e3);return J?i.a.createElement(i.a.Fragment,null,this.renderLogged()):i.a.createElement(i.a.Fragment,null,this.renderNoLogged())}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[112,1,2]]]);
//# sourceMappingURL=main.a9fa2058.chunk.js.map